{"version":3,"file":"singleselectpopup.js","sourceRoot":"","sources":["../../../../src/modules/combo/singleselectcombo/singleselectpopup.ts"],"names":[],"mappings":"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","sourcesContent":["import { shortcut, store } from '@engine/core';\nimport { BasicButton, ListPane, Loader, SingleSelectItem, TextButton, VTapeLayout } from '@fui/core';\nimport { ParameterSingleSelectPopupModel } from './singleselectpopup.model';\n\n@shortcut()\n@store(ParameterSingleSelectPopupModel, {\n    props(this: ParameterSingleSelectPopup) {\n        return {\n            name4EmptyGetter: this.options.name4EmptyGetter,\n        };\n    },\n})\nexport class ParameterSingleSelectPopup extends BI.Widget {\n    public static xtype = 'report-single-select-popup';\n\n    public static EVENT_CHANGE = 'EVENT_CHANGE';\n    public static EVENT_CLEAR = 'EVENT_CLEAR';\n    public static EVENT_LOADED = 'EVENT_LOADED';\n\n    protected pane: ListPane;\n\n    public props = {\n        itemsCreator: BI.emptyFn,\n        keywordGetter: () => <undefined | string>undefined,\n        valueGetter: () => <{text: string; value: string} | undefined>undefined,\n        unmatchedValueGetter: () => <{text: string; value: string}[]>[],\n        minWidth: 135,\n        maxHeight: 400,\n        height: <number | undefined>72,\n        value: <{text: string; value: string} | undefined>undefined,\n        customData: true,\n        allowNoSelect: true,\n        repopulateGetter: () => false,\n        name4EmptyGetter: () => '',\n        itemHeightGetter: () => 24,\n        maxCountGetter: () => 0,\n        popupAdjuster: () => {},\n        tipText: '',\n    }\n\n    private store: ParameterSingleSelectPopupModel['store'];\n    private model: ParameterSingleSelectPopupModel['model'];\n\n    protected addTextBtn: TextButton;\n\n    protected notSelectBtn: SingleSelectItem;\n\n    private unmatchedValues: {text: string;value: string;}[] = [];\n\n    private value: {text: string;value: string;} | undefined;\n\n    private hasNext = false;\n\n    private afterInit = false;\n\n    protected vtapeWrapper: VTapeLayout;\n\n    private loader: Loader;\n\n    public render() {\n        const { itemsCreator, itemHeightGetter, keywordGetter, value, allowNoSelect, tipText } = this.options;\n\n        this.value = BI.deepClone(value);\n\n        return {\n            type: BI.VTapeLayout.xtype,\n            ref: (_ref: VTapeLayout) => {\n                this.vtapeWrapper = _ref;\n            },\n            items: [{\n                el: {\n                    type: BI.VerticalLayout.xtype,\n                    scrolly: false,\n                    items: [{\n                        type: BI.SingleSelectItem.xtype,\n                        cls: 'bi-list-item-active',\n                        iconWrapperWidth: 36,\n                        ref: (_ref: SingleSelectItem) => {\n                            this.notSelectBtn = _ref;\n                        },\n                        text: () => this.model.name4Empty,\n                        invisible: !allowNoSelect,\n                        height: itemHeightGetter(),\n                        listeners: [{\n                            eventName: BI.SingleSelectItem.EVENT_CHANGE,\n                            action: () => {\n                                this.fireEvent(ParameterSingleSelectPopup.EVENT_CLEAR);\n\n                                this.notSelectBtn.setSelected(false);\n                            },\n                        }],\n                    }, {\n                        type: BI.TextButton.xtype,\n                        ref: (_ref: TextButton) => {\n                            this.addTextBtn = _ref;\n                        },\n                        invisible: true,\n                        text: BI.i18nText('BI-Basic_Click_To_Add_Text', ''),\n                        height: itemHeightGetter(),\n                        cls: 'bi-high-light',\n                        hgap: 5,\n                        handler: () => {\n                            this.fireEvent(ParameterSingleSelectPopup.EVENT_CHANGE, keywordGetter(), keywordGetter(), true);\n                        },\n                    }],\n                },\n                height: itemHeightGetter(),\n            }, {\n                type: BI.ListPane.xtype,\n                tipText,\n                ref: (_ref: ListPane) => {\n                    this.pane = _ref;\n                },\n                itemsCreator: (op: any, callback: Function) => {\n                    const keyword = keywordGetter();\n\n                    op.keyword = keyword;\n\n                    itemsCreator(op, (data: {items: any[], hasNext: boolean}) => {\n                        this.hasNext = data.hasNext;\n\n                        data.items = this.transformItems(data.items);\n\n                        callback(this.createItems(data.items));\n\n                        if (op.times === 1) {\n                            this.resizeLayout(data.items);\n\n                            this.resize(BI.size(data.items) > 0);\n                        }\n                    });\n                },\n                el: {\n                    type: BI.Loader.xtype,\n                    ref: (_ref: Loader) => {\n                        this.loader = _ref;\n                    },\n                    el: {\n                        chooseType: BI.ButtonGroup.CHOOSE_TYPE_MULTI,\n                    },\n                    layouts: [{\n                        type: BI.VerticalLayout.xtype,\n                        height: 400,\n                        minHeight: 400,\n                        scrolly: true,\n                    }],\n                },\n                hasNext: () => this.hasNext,\n                listeners: [{\n                    eventName: BI.Pane.EVENT_LOADED,\n                    action: () => {\n                        this.fireEvent(ParameterSingleSelectPopup.EVENT_LOADED);\n                    },\n                }],\n            }],\n        };\n    }\n\n    protected resizeLayout(items: {text: string; value: string, [key: string]: any}[]) {\n        const { allowNoSelect, itemHeightGetter } = this.options;\n\n        this.vtapeWrapper.attr('items')[0].height = BI.size(items) === 0 || !allowNoSelect ? 0 : itemHeightGetter();\n\n        this.vtapeWrapper.resize();\n    }\n\n    public resize(isHeaderVisible: boolean) {\n        const { itemHeightGetter, allowNoSelect, maxCountGetter } = this.options;\n        const height = allowNoSelect ? itemHeightGetter() : 0;\n        // 自定义js，限制显示的条目数\n        const maxHeight = maxCountGetter() * itemHeightGetter();\n\n        BI.nextTick(() => {\n            this.handleResize(isHeaderVisible, (maxHeight || this.loader.element.height() || itemHeightGetter()) + height);\n        });\n    }\n\n    public resetResize(isHeaderVisible: boolean) {\n        this.handleResize(isHeaderVisible, 72);\n    }\n\n    private handleResize(isHeaderVisible: boolean, paneHeight: number) {\n        if (!this.afterInit) {\n            this.afterInit = true;\n\n            return;\n        }\n\n        const { itemHeightGetter, allowNoSelect, popupAdjuster, keywordGetter } = this.options;\n\n        const height = allowNoSelect ? itemHeightGetter() : 0;\n\n        this.pane.setTipVisible(!isHeaderVisible);\n\n        if (!keywordGetter()) {\n            this.vtapeWrapper.element.css('height', paneHeight);\n            this.vtapeWrapper.attr('items')[0].height = isHeaderVisible ? height : 0;\n            this.vtapeWrapper.resize();\n\n            popupAdjuster();\n        }\n    }\n\n    protected transformItems(items: {text: string; value: string, [key: string]: any}[]) {\n        let i = 0;\n\n        // 匹配未匹配项里的item\n        while (i < this.unmatchedValues.length) {\n            const selectedValue = this.unmatchedValues[i];\n\n            const itemIndex = items.findIndex(item => item.text === selectedValue.text && item.value === selectedValue.value);\n\n            if (itemIndex !== -1) {\n                items.splice(itemIndex, 1);\n\n                this.unmatchedValues.splice(i, 1);\n            } else {\n                i += 1;\n            }\n        }\n\n        items.some(item => {\n            if (BI.isNull(this.value)) {\n                return true;\n            }\n\n            const isMatched = item.text === this.value.text && item.value === this.value.value;\n\n            if (isMatched) {\n                item.selected = true;\n\n                this.value = undefined;\n\n                return true;\n            }\n\n            return false;\n        });\n\n        const newItems = this.value ? [{\n            ...this.value,\n            selected: true,\n        }] : [];\n\n        if (this.value) {\n            this.unmatchedValues.push(this.value);\n        }\n\n        this.value = undefined;\n\n        return items.concat(newItems);\n    }\n\n    public getValue() {\n        const btn = this.pane.getAllButtons<BasicButton>()\n            .find(btn => btn.isSelected());\n\n        return btn ? {\n            text: btn.attr('text'),\n            value: btn.getValue(),\n        } : undefined;\n    }\n\n    public getAllLeaves() {\n        return this.pane.getAllButtons<BasicButton>()\n            .map(btn => {\n                return {\n                    text: btn.attr('text'),\n                    value: btn.getValue(),\n                };\n            });\n    }\n\n    public populate() {\n        this.pane.populate();\n    }\n\n    public setAllUnselected() {\n        this.pane.getAllButtons<BasicButton>().forEach(btn => {\n            btn.setSelected(false);\n        });\n    }\n\n    public selectNextItem() {\n        const selectItems = this.pane.getAllButtons<BasicButton>();\n        const selectedIndex = selectItems.findIndex(btn => btn.isSelected());\n        if (selectedIndex + 1 < selectItems.length) {\n            selectedIndex >= 0 && selectItems[selectedIndex].setSelected(false);\n            selectItems[selectedIndex + 1].setSelected(true);\n        }\n    }\n\n    public selectPreItem() {\n        const selectItems = this.pane.getAllButtons<BasicButton>();\n        const selectedIndex = selectItems.findIndex(btn => btn.isSelected());\n        if (selectedIndex > 0) {\n            selectItems[selectedIndex].setSelected(false);\n            selectItems[selectedIndex - 1].setSelected(true);\n        }\n    }\n\n    private createItems(items: any[]) {\n        return BI.createItems(items, {\n            type: BI.SingleSelectItem.xtype,\n            cls: 'bi-list-item-active',\n            iconWrapperWidth: 36,\n            height: this.options.itemHeightGetter(),\n            keyword: this.options.keywordGetter(),\n            $testId: 'report-main-parameter-container-controller-combo-item',\n            listeners: [{\n                eventName: BI.SingleSelectItem.EVENT_CHANGE,\n                action: (_v: any, btn: any) => {\n                    this.fireEvent(ParameterSingleSelectPopup.EVENT_CHANGE, btn.attr('text'), btn.getValue(), btn.isSelected());\n                },\n            }],\n        });\n    }\n\n    public switchState(text: string, value: string) {\n        let isMatched = false;\n\n        this.pane.getAllButtons<BasicButton>().forEach(btn => {\n            // 已经找到匹配项的话，后续节点全部不选\n            if (isMatched) {\n                btn.setSelected(false);\n\n                return;\n            }\n\n            // 是否完全匹配\n            isMatched = btn.attr('text') === text && btn.getValue() === value;\n\n            btn.setSelected(isMatched);\n        });\n\n        // 没有找到符合项或者需要重新刷新时，就添加上去\n        if (!isMatched || this.options.repopulateGetter()) {\n            this.pane.addItems(this.createItems([{\n                text,\n                value,\n                selected: true,\n            }]));\n\n            if (this.options.repopulateGetter()) {\n                this.value = { text, value };\n            } else {\n                this.unmatchedValues.push({ text, value });\n            }\n        }\n    }\n\n    public setValue(val?: {text: string, value: string}) {\n        this.setAllUnselected();\n        if (BI.isNotNull(val)) {\n            this.switchState(val.text, val.value);\n        }\n    }\n\n    public getUnmatchedValues() {\n        return this.unmatchedValues;\n    }\n\n    public resetState() {\n        this.unmatchedValues = [];\n\n        this.value = undefined;\n\n        this.hasNext = false;\n    }\n\n    public updateName4Empty() {\n        this.store.updateName4Empty();\n    }\n}\n"]}