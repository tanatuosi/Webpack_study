{"version":3,"file":"singleselectcombo.js","sourceRoot":"","sources":["../../../../src/modules/combo/singleselectcombo/singleselectcombo.ts"],"names":[],"mappings":"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","sourcesContent":["import { ParameterSingleSelectTrigger } from './singleselecttrigger';\nimport { shortcut } from '@engine/core';\nimport { ParameterSingleSelectPopup } from './singleselectpopup';\nimport { PopupMaxHeight } from '../../controller.service';\nimport { COMBO_POPUP_HEIGHT } from './singleselectcombo.constants';\nimport { Combo, TriggerIconButton } from '@fui/core';\n\n@shortcut()\nexport class ParameterSingleSelectCombo extends BI.Widget {\n    public static EVENT_CHANGE = 'EVENT_CHANGE';\n    public static EVENT_BEFORE_POPUPVIEW = 'EVENT_BEFORE_POPUPVIEW';\n    public static EVENT_CONFIRM = 'EVENT_CONFIRM';\n    public static xtype = 'report.single_select_combo';\n    public static EVENT_BEFORE_EDIT = 'EVENT_BEFORE_EDIT';\n    public static EVENT_AFTER_EDIT = 'EVENT_AFTER_EDIT';\n    public static EVENT_CLICK_ITEM = 'EVENT_CLICK_ITEM';\n    public static EVENT_BLUR = 'EVENT_BLUR';\n\n    private repopulate = false;\n\n    private needResize = false;\n\n    public props = {\n        baseCls: 'bi-search-text-value-combo',\n        height: 24,\n        text: '',\n        items: <{ text: string, value: string }[]>[],\n        tipType: '',\n        warningTitle: '',\n        attributes: {\n            tabIndex: 0,\n        },\n        title: '',\n        value: <{text: string;value: string;} | undefined>undefined,\n        itemsCreator: <(op: any, callback: Function) => void>BI.emptyFn,\n        watermark: '',\n        allowEdit: false,\n        customData: true,\n        allowNoSelect: true,\n        controlDataGetter: () => <{text: string; value: string}[]>[],\n        name4EmptyGetter: () => '',\n        itemHeightGetter: () => 24,\n        maxCountGetter: () => 0,\n    }\n\n    private combo: Combo;\n    \n    private trigger: ParameterSingleSelectTrigger;\n\n    private popup: ParameterSingleSelectPopup;\n\n    private triggerBtn: TriggerIconButton;\n\n    public render() {\n        const { height, value, text, tipType, warningTitle, title, itemsCreator, watermark, allowEdit, customData, allowNoSelect, name4EmptyGetter, itemHeightGetter, maxCountGetter } = this.options;\n\n        return {\n            type: BI.AbsoluteLayout.xtype,\n            items: [{\n                el: {\n                    type: BI.Combo.xtype,\n                    adjustLength: 2,\n                    toggle: !allowEdit,\n                    ref: (_ref: Combo) => {\n                        this.combo = _ref;\n                    },\n                    el: <Partial<ParameterSingleSelectTrigger['props']>>{\n                        type: ParameterSingleSelectTrigger.xtype,\n                        customData,\n                        watermark,\n                        allowEdit,\n                        itemHeightGetter,\n                        cls: 'search-text-value-trigger bi-border-radius',\n                        ref: (_ref: ParameterSingleSelectTrigger) => {\n                            this.trigger = _ref;\n                        },\n                        height: height - 2,\n                        text,\n                        value,\n                        tipType,\n                        warningTitle,\n                        itemsCreator,\n                        valueGetter: () => this.popup ? this.popup.getValue() : value,\n                        unmatchedValueGetter: () => this.popup ? this.popup.getUnmatchedValues() : value,\n                        title,\n                        listeners: [{\n                            eventName: ParameterSingleSelectTrigger.EVENT_FOCUS,\n                            action: () => {\n                                // combo里会监听click事件，如果这里也showView的话会触发两次popupView，导致在popup初始化的时候会resize，让loading动画的位置发生偏移，先注释掉\n                                // this.showView();\n                                this.fireEvent(ParameterSingleSelectCombo.EVENT_BEFORE_EDIT);\n                            },\n                        }, {\n                            eventName: ParameterSingleSelectTrigger.EVENT_CHANGE,\n                            action: (text: string, value: string) => {\n                                this.popup.switchState(text, value);\n                                this.fireEvent(ParameterSingleSelectCombo.EVENT_CLICK_ITEM);\n                                this.fireEvent(ParameterSingleSelectCombo.EVENT_AFTER_EDIT);\n                                this.combo.hideView();\n                            },\n                        }, {\n                            eventName: ParameterSingleSelectTrigger.EVENT_SEARCHING,\n                            action: () => {\n                                this.fireEvent(ParameterSingleSelectCombo.EVENT_AFTER_EDIT);\n                            },\n                        }, {\n                            eventName: ParameterSingleSelectTrigger.EVENT_BLUR,\n                            action: () => {\n                                this.fireEvent(ParameterSingleSelectCombo.EVENT_BLUR);\n                            },\n                        }, {\n                            eventName: ParameterSingleSelectTrigger.EVENT_CLICK,\n                            action: () => {\n                                this.showView();\n                            },\n                        }],\n                    },\n                    popup: {\n                        minWidth: 135,\n                        minHeight: COMBO_POPUP_HEIGHT,\n                        maxHeight: PopupMaxHeight,\n                        el: {\n                            type: ParameterSingleSelectPopup.xtype,\n                            name4EmptyGetter,\n                            itemHeightGetter,\n                            maxCountGetter,\n                            allowNoSelect,\n                            itemsCreator,\n                            customData,\n                            tipText: allowNoSelect ? '' : BI.i18nText('BI-No_Selected_Item'),\n                            popupAdjuster: () => {\n                                this.combo.adjustHeight();\n                            },\n                            ref: (_ref: ParameterSingleSelectPopup) => {\n                                this.popup = _ref;\n                                this.trigger.setAdapter(this.popup);\n                            },\n                            repopulateGetter: () => this.repopulate,\n                            listeners: [{\n                                eventName: ParameterSingleSelectPopup.EVENT_CHANGE,\n                                action: (text: string, value: string) => {\n                                    this.setValue({ value, text });\n                                    this.fireEvent(ParameterSingleSelectCombo.EVENT_CLICK_ITEM);\n                                    this.fireEvent(ParameterSingleSelectCombo.EVENT_AFTER_EDIT);\n                                    this.combo.hideView();\n                                },\n                            }, {\n                                eventName: ParameterSingleSelectPopup.EVENT_CLEAR,\n                                action: () => {\n                                    this.reset();\n                                    this.fireEvent(ParameterSingleSelectCombo.EVENT_CLICK_ITEM);\n                                    this.fireEvent(ParameterSingleSelectCombo.EVENT_AFTER_EDIT);\n                                    this.combo.hideView();\n                                },\n                            }, {\n                                eventName: ParameterSingleSelectPopup.EVENT_LOADED,\n                                action: () => {\n                                    BI.nextTick(() => {\n                                        this.trigger.isSearching() && this.trigger.adjustPopupHeight(this.popup);\n                                    });\n                                },\n                            }],\n                        },\n                        value,\n                    },\n                    listeners: [{\n                        eventName: BI.Combo.EVENT_AFTER_HIDEVIEW,\n                        action: () => {\n                            const keyword = this.trigger.isSearching() ? this.getAdapter().getKeyword() : undefined;\n                            this.trigger.stopEditing();\n                            this.popup && this.setValue(this.popup.getValue());\n                            this.fireEvent(ParameterSingleSelectCombo.EVENT_CONFIRM, keyword);\n                        },\n                    }, {\n                        eventName: BI.Combo.EVENT_BEFORE_POPUPVIEW,\n                        action: () => {\n                            this.fireEvent(ParameterSingleSelectCombo.EVENT_BEFORE_POPUPVIEW);\n\n                            if (this.repopulate) {\n                                this.populate([]);\n\n                                this.popup.resetResize(true);\n\n                                this.repopulate = false;\n                            } else {\n                                this.needResize = true;\n                            }\n                        },\n                    }, {\n                        eventName: BI.Combo.EVENT_AFTER_POPUPVIEW,\n                        action: () => {\n                            this.checkResize();\n                        },\n                    }],\n                    hideChecker: (e: any) => this.triggerBtn.element.find(e.target).length === 0,\n                },\n                left: 0,\n                right: 0,\n                bottom: 0,\n                top: 0,\n            }, {\n                el: {\n                    type: BI.TriggerIconButton.xtype,\n                    cls: 'trigger-icon-button',\n                    ref: (_ref: TriggerIconButton) => {\n                        this.triggerBtn = _ref;\n                    },\n                    width: height,\n                    height,\n                    handler: () => {\n                        if (this.combo.isViewVisible()) {\n                            this.combo.hideView();\n\n                            return;\n                        }\n\n                        this.showView();\n                        this.fireEvent(ParameterSingleSelectCombo.EVENT_BEFORE_EDIT);\n                    },\n                },\n                right: 0,\n                bottom: 0,\n                top: 0,\n            }],\n        };\n    }\n\n    public mounted() {\n        BI.EventListener.listen(this.element.context, 'keydown', (evt: KeyboardEvent) => {\n            const isSearching = this.trigger && this.trigger.isSearching();\n\n            switch (evt.keyCode) {\n                case BI.KeyCode.DOWN:\n                    (isSearching ? this.trigger : this.popup)?.selectNextItem();\n                    break;\n                case BI.KeyCode.UP:\n                    (isSearching ? this.trigger : this.popup)?.selectPreItem();\n                    break;\n                case BI.KeyCode.ENTER:\n                    if (isSearching) {\n                        return;\n                    }\n                    this.combo.hideView();\n                    break;\n                default:\n                    break;\n            }\n        });\n    }\n\n    public focus() {\n        this.trigger.focus();\n\n        this.combo.showView();\n\n        // TODO: 需要研究下为啥事件没触发\n        this.checkResize();\n    }\n\n    public blur() {\n        this.trigger.blur();\n\n        this.combo.hideView();\n    }\n\n    public setRepopulate(v: boolean) {\n        this.reset();\n        this.popup && this.popup.resetState();\n        // 如果初始化过，则需要重新初始化\n        if (this.popup) {\n            this.combo.isViewVisible() ? this.combo.populate() : this.repopulate = v;\n            \n            this.needResize = true;\n        }\n    }\n\n    public reset() {\n        this.popup && this.popup.setAllUnselected();\n        this.setValue();\n    }\n\n    public showView() {\n        this.combo.showView();\n    }\n\n    private checkResize() {\n        if (this.popup && this.needResize) {\n            this.popup.resize(true);\n\n            this.needResize = false;\n        }\n    }\n\n    public populate(items: any[]) {\n        this.options.items = items;\n        this.combo.populate(items);\n    }\n\n    public setValue(v?: {text: string, value: string}) {\n        this.options.value = v;\n        this.combo.setValue(v);\n    }\n\n    public getValue() {\n        return this.popup ? this.popup.getValue() : this.options.value;\n    }\n\n    public validateData() {\n        const data = this.getValue();\n        const dataAttr = this.options.controlDataGetter();\n\n        if (BI.isEmpty(data?.value)) {\n            return true;\n        }\n\n        const validation = dataAttr.some(item => item.text === data?.text && item.value === data?.value);\n\n        return validation;\n    }\n\n    public getAdapter() {\n        return this.trigger.getSearcher();\n    }\n\n    public setWaterMark(v: string) {\n        this.trigger.setWaterMark(v);\n    }\n\n    public updateName4Empty() {\n        this.popup?.updateName4Empty();\n    }\n}\n"]}