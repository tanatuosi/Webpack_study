import { AbstractResizer } from './resizer.abstract';
/**
 * 横向自适应，按照横向缩放比例缩放，字体缩放取横向缩放比例
 * 按照表格宽度缩放，不按照纸张大小缩放
 * 缩放比例限制0.4
 */
export class HorizontalTableLimitResizer extends AbstractResizer {
    resize(data, opt) {
        const { tableWidth, tableHeight, hasFrozen = false, fitAttr: { fitFont }, paperWidth } = opt;
        data.sheet.rows = (data.sheet.initialRows || data.sheet.rows || []).slice(0);
        data.sheet.cols = (data.sheet.initialCols || data.sheet.cols || []).slice(0);
        this.widthResizeScale = this.resizeWidth(data.sheet.cols || [], tableWidth);
        this.heightResizeScale = hasFrozen ? 1 : this.widthResizeScale;
        this.resizeHeight(data.sheet.rows || [], tableHeight, this.heightResizeScale);
        if (fitFont) {
            const fontScale = tableWidth / paperWidth;
            this.resizeFont(tableWidth / paperWidth, data.sheet.data);
            this.resizeSticker(fontScale, data.sheet);
        }
        return data;
    }
}
//# sourceMappingURL=resizer.horizontal_table_limit.js.map