import { AbstractResizer } from './resizer.abstract';
import { removeColsAdjust, removeRowsAdjust, resize, resizeFont } from './resizer.service';
/**
 * 不自动调整的双向自适应
 * 按照表格宽度缩放不会按照paper宽度去缩放
 * 字体缩放大小跟随横纵最小比例
 */
export class FullTableResizer extends AbstractResizer {
    resize(data, opt) {
        const { tableWidth, tableHeight, fitAttr: { fitFont, minFontSize } } = opt;
        const cols = removeColsAdjust(data.sheet.initialCols || []);
        const rows = removeRowsAdjust(data.sheet.initialRows || []);
        // CHART-16764 因为报表块会空出1px用于显示边框，所以这边需要减去1px，否则算出来的字体缩放比例和全局不一致
        this.widthResizeScale = (tableWidth - 1) / cols.reduce((total, item) => total + item);
        this.heightResizeScale = (tableHeight - 1) / rows.reduce((total, item) => total + item);
        data.sheet.cols = resize(tableWidth, cols, this.widthResizeScale);
        data.sheet.rows = resize(tableHeight, rows, this.heightResizeScale);
        if (fitFont) {
            const fontScale = Math.min(this.widthResizeScale, this.heightResizeScale);
            resizeFont(fontScale, minFontSize, data.sheet.data);
            this.resizeSticker(fontScale, data.sheet);
        }
        return data;
    }
}
//# sourceMappingURL=resizer.full_table.js.map