import { AbstractResizer } from './resizer.abstract';
import { removeColsAdjust, removeRowsAdjust, resize, resizeFont } from './resizer.service';
/**
 * 不自动调整的横向自适应
 * 不会按照paper宽度去缩放
 * 字体缩放大小默认跟随横纵最小比例
 */
export class HorizontalTableResizer extends AbstractResizer {
    resize(data, opt) {
        const { tableWidth, tableHeight, fitAttr: { fitFont, minFontSize } } = opt;
        const cols = removeColsAdjust(data.sheet.initialCols || []);
        const rows = removeRowsAdjust(data.sheet.initialRows || []);
        // CHART-16764 因为报表块会空出1px用于显示边框，所以这边需要减去1px，否则算出来的字体缩放比例和全局不一致
        this.widthResizeScale = (tableWidth - 1) / cols.reduce((total, item) => total + item);
        this.heightResizeScale = this.widthResizeScale;
        data.sheet.cols = resize(tableWidth, cols, this.widthResizeScale);
        data.sheet.rows = resize(tableHeight, rows, this.heightResizeScale);
        if (fitFont) {
            resizeFont(this.widthResizeScale, minFontSize, data.sheet.data);
            this.resizeSticker(this.widthResizeScale, data.sheet);
        }
        return data;
    }
}
//# sourceMappingURL=resizer.horizontal_table.js.map