import { AbstractResizer } from './resizer.abstract';
import { removeColsAdjust, removeRowsAdjust, resize, resizeFont } from './resizer.service';
/**
 * 双向撑满纸张大小，表格大小始终撑满纸张
 * 字体缩放比例支持由外部注入，默认为最小横纵缩放比例
 */
export class FullPaperResizer extends AbstractResizer {
    resize(data, opt) {
        var _a;
        const { tableWidth, paperWidth, tableHeight, paperHeight, fitAttr: { fitFont, minFontSize, fontScaleGetter } } = opt;
        this.widthResizeScale = tableWidth / paperWidth;
        this.heightResizeScale = tableHeight / paperHeight;
        data.sheet.cols = resize(tableWidth, removeColsAdjust(data.sheet.initialCols || []), this.widthResizeScale);
        data.sheet.rows = resize(tableHeight, removeRowsAdjust(data.sheet.initialRows || []), this.heightResizeScale);
        if (fitFont) {
            const fontScale = (_a = fontScaleGetter === null || fontScaleGetter === void 0 ? void 0 : fontScaleGetter()) !== null && _a !== void 0 ? _a : Math.min(this.widthResizeScale, this.heightResizeScale);
            resizeFont(fontScale, minFontSize, data.sheet.data);
            this.resizeSticker(fontScale, data.sheet);
        }
        return data;
    }
}
//# sourceMappingURL=resizer.full_paper.js.map