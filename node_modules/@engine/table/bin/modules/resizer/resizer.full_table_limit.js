import { AbstractResizer } from './resizer.abstract';
/**
 * 双向自适应，横向归横向缩放，纵向归纵向缩放，字体缩放取横纵缩放较小值
 * 缩放比例限制为0.4
 * 按照表格宽高而不是纸张大小进行缩放
 */
export class FullTableLimitResizer extends AbstractResizer {
    resize(data, opt) {
        const { tableWidth, tableHeight, hasFrozen = false, fitAttr: { fitFont }, paperWidth } = opt;
        data.sheet.cols = (data.sheet.initialCols || data.sheet.cols || []).slice(0);
        this.widthResizeScale = this.resizeWidth(data.sheet.cols || [], tableWidth);
        const heightResizeScale = hasFrozen ? 1 : 0;
        data.sheet.rows = (data.sheet.initialRows || data.sheet.rows || []).slice(0);
        this.heightResizeScale = this.resizeHeight(data.sheet.rows || [], tableHeight, heightResizeScale);
        if (fitFont) {
            const fontScale = tableWidth / paperWidth;
            this.resizeFont(fontScale, data.sheet.data);
            this.resizeSticker(fontScale, data.sheet);
        }
        return data;
    }
}
//# sourceMappingURL=resizer.full_table_limit.js.map