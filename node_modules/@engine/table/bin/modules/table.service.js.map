{"version":3,"file":"table.service.js","sourceRoot":"","sources":["../../src/modules/table.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { envProvider, transformColor } from '@engine/core';\nimport type { Range, TextShadow } from '@fui/sheet/types';\nimport jss, { Rule } from 'jss';\nimport jssGlobal from 'jss-plugin-global';\nimport jssNested from 'jss-plugin-nested';\nimport { CellHtml } from './cell/cell.abstract';\nimport { TableCellGenerator } from './table.cell_generator';\nimport { DEFAULT_BACKGROUND, DEFAULT_INPUT_BORDER, DEFAULT_SHADOW, GRADIENT_BACKGROUND_LENGTH, SCROLLBAR_WIDTH } from './table.constants';\nimport { BackgroundRepeat, BorderType, CellStyle, ContentTextAlign, ContentVerticalAlign, DefaultCellStyle, Frozen, PageResult, TableStickerOpt, XBorder, XBorderStyle, XCellDimension, XCellPosition, XCellStyle, XCellValue } from './table.types';\n\nconst HAIR_WIDTH = 0.5;\n\nexport function getBorderStyle({ width, style, color }: XBorder): BorderType {\n    let borderStyle = style.toLocaleLowerCase(),\n        borderWidh = width,\n        dash: number[] = [];\n    switch (borderStyle as XBorderStyle) {\n        case 'dashed':\n            dash = borderWidh === 2 ? [8, 2] : [4, 2];\n            break;\n        case 'slim_solid':\n            borderStyle = 'solid';\n            borderWidh = HAIR_WIDTH;\n            break;\n        case 'hair':\n            borderStyle = 'dashed';\n            borderWidh = HAIR_WIDTH;\n            dash = [2, 2];\n            break;\n        case 'hair2':\n            borderStyle = 'dashed';\n            borderWidh = HAIR_WIDTH;\n            dash = [4, 4];\n            break;\n        case 'dash_dot':\n            borderStyle = 'dashed';\n            dash = [8, 2, 2, 2];\n            break;\n        case 'dash_dot_dot':\n            borderStyle = 'dashed';\n            dash = [8, 2, 2, 2, 2, 2];\n            break;\n        case 'slanted_dash_dot':\n            borderStyle = 'dashed';\n            dash = [8, 2, 2, 2];\n            break;\n        default:\n    }\n\n    return {\n        color: transformColor(color),\n        style: borderStyle,\n        width: borderWidh,\n        dash,\n    };\n}\n\nexport function getCellStyle(\n    cellstyle: XCellStyle | undefined,\n    defaultStyle: DefaultCellStyle,\n): CellStyle {\n    if (!cellstyle) {\n        return {};\n    }\n    const { textAlign = 'left', cellJust = 'NONE' } = defaultStyle;\n    const style: CellStyle = {};\n    const { cellBackground, contentStyle, fontStyle, borderStyle } = cellstyle;\n    style.backgroundStyle = { ...DEFAULT_BACKGROUND };\n    if (cellBackground) {\n        const { background = {} } = cellBackground;\n        const {\n            color,\n            imgUrl,\n            layout = 0,\n            backgroundType,\n            startColor,\n            endColor,\n            begin = 0,\n            finish = 0,\n            direction,\n            radiusConfig,\n        } = background;\n        const bgStyle = { ...DEFAULT_BACKGROUND };\n\n        bgStyle.radiusConfig = radiusConfig;\n        switch (backgroundType) {\n            case 'TextureBackground':\n            case 'PatternBackground':\n            case 'ImageBackground':\n                bgStyle.backgroundImage = imgUrl;\n                // 先默认'repeat'\n                bgStyle.backgroundImageLayout = getImgLayout(layout);\n                break;\n            case 'ColorBackground':\n                bgStyle.backgroundColor = transformColor(color);\n                break;\n            case 'GradientBackground':\n                bgStyle.linearGradient = {\n                    degree: direction === 1 ? 180 : 90,\n                    stops: [\n                        {\n                            per: begin / GRADIENT_BACKGROUND_LENGTH,\n                            color: transformColor(startColor),\n                        },\n                        {\n                            per: finish === 0 ? 1 : finish / GRADIENT_BACKGROUND_LENGTH,\n                            color: transformColor(endColor),\n                        },\n                    ],\n                };\n                break;\n            default:\n                break;\n        }\n        style.backgroundStyle = bgStyle;\n    }\n    if (borderStyle) {\n        const {\n            topBorder = DEFAULT_INPUT_BORDER,\n            leftBorder = DEFAULT_INPUT_BORDER,\n            rightBorder = DEFAULT_INPUT_BORDER,\n            bottomBorder = DEFAULT_INPUT_BORDER,\n        } = borderStyle;\n        style.borderStyle = {\n            borderTop: getBorderStyle(topBorder),\n            borderBottom: getBorderStyle(bottomBorder),\n            borderLeft: getBorderStyle(leftBorder),\n            borderRight: getBorderStyle(rightBorder),\n        };\n    }\n    style.contentStyle = {\n        color: '',\n        fontSize: '',\n        defaultFontSize: '',\n        fontWeight: 'normal',\n        fontStyle: 'normal',\n        fontFamily: '',\n        textShadow: undefined,\n        strikeThrough: 'none',\n        underline: getBorderStyle({\n            width: 0,\n            color: 0,\n            style: '',\n        }),\n        subscript: false,\n        supscript: false,\n        wrap: true,\n        rotate: 0,\n        newLine: '',\n        verTextDirection: '',\n        verticalText: '',\n        textAlign: 'center',\n        verticalAlign: 'middle',\n        lineHeight: '',\n    };\n    if (fontStyle) {\n        const fontSize = fontStyle.subscript || fontStyle.supscript\n            ? fontStyle.fontSize * 5 / 6\n            : fontStyle.fontSize;\n\n        style.contentStyle = {\n            ...style.contentStyle,\n            color: transformColor(fontStyle.color),\n            fontSize: `${fontSize}px`,\n            defaultFontSize: `${fontSize}px`,\n            fontWeight: transformFontWeight(fontStyle.bold),\n            fontStyle: transformFontItalic(fontStyle.italic),\n            fontFamily: fontStyle.fontFamily.toLocaleLowerCase(),\n            textShadow: transformTextShadow(fontStyle.textShadow),\n            strikeThrough: fontStyle.strikeThrough ? 'solid' : 'none',\n            underline: getBorderStyle({\n                width: fontStyle.underLine.width,\n                color: fontStyle.underLine.color,\n                style: fontStyle.underLine.style,\n            }),\n            subscript: fontStyle.subscript,\n            supscript: fontStyle.supscript,\n        };\n    }\n    \n    if (contentStyle) {\n        style.contentStyle = {\n            ...style.contentStyle,\n            textAlign:\n                contentStyle.textAlign.toLocaleLowerCase() === 'default'\n                    ? textAlign\n                    : contentStyle.textAlign.toLocaleLowerCase() as ContentTextAlign,\n            lineHeight: `${contentStyle.lineHeight}`,\n            defaultLineHeight: `${contentStyle.lineHeight}`,\n            wrap: contentStyle.newLine.toLocaleLowerCase() === 'auto_newline',\n            rotate: contentStyle.rotate,\n            newLine: contentStyle.newLine,\n            verTextDirection: contentStyle.verTextDirection,\n            verticalText: contentStyle.verticalText,\n            cellJust,\n            verticalAlign: fontStyle.subscript\n                ? 'bottom'\n                : fontStyle.supscript\n                    ? 'top'\n                    : <ContentVerticalAlign>contentStyle.verticalAlign.toLowerCase(),\n            subscript: false,\n            supscript: false,\n        };\n        style.paddingLeft = contentStyle.paddingLeft;\n        style.paddingRight = contentStyle.paddingRight;\n        style.spacingAfter = contentStyle.spacingAfter;\n        style.spacingBefore = contentStyle.spacingBefore;\n    }\n\n    return style;\n}\n\nexport function createEmptyCell(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    rowSpan: number,\n    columnSpan: number,\n): PageResult {\n    return {\n        celldimension: {\n            width,\n            height,\n        },\n        position: {\n            columnSpan,\n            rowSpan,\n            x,\n            y,\n        },\n        value: '{\"type\": \"text\", \"value\": \"\"}',\n        valid: false,\n        cell: '',\n        direction: 0,\n        id: -1,\n    };\n}\n\nexport function getCompleteImageUrl(id: string, cache: boolean): string {\n    const cacheParam = cache ? '&cache=true' : '';\n    \n    return `${envProvider.ReqPrefix}/attach/image?id=${id}${cacheParam}`;\n}\n\nexport function removeOldStyles(rule: Rule) {\n    BI.keys(BI.get(rule, 'style')).forEach(key => {\n        rule.prop(key, '');\n    });\n}\n\nexport function addNewStyles(rule: Rule, styles: {\n    [key:string]: string;\n}) {\n    BI.keys(styles).forEach(key => {\n        rule.prop(key, BI.get(styles, key));\n    });\n}\n\n// 填补page和table之间的空白\n// REPORT-24262 如果冻结了单元格则不填补空白\nexport function adjustRows(rows:number[], paperHeight: number, isFrozen = false) {\n    rows[rows.length - 3] = 0;\n    // REPORT-70684 如果总行高未超过纸张高度，走此分支 会出现大段空白\n    const totalHeight = rows.reduce((r, i) => r + i, 0);\n    if (!isFrozen && totalHeight > paperHeight) {\n        rows[rows.length - 3] = Math.max(\n            paperHeight - totalHeight,\n            0,\n        );\n    } else {\n        rows[rows.length - 3] = SCROLLBAR_WIDTH;\n    }\n    \n    return rows;\n}\n\nexport function adjustCols(cols:number[], paperWidth: number, isFrozen = false) {\n    if (cols.length >= 2) {\n        /** 如果列宽之和没有超过纸张宽度， 那么也不需要走此分支 */\n        const totalWidth = cols.reduce((r, i) => r + i, 0);\n        if (!isFrozen && totalWidth > paperWidth) {\n            cols[cols.length - 2] = Math.max(\n                paperWidth - totalWidth,\n                0,\n            );\n        } else {\n            cols[cols.length - 2] = 0;\n            cols[cols.length - 1] = SCROLLBAR_WIDTH;\n        }\n    }\n    \n    return cols;\n}\n\nexport function getCellSize(celldimension: XCellDimension, colDefalut: number, rowDefault: number) {\n    let col = 0, row = 0;\n    if (celldimension) {\n        const { width, height } = celldimension;\n        col = Math.max(colDefalut || 0, width);\n        row = Math.max(rowDefault || 0, height);\n    }\n    \n    return {\n        col,\n        row,\n    };\n}\n\n/**\n * 转换cell value值\n * @param value string类型\n * @returns object\n */\nexport function getCellValue(value: string): XCellValue | undefined {\n    try {\n        return JSON.parse(value);\n    } catch (e) {\n        return undefined;\n    }\n}\n\n/**\n * 根据cell值获取cell实际值\n * @param cell cell\n * @returns 实际值\n */\nexport function getCellValueByCell(cell?: PageResult) {\n    if (cell?.value) {\n        const value = getCellValue(cell.value);\n\n        return value?.cv ?? value?.value ?? value?.text ?? cell.value;\n    }\n\n    return undefined;\n}\n\n/**\n * 根据cell值获取cell显示值\n * @param cell cell\n * @returns 显示值\n */\nexport function getCellTextByCell(cell?: PageResult) {\n    const cellValue = getCellValueByCell(cell);\n\n    return transformCellCv(cellValue).text;\n}\n\nexport function getCell(pageResult: PageResult, tableCellGenerator: TableCellGenerator) {\n    const { value, cellhyperlink, celladvancedattr, cellstyle, celladjustattr, valid, widget, sortHeader, ...pageResultArgs } = pageResult;\n    const cellValue = getCellValue(value);\n    \n    return tableCellGenerator.generate({\n        style: getCellStyle(cellstyle, {\n            textAlign:\n                cellValue?.value !== 'NaN' && BI.isNaN(cellValue?.value)\n                    ? 'left'\n                    : 'right',\n            cellJust: celladjustattr?.adjustStrategy || 'HEIGHT',\n        }),\n        cell: {\n            ...pageResultArgs,\n            ...<any>cellValue,\n            valid: BI.isNull(valid) ? true : valid,\n        },\n        widget,\n        cellhyperlink,\n        celladvancedattr,\n        sortHeader,\n    });\n}\n\nexport function expandHtml(html: string = '', style: Partial<NonNullable<TableStickerOpt['extension']>['style']>, fontScale: number = 1) {\n    const defaultCellStyle = {\n        paddingLeft: 0,\n        paddingRight: 0,\n        lineHeight: 0,\n        spacingAfter: 0,\n        spacingBefore: 0,\n        verticalAlign: 'middle',\n        textAlign: 'center',\n        color: -16777216,\n        bold: false,\n        fontFamily: 'SimSun',\n        fontSize: 12,\n        italic: true,\n        strikeThrough: false,\n        textShadow: false,\n        underLine: {\n            width: 0,\n            style: '',\n            color: -16777216,\n        },\n        height: 'auto',\n        cursor: '',\n    };\n    const cellStyle = {\n        ...defaultCellStyle,\n        ...style,\n    };\n    const { paddingLeft, paddingRight, lineHeight, spacingAfter, spacingBefore, verticalAlign, textAlign, color, bold, fontFamily, italic, strikeThrough, underLine, textShadow, fontSize, height, cursor } = cellStyle;\n    const verticalTypes = new Map([['TOP', 0], ['MIDDLE', 50], ['BOTTOM', 100]]);\n    const transform = `translateY(-${verticalTypes.get(verticalAlign)}%)`;\n    const cls = `html-cell-${BI.UUID()}`;\n    const textDecorations = [];\n    if (strikeThrough) {\n        textDecorations.push('line-through');\n    }\n    if (underLine.width) {\n        textDecorations.push('underline');\n    }\n\n    jss.use(jssGlobal(), jssNested());\n\n    const element = document.createElement('style');\n    element.innerHTML = `.${cls} {\n        box-sizing: border-box;\n        width: 100%;\n        height: ${height};\n        text-align: ${textAlign.toLowerCase() as 'left' | 'right' | 'center'};\n        position: absolute;\n        top: ${verticalTypes.get(verticalAlign)}%;\n        -ms-transform: ${transform};\n        -webkit-transform: ${transform};\n        -o-transform: ${transform},\n        transform: ${transform};\n        line-height: ${lineHeight}px;\n        padding: ${spacingBefore}px ${paddingRight}px ${spacingAfter}px ${paddingLeft}px;\n        --font-scale: ${fontScale};\n        color: ${transformColor(color)};\n        font-weight: ${transformFontWeight(bold)};\n        font-family: ${fontFamily};\n        font-style: ${transformFontItalic(italic)};\n        text-decoration: ${textDecorations.length > 0 ? textDecorations.join(' ') : 'normal'};\n        text-shadow: ${BI.isNull(textShadow) ? 'none' : transformTextShadow2Css(textShadow)};\n        font-size: ${fontSize * fontScale}px;\n        ${cursor ? `cursor: ${cursor} !important;` : ''}\n    }`;\n    document.head.appendChild(element);\n\n    const newHtml = `<div class=\"un-cssreset ${cls}\">${html}</div>`;\n    \n    return {\n        el: newHtml,\n        initialEl: html,\n        style: cellStyle,\n    };\n}\n\nexport function getMerge(x: number, y: number, columnSpan: number, rowSpan: number): Range {\n    return [\n        [x, y],\n        [x + columnSpan - 1, y + rowSpan - 1],\n    ];\n}\nexport function getFreeze(frozen?: {\n    colFrom: number;\n    colTo: number;\n    rowFrom: number;\n    rowTo: number;\n}) {\n    let freeze: [number, number] = [0, 0];\n    if (frozen) {\n        freeze = [frozen.colTo > -1 ? frozen.colTo + 2 : 0,\n            frozen.rowTo > -1 ? frozen.rowTo + 3 : 0];\n    }\n\n    return freeze;\n}\n\nexport function getImgLayout(type: number | BackgroundRepeat): BackgroundRepeat {\n    if (BI.isString(type)) {\n        return type;\n    }\n    \n    switch (type) {\n        case 0:\n            return 'repeat';\n        case 1:\n            return 'default';\n        case 3:\n            return 'center';\n        case 2:\n            return 'stretch';\n        case 4:\n            return 'adapt';\n        default:\n            return 'center';\n    }\n}\n\n/**\n * 单元格地址转化为单元格位置\n * @param address 单元格地址\n */\nexport function address2Position(address: string) {\n    const row = address.toLocaleUpperCase().replace(/[^a-zA-Z]/g, '');\n    const col = address.replace(/[^\\d]/g, '');\n    if (row && col) {\n        const x = row.split('')\n            .reverse()\n            .reduce((total, item, index) => total + (item.charCodeAt(0) - 64) * (index > 0 ? index * 25 : 1), 0) - 1;\n        const y = parseInt(col.toString(), 10) - 1;\n        \n        return {\n            x,\n            y,\n        };\n    }\n    \n    return undefined;\n}\n\n/**\n * 修复冻结时合并单元格的问题\n */\nexport function fixFreezeMerge(data: PageResult[][], frozen?: Frozen) {\n    const { rowTo, colTo } = frozen || { rowTo: -1, colTo: -1 };\n    for (let cy = 0; cy < data.length; cy++) {\n        if (!data[cy]) {\n            continue;\n        }\n        for (let cx = 0; cx < data[cy].length; cx++) {\n            const cell = data[cy][cx];\n            if (!cell) {\n                continue;\n            }\n            const { rowSpan = 1, columnSpan = 1, x = 0, y = 0 } = cell.position;\n            const cellValue = cell.value;\n            let [newX, newY, needReplace] = [0, 0, false];\n            if (rowSpan > 1 && rowTo >= y && y + rowSpan - 1 > rowTo) {\n                newX = x;\n                newY = y + rowTo + 1;\n                data[newY][newX].position.rowSpan = rowSpan - rowTo - 1;\n                cell.position.rowSpan = 1 + rowTo;\n                needReplace = true;\n                // 目前没想到什么时候会出现这种场景，先加上以防万一\n                if (columnSpan > 1) {\n                    data[newY][newX].position.columnSpan = columnSpan;\n                }\n            } else if (columnSpan > 1 && colTo >= x && x + columnSpan - 1 > colTo) {\n                newX = x + colTo + 1;\n                newY = cy;\n                data[newY][newX].position.columnSpan = columnSpan - colTo - 1;\n                cell.position.columnSpan = 1 + colTo;\n                needReplace = true;\n                if (rowSpan > 1) {\n                    data[newY][newX].position.rowSpan = rowSpan;\n                }\n            } else {\n                break;\n            }\n            if (needReplace) {\n                data[newY][newX].value = cellValue;\n                data[newY][newX].celladjustattr = cell.celladjustattr;\n                data[newY][newX].cellstyle = cell.cellstyle;\n                data[newY][newX].celladvancedattr = cell.celladvancedattr;\n                data[newY][newX].cellhyperlink = cell.cellhyperlink;\n                cell.value = JSON.stringify({\n                    type: 'text',\n                    value: '',\n                });\n            }\n        }\n    }\n}\n\nexport function getSticker(x: number, y: number, cellHtml: CellHtml, cell: PageResult): TableStickerOpt {\n    const extension = cellHtml.extended\n        ? expandHtml(cellHtml.value, {\n            ...cell.cellstyle?.contentStyle,\n            ...cell.cellstyle?.fontStyle,\n            ...cellHtml.style,\n            cursor: cellHtml.cursor,\n        })\n        : cellHtml.value\n            ? { el: cellHtml.value, style: undefined, initialEl: cellHtml.value }\n            : undefined;\n\n    return {\n        id: cellHtml.id,\n        position: {\n            row: y,\n            col: x,\n        },\n        el: extension?.el,\n        extension,\n        init: cellHtml.init,\n        lazy: cellHtml.lazy,\n    };\n}\n\n/**\n * cv转换为value\n * @param cv 实际设置值\n */\nexport function transformCellCv(cv: XCellValue['cv']): {xtype: string; value: string; text: string} {\n    let xtype = 'S', xcontent = `${cv}`;\n\n    if (BI.isNull(cv)) {\n        return { xtype, value: xcontent, text: xcontent };\n    }\n\n    if (BI.isNumber(cv)) {\n        xcontent = `${cv}`;\n\n        // 科学计数法\n        if (/\\./.test(xcontent) || (/e/i).test(xcontent)) {\n            xtype = 'D';\n        } else if (xcontent.length >= 10) {\n            xtype = 'BigDecimal';\n        } else {\n            xtype = 'I';\n        }\n\n        return { xtype, value: xcontent, text: xcontent };\n    }\n\n    if (BI.isArray(cv)) {\n        if (BI.size(cv) > 0 && BI.has(BI.first(cv), 'attach_id')) {\n            xtype = 'Attachments';\n\n            xcontent = cv.map((v: any) => v.attach_id).join(',');\n\n            return { xtype, value: xcontent, text: cv.map((v: any) => v.filename).join(',') };\n        }\n\n        xtype = 'A';\n\n        // REPORT-56760 二维数组第二层节点间使用分号\n        if (BI.isArray(BI.first(cv))) {\n            xtype = 'AA';\n            xcontent = cv.map(leaves => `${leaves}`).join(';');\n        } else {\n            xcontent = `${cv}`;\n        }\n\n        return { xtype, value: xcontent, text: xcontent };\n    }\n\n    if (BI.isObject(cv)) {\n        if (BI.isNotNull(cv.date_milliseconds)) {\n            xtype = 'Date';\n\n            xcontent = `${cv.date_milliseconds}`;\n        } else if (BI.isNotNull(cv.__time__)) {\n            xtype = 'Date';\n            \n            xcontent = `${cv.__time__}`;\n\n            return { xtype, value: xcontent, text: `${new Date(cv.__time__)}` };\n        } else if (BI.isNotNull(cv.attach_id)) {\n            xtype = 'Attachments';\n            xcontent = cv.attach_id;\n\n            return { xtype, value: xcontent, text: cv.filename };\n        } else if (BI.isEmptyObject(xcontent)) {\n            xcontent = '';\n        }\n\n        return { xtype, value: xcontent, text: xcontent };\n    }\n\n    if (BI.isBoolean(cv)) {\n        xtype = 'B';\n\n        return { xtype, value: xcontent, text: xcontent };\n    }\n\n    return { xtype, value: xcontent, text: xcontent };\n}\n\n/**\n * 根据位置计算id\n * @param x 列\n * @param y 行\n * @returns 字符串\n */\nexport function transformPosition2Id(x: number, y: number): string {\n    return `${x}-${y}`;\n}\n\nexport function transformFontWeight(fontWeight: boolean | string | number): string {\n    if (BI.isString(fontWeight)) {\n        return fontWeight;\n    } else if (BI.isNumber(fontWeight)) {\n        return fontWeight > 400 ? 'bold' : 'normal';\n    }\n\n    return fontWeight ? 'bold' : 'normal';\n}\n\nfunction transformTextShadow(textShadow: boolean | TextShadow) {\n    if (BI.isBoolean(textShadow)) {\n        return textShadow ? DEFAULT_SHADOW : undefined;\n    }\n\n    return textShadow;\n}\n\nexport function transformTextShadow2Css(textShadow: TextShadow | boolean): string {\n    if (BI.isBoolean(textShadow)) {\n        return textShadow ? transformTextShadow2Css(DEFAULT_SHADOW) : 'none';\n    }\n\n    return `${textShadow.shadowOffsetX}px ${textShadow.shadowOffsetY}px ${textShadow.shadowBlur}px ${textShadow.shadowColor}`;\n}\n\nexport function transformFontItalic(fontStyle: boolean | string): string {\n    if (BI.isString(fontStyle)) {\n        return fontStyle;\n    }\n\n    return fontStyle ? 'italic' : 'normal';\n}\n\n/**\n * 选区内被合并的单元格填充真实单元格位置信息\n * @param tableData 表格数据\n * @param position 真实单元格位置\n */\nexport function fixRealCellPositionInMergeCell(tableData: PageResult[][], position: XCellPosition) {\n    const { x, y, rowSpan = 1, columnSpan = 1 } = position;\n    \n    for (let startY = y; startY < y + rowSpan; startY++) {\n        for (let startX = x; startX < x + columnSpan; startX++) {\n            if (BI.isNull(tableData[startY][startX].merge)) continue;\n            \n            tableData[startY][startX].sourceCellPosition = {\n                x,\n                y,\n            };\n        }\n    }\n}\n"]}