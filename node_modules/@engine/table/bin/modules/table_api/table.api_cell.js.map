{"version":3,"file":"table.api_cell.js","sourceRoot":"","sources":["../../../src/modules/table_api/table.api_cell.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAC;AACxD,OAAO,EAAE,mBAAmB,EAAE,mBAAmB,EAAE,uBAAuB,EAAE,MAAM,kBAAkB,CAAC;AAErG,OAAO,EAAE,kBAAkB,EAAE,MAAM,6BAA6B,CAAC;AAEjE;;GAEG;AACH,MAAM,OAAO,SAAS;IAIlB,YAAmB,eAAgC,EAAE,OAAY;QAC7D,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC;QACvC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;IAC5B,CAAC;IAED;;;OAGG;IACI,WAAW;QACd,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;QAExC,OAAO,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;IAC1B,CAAC;IAEO,kBAAkB;QACtB,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;IAClC,CAAC;IAED;;;OAGG;IACI,MAAM;QACT,OAAO,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;IACzC,CAAC;IAED;;;OAGG;IACI,SAAS;QACZ,OAAO,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;IAC5C,CAAC;IAED;;;;OAIG;IACK,iBAAiB,CAAC,IAAY;QAClC,OAAO,IAAI,kBAAkB,CAAC,IAAI,CAAC,eAAe,CAAC;aAC9C,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;IACzD,CAAC;IAED;;;OAGG;IACI,QAAQ;QACX,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;IAC/B,CAAC;IAED;;;OAGG;IACI,WAAW,CAAC,IAAqB;QACpC,IAAI,CAAC,IAAI,CAAC,IAAI;YAAE,OAAO;QAEvB,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC;QAEhC,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,YAAY,EAAE;YAC1C,QAAQ,EAAE,IAAI,CAAC,kBAAkB,EAAE;YACnC,SAAS,EAAE,MAAM;YACjB,IAAI,EAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,IAAI;YACnB,MAAM,EAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,MAAM;YACvB,KAAK,EAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,KAAK;YACrB,KAAK;SACR,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACK,YAAY;;QAChB,MAAM,EAAE,WAAW,EAAE,cAAc,EAAE,YAAY,EAAE,SAAS,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;QAEzF,iFACO,WAAW,KACd,eAAe,EAAE,MAAA,cAAc,aAAd,cAAc,uBAAd,cAAc,CAAE,UAAU,0CAAE,KAAK,EAClD,eAAe,EAAE,MAAA,cAAc,aAAd,cAAc,uBAAd,cAAc,CAAE,UAAU,0CAAE,MAAM,KAChD,YAAY,GACZ,SAAS,KACZ,UAAU,EAAE,uBAAuB,CAAC,SAAS,CAAC,UAAU,CAAC,EACzD,MAAM,EAAE,mBAAmB,CAAC,SAAS,CAAC,MAAM,CAAC,EAC7C,UAAU,EAAE,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC,IACjD;IACN,CAAC;IAED;;;OAGG;IACI,QAAQ,CAAC,IAAsB;QAClC,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,gBAAgB,kBAC/C,KAAK,kCACE,IAAI,CAAC,YAAY,EAAE,GACnB,IAAI,KAER,IAAI,CAAC,kBAAkB,EAAE,EAC9B,CAAC;IACP,CAAC;CACJ","sourcesContent":["import { PopupHandler } from '../handler/handler.popup';\nimport { transformFontItalic, transformFontWeight, transformTextShadow2Css } from '../table.service';\nimport { CellSetStyleArgs, CellTooltipArgs, TableApiContext, XCell } from '../table.types';\nimport { MutiTableRowColumn } from './table.api_muti_row_column';\n\n/**\n * 供外部使用的单元格api\n */\nexport class TableCell {\n    private cellData: XCell;\n    private externalContext: TableApiContext;\n\n    public constructor(externalContext: TableApiContext, options: any) {\n        this.externalContext = externalContext;\n        this.cellData = options;\n    }\n\n    /**\n     * 获取单元格位置\n     * @returns 位置\n     */\n    public getPosition() {\n        const { x, y } = this.cellData.position;\n\n        return [y + 1, x + 1];\n    }\n\n    private getPosition4Inside() {\n        return this.cellData.position;\n    }\n\n    /**\n     * 获取单元格所占行对象\n     * @returns 多行对象\n     */\n    public getRow() {\n        return this.getTableRowColumn('row');\n    }\n\n    /**\n     * 获取单元格所占列对象\n     * @returns 多列对象\n     */\n    public getColumn() {\n        return this.getTableRowColumn('column');\n    }\n\n    /**\n     * 生成多行列对象\n     * @param type 类型，行或列\n     * @returns 多行列对象\n     */\n    private getTableRowColumn(type: string) {\n        return new MutiTableRowColumn(this.externalContext)\n            .createMultipleApi(type, this.cellData.position);\n    }\n\n    /**\n     * 获取单元格值\n     * @returns 值\n     */\n    public getValue() {\n        return this.cellData.value;\n    }\n\n    /**\n     * 设置单元格悬浮提示\n     * @param opts 提示配置\n     */\n    public showToolTip(opts: CellTooltipArgs) {\n        if (!opts.show) return;\n        \n        const { content, style } = opts;\n\n        this.externalContext.addHandler(PopupHandler, {\n            position: this.getPosition4Inside(),\n            scopeType: 'cell',\n            body: content?.text,\n            header: content?.header,\n            image: content?.image,\n            style,\n        });\n    }\n\n    /**\n     * 获取单元格样式\n     */\n    private getCellStyle() {\n        const { borderStyle, cellBackground, contentStyle, fontStyle } = this.cellData.cellstyle;\n\n        return {\n            ...borderStyle,\n            backgroundColor: cellBackground?.background?.color,\n            backgroundImage: cellBackground?.background?.imgUrl,\n            ...contentStyle,\n            ...fontStyle,\n            textShadow: transformTextShadow2Css(fontStyle.textShadow),\n            italic: transformFontItalic(fontStyle.italic),\n            fontWeight: transformFontWeight(fontStyle.bold),\n        };\n    }\n\n    /**\n     * 设置单元格样式\n     * @param opts 样式配置\n     */\n    public setStyle(opts: CellSetStyleArgs) {\n        this.externalContext.emitCellEvent('CELL_SET_STYLE', {\n            style: {\n                ...this.getCellStyle(),\n                ...opts,\n            },\n            ...this.getPosition4Inside(),\n        });\n    }\n}\n"]}