{"version":3,"file":"cell_controller.iframe.js","sourceRoot":"","sources":["../../../../../src/modules/cell/cell_controllers/iframe/cell_controller.iframe.ts"],"names":[],"mappings":"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","sourcesContent":["import { ControllerValidation, HEIGHT, WIDTH } from '@engine/controller';\nimport { shortcut } from '@engine/core';\nimport { appendParams2Url } from '@engine/crud';\nimport { Iframe } from '@fui/core';\nimport { AbstractParameterCellControllerWidget } from '../cell_controller.abstract';\nimport { fetchIframeControlAttr } from '../cell_controller.crud';\n\n@shortcut()\nexport class CellIframe extends AbstractParameterCellControllerWidget {\n    public static xtype = 'report.main.table_cell.controller.iframe';\n\n    public props = {\n        src: '',\n        width: WIDTH,\n        height: HEIGHT,\n        fontSize: 12,\n        value: '',\n        showOverFlowX: false,\n        showOverFlowY: false,\n        widgetName: '',\n        cellWidgetName: '',\n        reportIndex: 0,\n        position: {\n            row: 0,\n            column: 0,\n        },\n    }\n\n    private iframe: Iframe;\n\n    public render() {\n        const { src, width, height, showOverFlowX, showOverFlowY, cellWidgetName } = this.options;\n        const scrolling = showOverFlowX || showOverFlowY ? 'yes' : 'no';\n\n        return {\n            type: BI.AbsoluteLayout.xtype,\n            items: [{\n                el: {\n                    type: BI.Iframe.xtype,\n                    ref: (_ref: Iframe) => {\n                        this.iframe = _ref;\n                    },\n                    src,\n                    width,\n                    height,\n                    name: cellWidgetName,\n                    attributes: {\n                        scrolling,\n                    },\n                },\n                top: 0,\n                left: 0,\n                right: 0,\n                bottom: 0,\n            }],\n        };\n    }\n\n    public beforeInit() {\n        return this.getIframeControlAttr();\n    }\n\n    private getIframeControlAttr() {\n        const { widgetName } = this.options;\n\n        return fetchIframeControlAttr(widgetName, this.getRequestOpts())\n            .then(res => {\n                let result = {};\n\n                res.forEach(param => {\n                    result = { ...result, ...param };\n                });\n                \n                this.options.src = appendParams2Url(this.options.src, result);\n            });\n    }\n\n    private getRequestOpts() {\n        const { position, reportIndex } = this.options;\n\n        return {\n            location: {\n                ...position,\n                reportIndex,\n            },\n        };\n    }\n\n    public getValue() {\n        return this.iframe.getSrc();\n    }\n\n    public async setControllerValue(v: string) {\n        this.iframe.setSrc(v);\n    }\n\n    public setInteractValue(v: string) {\n        this.iframe.setSrc(v);\n    }\n\n    public reset() {\n        this.iframe.reset();\n    }\n\n    public preGetValidation(): ControllerValidation {\n        return { result: true };\n    }\n\n    public postGetValidation(): ControllerValidation {\n        return { result: true };\n    }\n    \n    public postValidateAndToast(): boolean {\n        return true;\n    }\n\n    public setStyle() {}\n}\n"]}