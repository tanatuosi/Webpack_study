{"version":3,"file":"finesheet.js","sourceRoot":"","sources":["../../src/wrappers/finesheet.ts"],"names":[],"mappings":"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","sourcesContent":["import '../polyfill/polyfill';\r\nimport './style.less';\r\nimport { Config, SheetOptions, Bounds, Cell, ColumnRowData, RowsConfig, ColsConfig } from '../../types';\r\nimport { Sheet, Element, h } from '../component';\r\nclass FineSheet {\r\n    public sheet: Sheet;\r\n    protected parent: Element;\r\n    protected root: Element;\r\n\r\n    public constructor(rootEl: HTMLElement, config: Config, events: Events = {}) {\r\n        if (events.beforeInit && !events.beforeInit()) {\r\n            return;\r\n        }\r\n        events.beforeCreate?.();\r\n        this.parent = h(rootEl, 'sheet-root');\r\n        const { width, height } = this.parent.offset() as Bounds;\r\n        const { tableWidth = width, tableHeight = height } = config;\r\n        const sheetOptions = {\r\n            width: tableWidth,\r\n            height: tableHeight,\r\n            ...config.options,\r\n        };\r\n\r\n        this.sheet = new Sheet(sheetOptions, events);\r\n\r\n        events.beforeMount?.();\r\n        this.parent.children(this.sheet.el);\r\n        events.mounted?.();\r\n    }\r\n\r\n    public loadData(data: SheetOptions): FineSheet {\r\n        this.sheet.loadData(data);\r\n\r\n        return this;\r\n    }\r\n\r\n    public updateData(): FineSheet {\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 更新单个单元格\r\n     * @param cell 单元格\r\n     * @param data 更新数据\r\n     */\r\n    public updateCell(cell: Cell, data: { [key: string]: any }) {\r\n        this.sheet.updateCell(cell, data);\r\n    }\r\n\r\n    /**\r\n     * 根据单元格坐标获取单元格位置\r\n     * @param data\r\n     */\r\n    public getCellPosition(data: { row: number; col: number }) {\r\n        return this.sheet.getCellPosition(data);\r\n    }\r\n\r\n    /**\r\n     * resize\r\n     */\r\n    public resize(w?: number, h?: number): void {\r\n        const { width, height } = this.parent.offset() as Bounds;\r\n        w = w || width;\r\n        h = h || height;\r\n        this.sheet.resize(w, h);\r\n    }\r\n\r\n    public insertRows(ri: number, rowData: ColumnRowData, config: RowsConfig): void {\r\n        this.sheet.insertRows(ri, rowData, config);\r\n    }\r\n\r\n    public insertCols(ri: number, colData: ColumnRowData, config: ColsConfig): void {\r\n        this.sheet.insertCols(ri, colData, config);\r\n    }\r\n\r\n    public deleteRows(ri: number, rc: number): void {\r\n        this.sheet.deleteRows(ri, rc);\r\n    }\r\n\r\n    public deleteCols(ci: number, cc: number): void {\r\n        this.sheet.deleteCols(ci, cc);\r\n    }\r\n\r\n    /**\r\n     * 销毁全局dom元素\r\n     */\r\n    public tear() {\r\n        this.sheet.tear();\r\n    }\r\n}\r\n\r\nexport default {\r\n    createSheet(rootEl: HTMLElement, config: Config, events?: Events): FineSheet {\r\n        return new FineSheet(rootEl, config, events);\r\n    },\r\n};\r\n\r\nexport interface Events {\r\n    beforeInit?: () => boolean;\r\n    beforeCreate?: () => void;\r\n    created?: () => void;\r\n    render?: () => void;\r\n    beforeMount?: () => void;\r\n    mounted?: () => void;\r\n}\r\n"]}