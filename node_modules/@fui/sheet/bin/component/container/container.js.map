{"version":3,"file":"container.js","sourceRoot":"","sources":["../../../src/component/container/container.ts"],"names":[],"mappings":"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","sourcesContent":["import { Element, h } from '../element';\r\nimport { Waffle } from './waffle';\r\nimport { DataProxy } from '../../core';\r\nimport { Cell, Bounds, Point, Stick } from '../../../types';\r\nimport { bindClickoutside, clamp, intersectRect, isEqual, isNumber, isFunction } from '../../utils';\r\nimport { ScrollBar } from '../scrollbar';\r\nimport { Resizer, Rect } from '../resizer';\r\nimport { ToolTip } from '../tooltip';\r\nimport { OB } from '../../utils/OB';\r\nimport { WheelMode } from '../../utils/wheelMode';\r\nconst MAX_SCROLL_DELTA = 100;\r\n\r\n// 所有sheet上的额外div都会创建到这里\r\n\r\nexport class Container extends OB {\r\n    public el: Element;\r\n    private data: DataProxy;\r\n\r\n    protected gridContainer: Container;\r\n    public verticalScrollBar: ScrollBar;\r\n    public horizontalScrollBar: ScrollBar;\r\n    protected verticalResizer: Resizer;\r\n    protected horizontalResizer: Resizer;\r\n\r\n    private toolTip: ToolTip;\r\n\r\n    protected waffle: Waffle;\r\n\r\n    private stickerTimeouts: number[] = [];\r\n\r\n    // scroll\r\n    private deltaXCache = 0;\r\n    private deltaYCache = 0;\r\n    private scrollTimeout?: NodeJS.Timeout;\r\n\r\n    // stickCell\r\n    private cellCache: Set<string>;\r\n\r\n    private sync = false;\r\n\r\n    private getPointByClient = (clientX: number, clientY: number) => {\r\n        return {\r\n            x: clientX,\r\n            y: clientY,\r\n        };\r\n    };\r\n\r\n    private supportCSSTransform: boolean;\r\n\r\n    /**\r\n     * 运动状态\r\n     *\r\n     * 0: 静止\r\n     * 1: 可以动了\r\n     * 2: 已动\r\n     * 3: XXX\r\n     *\r\n     * @private\r\n     * @type {(0 | 1 | 2 | 3)}\r\n     * @memberof Container\r\n     */\r\n    private moving: 0 | 1 | 2 | 3;\r\n\r\n    private previousPosition: { ri: number; ci: number } = null;\r\n\r\n    public constructor(\r\n        data: DataProxy,\r\n        options: {\r\n            sync?: boolean;\r\n            getPointByClient: (clientX: number, clientY: number) => { x: number; y: number };\r\n            supportCSSTransform: boolean;\r\n        },\r\n    ) {\r\n        super();\r\n        this.el = h('div', 'grid-container');\r\n        this.data = data;\r\n        this.cellCache = new Set();\r\n        this.moving = 0;\r\n        this.sync = options.sync || false;\r\n        options.getPointByClient && (this.getPointByClient = options.getPointByClient);\r\n        this.supportCSSTransform = options.supportCSSTransform;\r\n        // init Resizer\r\n        this.initResizer();\r\n\r\n        // init Grid\r\n        this.initWaffle();\r\n\r\n        // init Scrollbar\r\n        this.initScrollbar();\r\n\r\n        // init tooltip\r\n        this.initTootip();\r\n\r\n        this.initEvent();\r\n    }\r\n    public correctBounds<T extends Bounds>(bounds: T): T {\r\n        return {\r\n            ...bounds,\r\n            x: bounds.x + this.data.offset.offsetX,\r\n            y: bounds.y + this.data.offset.offsetY,\r\n        };\r\n    }\r\n\r\n    public resize(): void {\r\n        this.waffle.update({\r\n            width: this.data.width + this.data.offset.offsetX,\r\n            height: this.data.height + this.data.offset.offsetY,\r\n            freezeWidth: this.data.view.freezeWidth + this.data.offset.offsetX,\r\n            freezeHeight: this.data.view.freezeHeight + this.data.offset.offsetY,\r\n            totalWidth: this.data.view.totalWidth,\r\n            totalHeight: this.data.view.totalHeight,\r\n        });\r\n        this.showSelectArea();\r\n        this.updateStickCells();\r\n        this.updateScrollBar();\r\n        // 矫正冻结+resize情况下scrollbar的位置\r\n        this.whellScroll(0, 0);\r\n    }\r\n\r\n    public reset(): void {\r\n        this.resize();\r\n        this.clean();\r\n    }\r\n\r\n    public stick(stick: Stick, call?: Function): string {\r\n        const id = stick.id;\r\n        if (this.cellCache.has(stick.id)) {\r\n            this.waffle.updateStick(stick);\r\n        } else if (stick.width > 0 && stick.height > 0) {\r\n            stick.left = stick.left + this.data.offset.offsetX;\r\n            stick.top = stick.top + this.data.offset.offsetY;\r\n            const { id: stickerId, mount, isInRange } = this.waffle.stick(stick);\r\n            this.cellCache.add(stickerId);\r\n\r\n            if (isFunction(call)) {\r\n                if (this.sync) {\r\n                    call(this.waffle.getStick(stickerId), stick.width, stick.height, mount, isInRange);\r\n                    \r\n                    return id;\r\n                }\r\n                const timeout = window.setTimeout(() => {\r\n                    call(this.waffle.getStick(stickerId), stick.width, stick.height, mount, isInRange);\r\n                });\r\n\r\n                this.stickerTimeouts.push(timeout);\r\n            }\r\n        }\r\n\r\n        return id;\r\n    }\r\n\r\n    public tearSticker(id: string): void {\r\n        this.waffle.tear(id);\r\n    }\r\n\r\n    public tear() {\r\n        this.toolTip.tear();\r\n    }\r\n\r\n    // 以HTML的形式将单元格粘贴到canvas上层\r\n    public stickCell(ri: number, ci: number, call?: Function): string {\r\n        const id = `${ri}-${ci}`;\r\n        const { el, width, height, x, y } = this.data.view.getMergeCell(ri, ci);\r\n        this.stick(\r\n            {\r\n                el,\r\n                width,\r\n                height,\r\n                left: x,\r\n                top: y,\r\n                id,\r\n            },\r\n            call,\r\n        );\r\n\r\n        return id;\r\n    }\r\n\r\n    public whellScroll(wheelDeltaX: number, wheelDeltaY: number) {\r\n        const { x, y } = this.data.getScroll();\r\n        const newX = Math.round(clamp(x + wheelDeltaX, 0, this.data.maxScrollX));\r\n        const newY = Math.round(clamp(y + wheelDeltaY, 0, this.data.maxScrollY));\r\n        this.scrollHandler(wheelDeltaX, wheelDeltaY, { smooth: false, force: false });\r\n        this.verticalScrollBar.scroll(this.data.scroll.y, false);\r\n        this.horizontalScrollBar.scroll(this.data.scroll.x, false);\r\n\r\n        return {\r\n            scrollX: newX,\r\n            scrollY: newY,\r\n            maxScrollX: this.data.maxScrollX,\r\n            maxScrollY: this.data.maxScrollY,\r\n        };\r\n    }\r\n\r\n    private updateStickCells(): void {\r\n        this.cellCache.forEach((cell): void => {\r\n            const [ri, ci] = cell.split('-');\r\n            this.stickCell(~~ri, ~~ci);\r\n        });\r\n    }\r\n    // 增加了一个设置滚动类型的函数，用于区别拖动滚动条和正常点击，为1时是滚动导致，为0时是点击导致\r\n    public setWheelMode(wheelMode: number) {\r\n        this.waffle.emit('wheelMode', [wheelMode]);\r\n    }\r\n    private initEvent(): void {\r\n        this.waffle.el.on('mouseover', () => {\r\n            this.mountResizer();\r\n\r\n            this.mountScrollbar();\r\n        });\r\n        this.waffle.el.on('contextmenu', e => e.preventDefault());\r\n        this.waffle.el.on('mousedown', this.onMouseDown);\r\n        this.waffle.el.on('mouseup', this.onMouseUp);\r\n        this.waffle.el.on('mousemove', this.onMouseMove);\r\n        this.waffle.el.on('dblclick', this.onDoubleClick);\r\n        this.waffle.el.on('mouseleave', this.onMouseleave);\r\n        this.waffle.el.on('wheel', (e: WheelEvent): void => {\r\n            let wheelDeltaX, wheelDeltaY;\r\n            if (e.deltaMode === 1) {\r\n                wheelDeltaX = e.deltaX * 20;\r\n                wheelDeltaY = e.deltaY * 20;\r\n            } else {\r\n                wheelDeltaX = e.deltaX;\r\n                wheelDeltaY = e.deltaY;\r\n            }\r\n\r\n            this.scrollHandler(wheelDeltaX, wheelDeltaY, { smooth: true, force: false }) && e.preventDefault();\r\n            this.verticalScrollBar.scroll(this.data.scroll.y);\r\n            this.horizontalScrollBar.scroll(this.data.scroll.x);\r\n        });\r\n        let mousePosition = [0, 0];\r\n        this.waffle.el.on('touchstart', (e: TouchEvent) => {\r\n            const { x, y } = this.getPointInfo(e);\r\n            mousePosition = [x, y];\r\n        });\r\n        this.waffle.el.on('touchmove', (e: TouchEvent) => {\r\n            const [mouseX, mouseY] = mousePosition;\r\n            const { x, y } = this.getPointInfo(e);\r\n            mousePosition = [x, y];\r\n            this.scrollHandler(mouseX - x, mouseY - y, { smooth: true, force: false });\r\n            this.verticalScrollBar.scroll(this.data.scroll.y);\r\n            this.horizontalScrollBar.scroll(this.data.scroll.x);\r\n        });\r\n        this.waffle.el.on('mouseout', () => {\r\n            this.data.view.disHover();\r\n        });\r\n        document.addEventListener('mouseup', this.onMouseUp);\r\n\r\n        bindClickoutside(\r\n            this.waffle.el,\r\n            () => {\r\n                this.hideSelectArea();\r\n            },\r\n            false,\r\n        );\r\n\r\n        /**\r\n         * REPORT-64177【填报新前端】点击模板边缘位置，控件移动导致页面显示混乱\r\n         * REPORT-69677【填报新前端】设置填报冻结，页面有横向滚动条时，拖动会使页面复位：三种单元格的scroll方式是不一样的，需要区别处理，类比waffle的scroll函数\r\n         * 修复方式：元素scrollLeft\\scrollTop发生改变时触发位移函数，添加一个防抖的机制，只有因为html元素的focus函数导致的异常位移时（设定阈值为1，可调整），才触发强制位移函数。\r\n         * 类型为br时，x，y都要偏移；类型为tr时，x偏移，y不偏移；类型为bl时，x不偏移，y偏移\r\n         */\r\n        this.waffle.on('focus', (offsetX, offsetY) => {\r\n            this.focusHandler(offsetX, offsetY);\r\n        });\r\n    }\r\n\r\n    private initResizer(): void {\r\n        this.verticalResizer = new Resizer({ direction: 'vertical', onResize: this.resizeHandler });\r\n        this.horizontalResizer = new Resizer({ direction: 'horizontal', onResize: this.resizeHandler });\r\n    }\r\n\r\n    private initTootip(): void {\r\n        this.toolTip = new ToolTip();\r\n    }\r\n\r\n    private initScrollbar(): void {\r\n        // init scrollbar\r\n        const viewBounds = this.data.getViewBounds();\r\n        this.verticalScrollBar = new ScrollBar({\r\n            direction: 'vertical',\r\n            size: viewBounds.height,\r\n            scrollSize: this.data.maxScrollY,\r\n            slider: {},\r\n            onScoll: this.scrollHandler,\r\n        });\r\n        this.horizontalScrollBar = new ScrollBar({\r\n            direction: 'horizontal',\r\n            size: viewBounds.width,\r\n            scrollSize: this.data.maxScrollX,\r\n            slider: {},\r\n            onScoll: this.scrollHandler,\r\n        });\r\n    }\r\n\r\n    private mountResizer() {\r\n        if (this.el.hasChild(this.verticalResizer.el.el) || this.el.hasChild(this.horizontalResizer.el.el)) return;\r\n\r\n        this.el.children(this.verticalResizer.el, this.horizontalResizer.el);\r\n    }\r\n\r\n    private mountScrollbar() {\r\n        if (this.el.hasChild(this.verticalScrollBar.el.el) || this.el.hasChild(this.horizontalScrollBar.el.el)) return;\r\n\r\n        this.el.children(this.verticalScrollBar.el);\r\n\r\n        this.el.children(this.horizontalScrollBar.el);\r\n    }\r\n\r\n    private updateScrollBar(): void {\r\n        const viewBounds = this.data.getViewBounds();\r\n        this.verticalScrollBar.update({\r\n            size: viewBounds.height,\r\n            scrollSize: this.data.maxScrollY,\r\n        });\r\n        this.horizontalScrollBar.update({\r\n            size: viewBounds.width,\r\n            scrollSize: this.data.maxScrollX,\r\n        });\r\n    }\r\n\r\n    private initWaffle(): void {\r\n        const width = this.data.width + this.data.offset.offsetX,\r\n            height = this.data.height + this.data.offset.offsetY,\r\n            freezeWidth = this.data.view.freezeWidth + this.data.offset.offsetX,\r\n            freezeHeight = this.data.view.freezeHeight + this.data.offset.offsetY;\r\n\r\n        this.waffle = new Waffle({\r\n            width,\r\n            height,\r\n            freezeWidth,\r\n            freezeHeight,\r\n            totalWidth: this.data.view.totalWidth,\r\n            totalHeight: this.data.view.totalHeight,\r\n        });\r\n\r\n        this.el.children(this.waffle.el);\r\n    }\r\n\r\n    private onMouseDown = (e: MouseEvent): void => {\r\n        // e.preventDefault();\r\n        const { x: offsetX, y: offsetY, clientX, clientY } = this.getPointInfo(e);\r\n\r\n        const activeCell = this.getActiveCell(offsetX, offsetY);\r\n\r\n        if (activeCell === null || activeCell.stopPropagation) {\r\n            this.moving = 0;\r\n\r\n            return;\r\n        }\r\n\r\n        const activeIndex: Point = [activeCell.ci, activeCell.ri];\r\n        this.moving = 1;\r\n        if (e.shiftKey) {\r\n            const [selectCell] = this.data.selection.getRange();\r\n            this.emit('select', [\r\n                selectCell[1],\r\n                selectCell[0],\r\n                activeIndex[1],\r\n                activeIndex[0],\r\n                { x: offsetX, y: offsetY },\r\n            ]);\r\n            this.showSelectArea();\r\n        } else {\r\n            if (e.button === 2) {\r\n                window.setTimeout(() => {\r\n                    this.emit('contextmenu', [clientX, clientY]);\r\n                }, 0);\r\n                this.moving = 0;\r\n                if (intersectRect([activeIndex, activeIndex], this.data.getSelectRange())) {\r\n                    return;\r\n                }\r\n                this.emit('select', [activeIndex[1], activeIndex[0], undefined, undefined, { x: offsetX, y: offsetY }]);\r\n                this.showSelectArea();\r\n\r\n                return;\r\n            }\r\n\r\n            this.emit('select', [activeIndex[1], activeIndex[0], undefined, undefined, { x: offsetX, y: offsetY }]);\r\n            this.data.view.doMouseDown(\r\n                e,\r\n                {\r\n                    x: offsetX,\r\n                    y: offsetY,\r\n                    ri: activeCell.ri,\r\n                    ci: activeCell.ci,\r\n                },\r\n                this.data.getPositionByOffset(offsetX, offsetY),\r\n            );\r\n        }\r\n    };\r\n\r\n    private onMouseMove = (e: MouseEvent): void => {\r\n        this.verticalScrollBar.scroll(this.data.scroll.y);\r\n        this.horizontalScrollBar.scroll(this.data.scroll.x);\r\n        const { x: offsetX, y: offsetY, clientX, clientY } = this.getPointInfo(e);\r\n        if (clientX <= 0 && clientY <= 0) {\r\n            this.data.view.disHover();\r\n\r\n            return;\r\n        }\r\n        // 触发resizer\r\n        if (offsetX < this.data.offset.offsetX || offsetY < this.data.offset.offsetY) {\r\n            const resizerCell = this.data.getResizerCell(offsetX, offsetY);\r\n            if (offsetY > this.data.offset.offsetY) {\r\n                this.verticalResizer.hide();\r\n                this.horizontalResizer.show(\r\n                    resizerCell as Rect,\r\n                    { width: this.data.width, height: 2 },\r\n                    {\r\n                        min: -resizerCell.height,\r\n                    },\r\n                );\r\n            }\r\n            if (offsetX > this.data.offset.offsetX) {\r\n                this.verticalResizer.show(\r\n                    resizerCell as Rect,\r\n                    { width: 2, height: this.data.height },\r\n                    {\r\n                        min: -resizerCell.width,\r\n                    },\r\n                );\r\n                this.horizontalResizer.hide();\r\n            }\r\n        } else {\r\n            // 不清楚为什么有时候会null(没还原，保险起见)\r\n            this.horizontalResizer && this.horizontalResizer.hide();\r\n            this.verticalResizer && this.verticalResizer.hide();\r\n\r\n            const activeCell = this.getActiveCell(offsetX, offsetY);\r\n\r\n            const position = this.data.getPositionByOffset(offsetX, offsetY);\r\n\r\n            if (activeCell === null) {\r\n                if (this.previousPosition !== null) {\r\n                    this.data.view.doMouseLeave(\r\n                        e,\r\n                        {\r\n                            x: offsetX,\r\n                            y: offsetY,\r\n                            ri: this.previousPosition.ri,\r\n                            ci: this.previousPosition.ci,\r\n                        },\r\n                        position,\r\n                    );\r\n\r\n                    this.previousPosition = null;\r\n                }\r\n                this.toolTip.hide();\r\n                this.setMouseCursorByEvent(e, 'default');\r\n                this.data.view.disHover();\r\n\r\n                return;\r\n            }\r\n\r\n            const currentPosition = {\r\n                ri: activeCell.ri,\r\n                ci: activeCell.ci,\r\n            };\r\n            if (!isEqual(this.previousPosition, currentPosition) && this.previousPosition !== null) {\r\n                this.data.view.doMouseLeave(\r\n                    e,\r\n                    {\r\n                        x: offsetX,\r\n                        y: offsetY,\r\n                        ri: this.previousPosition.ri,\r\n                        ci: this.previousPosition.ci,\r\n                    },\r\n                    position,\r\n                );\r\n            }\r\n            this.previousPosition = currentPosition;\r\n\r\n            if (this.moving) {\r\n                this.moving = 2;\r\n                const selectCell = this.data.selection.getCell();\r\n                this.emit('select', [\r\n                    selectCell[1],\r\n                    selectCell[0],\r\n                    activeCell.ri,\r\n                    activeCell.ci,\r\n                    { x: offsetX, y: offsetY },\r\n                ]);\r\n                this.showSelectArea();\r\n            }\r\n            const cell = this.data.view.getMergeCell(activeCell.ri, activeCell.ci);\r\n            this.data.view.doHover(\r\n                e,\r\n                {\r\n                    x: offsetX,\r\n                    y: offsetY,\r\n                    ri: activeCell.ri,\r\n                    ci: activeCell.ci,\r\n                },\r\n                position,\r\n            );\r\n            const { x: absoluteX, y: absoluteY } = this.data.offset2Absolute({ x: offsetX, y: offsetY }, cell);\r\n            if (this.data.view.isHoverText(cell, absoluteX, absoluteY)) {\r\n                if (!cell.cursor || cell.cursor === 'default') {\r\n                    this.setMouseCursorByEvent(e, 'text');\r\n                } else {\r\n                    this.setMouseCursorByEvent(e, cell.cursor);\r\n                }\r\n            }\r\n            if (cell.title) {\r\n                this.toolTip.show(cell.title, clientX, clientY);\r\n            } else {\r\n                this.toolTip.hide();\r\n            }\r\n        }\r\n        this.emit('hover', [offsetX, offsetY]);\r\n    };\r\n\r\n    private onMouseleave = (): void => {\r\n        this.toolTip.hide();\r\n    };\r\n\r\n    private onDoubleClick = (e: MouseEvent): void => {\r\n        this.setWheelMode(WheelMode.WHEELMODE_FOCUS);\r\n        // const { clientX, clientY } = e;\r\n        // const { left, top } = this.el.el.getBoundingClientRect();\r\n        const { x: offsetX, y: offsetY } = this.getPointInfo(e);\r\n        const activeCell = this.getActiveCell(offsetX, offsetY);\r\n        const cell = this.data.getSelectCell();\r\n        if (!this.isDoubleClickable(offsetX, offsetY, cell)) {\r\n            this.emit('dblclick', [offsetX, offsetY]);\r\n\r\n            this.data.view.doDbClick(\r\n                e,\r\n                {\r\n                    x: offsetX,\r\n                    y: offsetY,\r\n                    ri: activeCell.ri,\r\n                    ci: activeCell.ci,\r\n                },\r\n                this.data.getPositionByOffset(offsetX, offsetY),\r\n            );\r\n        }\r\n    };\r\n\r\n    private isDoubleClickable(x: number, y: number, cell: Cell) {\r\n        const { verticalFreezed, horizontalFreezed } = this.data.cellIsFreezed(cell);\r\n        const offsetX = x + (verticalFreezed ? 0 : this.data.getScroll().x) - this.data.offset.offsetX;\r\n        const offsetY = y + (horizontalFreezed ? 0 : this.data.getScroll().y) - this.data.offset.offsetY;\r\n        if (\r\n            cell.dblclick === false &&\r\n            cell.left <= offsetX &&\r\n            cell.left + cell.width >= offsetX &&\r\n            cell.top <= offsetY &&\r\n            cell.top + cell.height >= offsetY\r\n        ) {\r\n            return true;\r\n        } else if (cell.items) {\r\n            return cell.items.some(item => this.isDoubleClickable(x, y, item.el));\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    private onMouseUp = (e: MouseEvent): void => {\r\n        this.setWheelMode(WheelMode.WHEELMODE_FOCUS);\r\n\r\n        const { x: offsetX, y: offsetY } = this.getPointInfo(e);\r\n        // 在window下的chrome上，onMouseMove也会触发，此时this.moving===2\r\n        // 在mac下的chrome上，onMouseMove不会触发，此时this.moving===1\r\n        const activeCell = this.getActiveCell(offsetX, offsetY);\r\n        const selectCell = this.data.selection.getCell();\r\n        if (\r\n            activeCell &&\r\n            (this.moving === 1 ||\r\n                this.moving === 2 && activeCell.ri === selectCell[1] && activeCell.ci === selectCell[0]) &&\r\n            !e.shiftKey &&\r\n            e.button !== 2\r\n        ) {\r\n            if (activeCell === null || activeCell.stopPropagation) {\r\n                this.moving = 0;\r\n\r\n                return;\r\n            }\r\n\r\n            // moving为2时是选中状态下再次点击则取消选择\r\n            this.moving !== 2 && this.hideSelectArea();\r\n            this.data.view.doClick(\r\n                e,\r\n                {\r\n                    x: offsetX,\r\n                    y: offsetY,\r\n                    ri: activeCell.ri,\r\n                    ci: activeCell.ci,\r\n                },\r\n                this.data.getPositionByOffset(offsetX, offsetY),\r\n            );\r\n        } else if (this.moving === 0) {\r\n            // 点击到无效区域隐藏掉选择\r\n            if (e.currentTarget !== document && !activeCell) {\r\n                this.hideSelectArea();\r\n            }\r\n        }\r\n        this.moving = 0;\r\n    };\r\n\r\n    private resizeHandler = (rect, distance, direction): void => {\r\n        this.emit('resize', [rect, distance, direction]);\r\n        this.resize();\r\n    };\r\n\r\n    private focusHandler(offsetX, offsetY) {\r\n        const beforeX = offsetX;\r\n        const afterX = this.data.scroll.x;\r\n        const beforeY = offsetY;\r\n        const afterY = this.data.scroll.y;\r\n        if (Math.abs(beforeX - afterX) > 1 && isNumber(offsetX)) {\r\n            this.whellScroll(beforeX - afterX, 0);\r\n        }\r\n        if (Math.abs(beforeY - afterY) > 1 && isNumber(offsetY)) {\r\n            this.whellScroll(0, beforeY - afterY);\r\n        }\r\n    }\r\n    private scrollHandler = (deltaX: number, deltaY: number, options = { smooth: false, force: false }): boolean => {\r\n        if (deltaX === 0 && deltaY === 0 && !options.force) {\r\n            return true;\r\n        }\r\n        this.hideSelectArea();\r\n        if (this.scrollTimeout) {\r\n            clearTimeout(this.scrollTimeout);\r\n        }\r\n        if (options.smooth) {\r\n            deltaX = Math.min(deltaX, MAX_SCROLL_DELTA);\r\n            deltaY = Math.min(deltaY, MAX_SCROLL_DELTA);\r\n        }\r\n\r\n        const { x, y } = this.data.getScroll();\r\n        const originDeltaX = deltaX,\r\n            originDeltaY = deltaY;\r\n\r\n        deltaX += this.deltaXCache;\r\n        deltaY += this.deltaYCache;\r\n\r\n        let newDeltaX = this.data.correctDeltaX(deltaX);\r\n        let newDeltaY = this.data.correctDeltaY(deltaY);\r\n\r\n        newDeltaX = originDeltaX > 0 ? Math.max(0, newDeltaX) : Math.min(0, newDeltaX);\r\n        newDeltaY = originDeltaY > 0 ? Math.max(0, newDeltaY) : Math.min(0, newDeltaY);\r\n\r\n        this.deltaXCache = deltaX - newDeltaX;\r\n        this.deltaYCache = deltaY - newDeltaY;\r\n\r\n        this.scrollTimeout = setTimeout((): void => {\r\n            this.deltaXCache = 0;\r\n            this.deltaYCache = 0;\r\n            this.showSelectArea();\r\n        }, 300);\r\n\r\n        const newX = Math.round(clamp(x + newDeltaX, 0, this.data.maxScrollX));\r\n        const newY = Math.round(clamp(y + newDeltaY, 0, this.data.maxScrollY));\r\n\r\n        if (newX === this.data.maxScrollX && deltaX > 0 || newX === 0 && deltaX < 0) {\r\n            this.deltaXCache = 0;\r\n        }\r\n        if (newY === this.data.maxScrollY && deltaY > 0 || newY === 0 && deltaY < 0) {\r\n            this.deltaYCache = 0;\r\n        }\r\n\r\n        if (Math.abs(newDeltaX) > Math.abs(newDeltaY)) {\r\n            this.emit('scroll', [newX, 'horizontal']);\r\n        } else {\r\n            this.emit('scroll', [newY, 'vertical']);\r\n        }\r\n\r\n        this.waffle.scroll(-newX, -newY);\r\n\r\n        return (\r\n            !(Math.abs(newDeltaX) > Math.abs(newDeltaY)\r\n                ? newX <= 0 || newX >= this.data.maxScrollX\r\n                : newY <= 0 || newY >= this.data.maxScrollY) ||\r\n            this.deltaXCache !== 0 ||\r\n            this.deltaYCache !== 0\r\n        );\r\n    };\r\n\r\n    private showInputCell(): void {\r\n        const cell = this.data.getSelectCell();\r\n        cell.x = cell.x + this.data.offset.offsetX;\r\n        cell.y = cell.y + this.data.offset.offsetY;\r\n    }\r\n\r\n    private showSelectArea(): void {\r\n        const bounds = this.data.getSelectBounds();\r\n        this.waffle.showSelectArea(bounds);\r\n    }\r\n\r\n    private hideSelectArea(): void {\r\n        this.waffle.hideSelectArea();\r\n        this.data.clearSelection();\r\n    }\r\n\r\n    private clean(): void {\r\n        this.cellCache = new Set();\r\n        this.stickerTimeouts.forEach(timeout => {\r\n            window.clearTimeout(timeout);\r\n        });\r\n        this.stickerTimeouts = [];\r\n        this.waffle.clean();\r\n    }\r\n\r\n    private getActiveCell(x, y): Cell | null {\r\n        const cell = this.data.getCellByOffset(x, y);\r\n        if (!cell) {\r\n            return null;\r\n        } else {\r\n            return cell.valid === false ? null : cell;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据MouseEvent给鼠标设置样式\r\n     *\r\n     * 有Sticker的缘故，直接给target设置鼠标样式的时候会出现target变来变去的情况，\r\n     * 不好控制样式的还原与变化，因此固定到统一的DOM上去做这件事\r\n     *\r\n     * @param e\r\n     * @param cursor\r\n     */\r\n    private setMouseCursorByEvent(e: MouseEvent, cursor: string) {\r\n        const grids = this.waffle.getGrids().map(grid => grid.el.el);\r\n        const root = this.waffle.el.el;\r\n        let target = e.target as HTMLElement;\r\n\r\n        // 鼠标样式只管到grid块\r\n        while (target && target !== root && !grids.includes(target)) {\r\n            target = target.parentElement;\r\n        }\r\n\r\n        target && (target.style.cursor = cursor);\r\n    }\r\n\r\n    private getActivePosition(x, y): Point {\r\n        const { left, top } = this.el.el.getBoundingClientRect();\r\n        const offsetX = x - left,\r\n            offsetY = y - top;\r\n\r\n        return [offsetX, offsetY];\r\n    }\r\n\r\n    /**\r\n     * 根据事件获得坐标信息\r\n     * @param ev\r\n     * @returns\r\n     */\r\n    private getPointInfo(ev: MouseEvent | TouchEvent) {\r\n        const clientPoint = this.getClientByEvent(ev);\r\n        const point = this.getPointByEvent(ev);\r\n\r\n        return {\r\n            x: point.x,\r\n            y: point.y,\r\n            clientX: clientPoint.x,\r\n            clientY: clientPoint.y,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 根据事件获取窗口的坐标\r\n     * @param event\r\n     * @returns\r\n     */\r\n    private getClientByEvent(event: MouseEvent | TouchEvent) {\r\n        let clientInfo: MouseEvent | Touch = event as MouseEvent;\r\n        if (window.TouchEvent && event instanceof TouchEvent) {\r\n            if (event.type === 'touchend') {\r\n                clientInfo = event.changedTouches[0];\r\n            } else {\r\n                clientInfo = event.targetTouches[0];\r\n            }\r\n        }\r\n\r\n        return {\r\n            x: clientInfo.clientX,\r\n            y: clientInfo.clientY,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 根据事件获取画布坐标\r\n     * @param event\r\n     * @returns\r\n     */\r\n    private getPointByEvent(event: MouseEvent | TouchEvent) {\r\n        const grids = this.waffle.getGrids().map(grid => grid.el.el);\r\n\r\n        const root = this.waffle.el.el;\r\n\r\n        const stickerContainerClassName = Waffle.STICKER_CONTAINER_CLASS_NAME;\r\n\r\n        function getOffsetX(offsetX: number, el: HTMLElement) {\r\n            let x = offsetX;\r\n            let dom = el;\r\n\r\n            while (dom && dom !== root && !grids.includes(dom)) {\r\n                /**\r\n                 * 重置一下target起点，屏蔽sticker内部dom的offset关系，确保offsetParent永远都是grid\r\n                 */\r\n                `${dom.className}`.includes(stickerContainerClassName)\r\n                    ? x = offsetX + dom.offsetLeft\r\n                    : x += dom.offsetLeft;\r\n\r\n                dom = dom.parentElement;\r\n            }\r\n            // 处理一下grid块内部的offset关系\r\n            dom && (x -= dom.scrollLeft - dom.offsetLeft);\r\n\r\n            return x;\r\n        }\r\n\r\n        function getOffsetY(offsetY: number, el: HTMLElement) {\r\n            let y = offsetY;\r\n            let dom = el;\r\n\r\n            while (dom && dom !== root && !grids.includes(dom)) {\r\n                /**\r\n                 * 重置一下target起点，屏蔽sticker内部dom的offset关系，确保offsetParent永远都是grid\r\n                 */\r\n                `${dom.className}`.includes(stickerContainerClassName)\r\n                    ? y = offsetY + dom.offsetTop\r\n                    : y += dom.offsetTop;\r\n\r\n                dom = dom.parentElement;\r\n            }\r\n            // 处理一下grid块内部的offset关系\r\n            dom && dom.parentElement && (y -= dom.scrollTop - dom.parentElement.offsetTop);\r\n\r\n            return y;\r\n        }\r\n\r\n        if (this.supportCSSTransform) {\r\n            if (event instanceof MouseEvent) {\r\n                return {\r\n                    x: getOffsetX(event.offsetX, event.target as HTMLElement),\r\n                    y: getOffsetY(event.offsetY, event.target as HTMLElement),\r\n                };\r\n            }\r\n        }\r\n        // TODO: 其他的Case还需要在想想办法计算\r\n        const { x, y } = this.getClientByEvent(event);\r\n\r\n        return this.getPointByClient(x, y);\r\n    }\r\n}\r\n"]}