{"version":3,"file":"inputbox.js","sourceRoot":"","sources":["../../src/component/inputbox.ts"],"names":[],"mappings":"AAAA,OAAO,EAAW,CAAC,EAAE,MAAM,WAAW,CAAC;AAEvC,OAAO,EAAE,kBAAkB,EAAE,gBAAgB,EAAE,YAAY,EAAE,cAAc,EAAE,gBAAgB,EAAE,MAAM,UAAU,CAAC;AAEhH,MAAM,OAAO,QAAQ;IAMjB,YAAmB,EAAE,IAAI,EAAE,QAAQ,GAAG,KAAK,EAAE;QACzC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,KAAK,EAAE,WAAW,CAAC,CAAC,IAAI,EAAE,CAAC;QACvC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC,IAAI,CAAC,iBAAiB,EAAE,GAAG,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE7E,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC7B,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAC1C,CAAC;IACM,IAAI,CAAC,CAAS,EAAE,CAAS,EAAE,KAAa,EAAE,MAAc;QAC3D,IAAI,KAAK,IAAI,CAAC,IAAI,MAAM,IAAI,CAAC,EAAE;YAC3B,OAAO;SACV;QACD,IAAI,CAAC,EAAE;aACF,GAAG,CAAC;YACD,IAAI,EAAE,GAAG,CAAC,GAAG,CAAC,IAAI;YAClB,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,IAAI;YACjB,QAAQ,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,EAAE,IAAI;YACpE,QAAQ,EAAE,GAAG,KAAK,GAAG,CAAC,IAAI;YAC1B,SAAS,EAAE,GAAG,MAAM,GAAG,CAAC,IAAI;YAC5B,SAAS,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,EAAE,IAAI;SACzE,CAAC;aACD,IAAI,EAAE,CAAC;QACZ,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACpB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC;QACnC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,KAAK,CAAC,CAAC;QAChD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAE/B,MAAM,SAAS,GAAG,YAAY,EAAE,CAAC;QACjC,MAAM,KAAK,GAAG,QAAQ,CAAC,WAAW,EAAE,CAAC;QACrC,SAAS,CAAC,eAAe,EAAE,CAAC;QAC5B,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACvC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,cAAc,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC;QACtD,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;QAE1B,gBAAgB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC1B,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAC5B,CAAC;IACM,IAAI;QACP,IAAI,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC;QACf,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC5B,gBAAgB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAC9B,CAAC;IACM,IAAI;QACP,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAC1C,CAAC;CACJ","sourcesContent":["import { Element, h } from './element';\r\nimport { DataProxy } from '../core';\r\nimport { unbindClickoutside, bindClickoutside, getSelection, bindMouseWhell, unbindMouseWhell } from '../utils';\r\n\r\nexport class InputBox {\r\n    private data: DataProxy;\r\n    public el: Element;\r\n    public input: Element;\r\n    public text: Element;\r\n\r\n    public constructor({ data, editable = false }) {\r\n        this.data = data;\r\n        this.el = h('div', 'input-box').hide();\r\n        this.input = h('div', 'cell-input').attr('contenteditable', `${!!editable}`);\r\n\r\n        this.el.children(this.input);\r\n        document.body.appendChild(this.el.el);\r\n    }\r\n    public show(x: number, y: number, width: number, height: number) {\r\n        if (width <= 0 || height <= 0) {\r\n            return;\r\n        }\r\n        this.el\r\n            .css({\r\n                left: `${x - 2}px`,\r\n                top: `${y - 2}px`,\r\n                maxWidth: `${this.data.width - x + this.data.offset.offsetX - 12}px`,\r\n                minWidth: `${width + 2}px`,\r\n                minHeight: `${height + 2}px`,\r\n                maxHeight: `${this.data.height - y + this.data.offset.offsetY - 12}px`,\r\n            })\r\n            .show();\r\n        this.input.text('');\r\n        this.text = this.text || h('span');\r\n        this.text.text(this.data.getSelectCell().value);\r\n        this.input.children(this.text);\r\n\r\n        const selection = getSelection();\r\n        const range = document.createRange();\r\n        selection.removeAllRanges();\r\n        range.selectNodeContents(this.text.el);\r\n        range.setStart(range.startContainer, range.endOffset);\r\n        selection.addRange(range);\r\n\r\n        bindClickoutside(this.el);\r\n        bindMouseWhell(this.el);\r\n    }\r\n    public hide() {\r\n        this.el.hide();\r\n        unbindClickoutside(this.el);\r\n        unbindMouseWhell(this.el);\r\n    }\r\n    public tear() {\r\n        document.body.removeChild(this.el.el);\r\n    }\r\n}\r\n"]}