var finesheet=function(){"use strict";var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};function e(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}var i=function(){return(i=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function r(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(i[r[o]]=t[r[o]])}return i}function o(t,e,i,r){var o,n=arguments.length,s=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,i,s):o(e,i))||s);return n>3&&s&&Object.defineProperty(e,i,s),s}function n(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<i;e++)for(var n=arguments[e],s=0,a=n.length;s<a;s++,o++)r[o]=n[s];return r}"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});!function(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===i&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}(".sheet {\n  position: relative;\n  overflow: hidden;\n  color: #000000;\n}\n.sheet canvas {\n  -webkit-font-smoothing: subpixel-antialiased;\n  -moz-osx-font-smoothing: auto;\n}\n.sheet .grid-container .sheet-resizer {\n  position: absolute;\n  z-index: 7;\n}\n.sheet .grid-container .sheet-resizer.vertical .sheet-resizer-hover {\n  cursor: col-resize;\n}\n.sheet .grid-container .sheet-resizer.horizontal .sheet-resizer-hover {\n  cursor: row-resize;\n}\n.sheet .grid-container .sheet-resizer-hover {\n  background-color: #4d90fe;\n}\n.sheet .grid-container .sheet-resizer-line {\n  position: absolute;\n  background-color: #4d90fe;\n}\n.sheet .grid-container .grid-container.empty {\n  background-color: #ffffff;\n  opacity: 0;\n}\n.sheet .grid-container .ie10-below .grid-container-top,\n.sheet .grid-container .ie10-below .grid-container-bottom {\n  background-image: url('about:blank');\n}\n.sheet .sheet-table {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: auto;\n  height: auto;\n}\n.sheet .sheet-scrollbar {\n  z-index: auto;\n  transition: opacity 0.5s ease;\n}\n.sheet .sheet-scrollbar:hover,\n.sheet .sheet-scrollbar.active {\n  opacity: 1;\n}\n.sheet .sheet-scrollbar:hover .sheet-scrollbar-slider,\n.sheet .sheet-scrollbar.active .sheet-scrollbar-slider {\n  background-color: #7d7d7d;\n}\n.sheet .sheet-scrollbar.sheet-scrollbar-y {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  width: 12px;\n}\n.sheet .sheet-scrollbar.sheet-scrollbar-x {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  height: 12px;\n}\n.sheet .sheet-scrollbar .sheet-scrollbar-slider {\n  height: 10px;\n  margin: 1px;\n  background-color: #c2c2c2;\n  opacity: 0.8;\n  border-radius: 5px;\n}\n.sheet .sheet-scrollbar .sheet-scrollbar-slider:hover {\n  background-color: #7d7d7d;\n  opacity: 1;\n}\n.inline-grid {\n  display: inline-block;\n  position: absolute;\n  overflow: hidden;\n}\n.grid-container {\n  width: auto;\n  height: auto;\n}\n.grid-container-bottom,\n.grid-container-top {\n  position: absolute;\n  white-space: nowrap;\n  overflow: hidden;\n}\n.range-border {\n  position: absolute;\n  border-width: 0;\n  padding: 0;\n}\n.active-area {\n  background: #4d8ff5;\n  opacity: 0.4;\n}\n.active-cell-border,\n.active-area-border {\n  border-color: #1a73e8;\n  border-style: solid;\n  opacity: 1;\n}\n.waffle-borderless-sticker {\n  position: absolute;\n  white-space: normal;\n  overflow: hidden;\n}\n.trix-offscreen {\n  position: absolute;\n  left: -10000px;\n  top: -10000px;\n}\n.scrollable-grid {\n  position: absolute;\n}\n.sheet-tooltip {\n  position: absolute;\n  z-index: 1002;\n  padding: 2px;\n  font-size: 10px;\n  background: #647185;\n  border: 1px solid #647185;\n  max-width: 250px;\n  border-radius: 2px;\n  font-size: 12px;\n  color: #ffffff;\n  white-space: pre;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  word-break: break-all;\n  overflow: hidden;\n}\n.sheet-menu {\n  position: absolute;\n  z-index: 1001;\n  padding: 2px 0;\n  font-size: 12px;\n  background: #ffffff;\n  cursor: default;\n  border: 1px solid transparent;\n  border-radius: 2px;\n  box-shadow: 0 2px 6px 2px rgba(60, 64, 67, 0.15);\n}\n.sheet-menu .sheet-menuitem {\n  cursor: pointer;\n  width: 120px;\n  height: 24px;\n  line-height: 24px;\n}\n.sheet-menu .sheet-menuitem.disable {\n  pointer-events: none;\n  color: #c1c1c1;\n}\n.sheet-menu .sheet-menuitem:active {\n  background: #e8eaed;\n}\n.sheet-menu .sheet-menuseparator {\n  border-top: 1px solid #dadce0;\n  margin: 4px 2px;\n}\n.input-box {\n  position: absolute;\n  z-index: 1000;\n  background: #ffffff;\n  border: 2px #1a73e8 solid;\n  overflow: auto;\n}\n.input-box .cell-input {\n  outline: none;\n  cursor: text;\n  -webkit-user-select: text;\n     -moz-user-select: text;\n          user-select: text;\n  width: 100%;\n  height: 100%;\n  overflow-wrap: break-word;\n  white-space: pre-wrap;\n}\n");var s=function(){function t(t,e){void 0===e&&(e=""),"string"==typeof t?(this.el=document.createElement(t),this.el.className=e):this.el=t}return t.prototype.on=function(t,e){return this.el.addEventListener(t,e),this},t.prototype.off=function(t,e){return this.el.removeEventListener(t,e),this},t.prototype.children=function(){for(var e=this,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return i.forEach(function(i){i instanceof t?e.el.appendChild(i.el):e.el.appendChild(i)}),this},t.prototype.unshiftChildren=function(){for(var e=this,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return i.forEach(function(i){i instanceof t?e.el.insertBefore(i.el,e.el.firstChild):e.el.insertBefore(i,e.el.firstChild)}),this},t.prototype.css=function(t,e){var i=this;return void 0===e&&"string"==typeof t?this.el.style[t]:("number"==typeof t||"string"==typeof t?this.el.style[t]=e:Object.keys(t).forEach(function(e){i.el.style[e]=t[e]}),this)},t.prototype.offset=function(t){var e=this;if(void 0===t){var i=this.el,r=i.offsetTop,o=i.offsetLeft;return{top:r,left:o,height:i.offsetHeight-r,width:i.offsetWidth-o}}return Object.keys(t).forEach(function(i){e.el.style[i]=t[i]+"px"}),this},t.prototype.addClass=function(t){return new RegExp(t,"ig").test(this.el.className)||(this.el.className=this.el.className+" "+t),this},t.prototype.removeClass=function(t){return new RegExp(t,"ig").test(this.el.className)&&(this.el.className=this.el.className.replace(t,"")),this},t.prototype.html=function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML},t.prototype.text=function(t){return void 0!==t?(this.el.innerText=t,this):this.el.innerText},t.prototype.attr=function(t,e){return this.el.setAttribute(t,e),this},t.prototype.contains=function(t){return this.el.contains(t)},t.prototype.remove=function(){this.el.remove()},t.prototype.hide=function(){return this.css("display","none"),this},t.prototype.show=function(){return this.css("display","block"),this},t.prototype.focus=function(){return this.el.focus(),this},t.prototype.disableChild=function(t){for(var e=0;e<this.el.childNodes.length;e++){var i=this.el.childNodes[e];i.className.includes(t)&&!i.className.includes("disable")&&(i.className=i.className+" disable")}},t.prototype.childEnable=function(t){for(var e=0;e<this.el.childNodes.length;e++){var i=this.el.childNodes[e];i.className.includes(t)&&(i.className=i.className.replace(" disable",""))}},t.prototype.hasChild=function(t){for(var e=!1,i=0;i<this.el.childNodes.length;i++){var r=this.el.childNodes[i];if(e=t instanceof HTMLElement?r===t:r===t.el)break}return e},t.prototype.scroll=function(t){var e=t.top,i=t.left;this.el.scrollLeft=i,this.el.scrollTop=e},t}(),a=function(t,e){return void 0===e&&(e=""),new s(t,e)},h={};function l(t){return function(e){h[t]=e}}function c(t){var e=t.type,i=void 0===e?"bi.label":e;return h[i]?new h[i](t):null}var d={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},f=/^#([a-f0-9]{3})$/i,u=function(t){var e=t.match(f);return!!e&&[parseInt(e[1][0]+e[1][0],16),parseInt(e[1][1]+e[1][1],16),parseInt(e[1][2]+e[1][2],16),null]},p=/^#([a-f0-9]{6})$/i,g=function(t){var e=t.match(p);return!!e&&[parseInt(e[1].substring(0,2),16),parseInt(e[1].substring(2,4),16),parseInt(e[1].substring(4,6),16),null]},v=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/,y=function(t){var e=t.match(v);return!!e&&[Number(e[1]),Number(e[2]),Number(e[3]),null]},w=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/,b=function(t){var e=t.match(w);return!!(e&&e.length>4)&&[Number(e[1]),Number(e[2]),Number(e[3]),Number(e[4])]},m=function(t){return[Math.min(t[0],255),Math.min(t[1],255),Math.min(t[2],255),t.length>3?t[3]:null]},x=function(t){var e=d[t.toLowerCase()];return e||!1},S=function(){function t(t){var e=Array.isArray(t)?m(t):u(t)||y(t)||b(t)||x(t)||g(t)||[255,255,255,0],i=e[0],r=e[1],o=e[2],n=e[3];this.r=i,this.g=r,this.b=o,this.a=n}return t.prototype.isTransparent=function(){return 0===this.a},t.prototype.toString=function(){return null!==this.a&&1!==this.a&&void 0!==this.a?"rgba("+this.r+","+this.g+","+this.b+","+this.a+")":"rgb("+this.r+","+this.g+","+this.b+")"},t}();new S([0,0,0,0]);function C(){var t=window.screen,e=1;return window.devicePixelRatio?e=window.devicePixelRatio:t.systemXDPI&&t.logicalXDPI&&(e=t.systemXDPI/t.logicalXDPI),e>1?Math.ceil(e):1}function k(t){return~~(""+t)+"px"}function z(t,e){var i=e.fontStyle,r=void 0===i?"":i,o=e.fontWeight,n=void 0===o?"":o,s=e.fontSize,a=void 0===s?"":s,h=e.fontFamily,l=void 0===h?"":h;t.font=r+" "+n+" "+a+' "Helvetica Neue"',t.font=r+" "+n+" "+a+' "'+l+'"'}var M={};function E(t){var e=t.fontFamily+" "+t.fontSize;return void 0===M[e]&&(M[e]=function(t){var e=document.createElement("div"),i=document.createElement("img"),r=document.createElement("span"),o=document.body;if(!o)throw new Error("");e.style.visibility="hidden",e.style.fontFamily=t.fontFamily,e.style.fontSize=t.fontSize,e.style.margin="0",e.style.padding="0",e.appendChild(document.createTextNode("Hidden Text")),o.appendChild(e),i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",i.width=1,i.height=Math.round(parseFloat(t.fontSize)/10),i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",e.appendChild(r),e.appendChild(i);var n=Math.round(parseFloat(t.fontSize)/3)+i.height+1;e.style.lineHeight="normal",i.style.verticalAlign="super";var s=i.offsetTop-e.offsetTop+i.height+1;return o.removeChild(e),{baseline:n,middle:s}}(t)),M[e]}function T(){return window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection}var A=Object.prototype;function B(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||A)}function _(t,e){return function(i){return t(e(i))}}var j=_(Object.keys,Object),R=Object.prototype.hasOwnProperty;function O(t){if(!B(t))return j(t);var e=[];for(var i in Object(t))R.call(t,i)&&"constructor"!=i&&e.push(i);return e}var H="object"==typeof global&&global&&global.Object===Object&&global,W="object"==typeof self&&self&&self.Object===Object&&self,L=H||W||Function("return this")(),I=L.Symbol,P=Object.prototype,D=P.hasOwnProperty,X=P.toString,N=I?I.toStringTag:void 0;var Y=Object.prototype.toString;var G="[object Null]",F="[object Undefined]",q=I?I.toStringTag:void 0;function V(t){return null==t?void 0===t?F:G:q&&q in Object(t)?function(t){var e=D.call(t,N),i=t[N];try{t[N]=void 0;var r=!0}catch(t){}var o=X.call(t);return r&&(e?t[N]=i:delete t[N]),o}(t):function(t){return Y.call(t)}(t)}function U(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var $="[object AsyncFunction]",K="[object Function]",J="[object GeneratorFunction]",Q="[object Proxy]";function Z(t){if(!U(t))return!1;var e=V(t);return e==K||e==J||e==$||e==Q}var tt,et=L["__core-js_shared__"],it=(tt=/[^.]+$/.exec(et&&et.keys&&et.keys.IE_PROTO||""))?"Symbol(src)_1."+tt:"";var rt=Function.prototype.toString;function ot(t){if(null!=t){try{return rt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var nt=/^\[object .+?Constructor\]$/,st=Function.prototype,at=Object.prototype,ht=st.toString,lt=at.hasOwnProperty,ct=RegExp("^"+ht.call(lt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function dt(t){return!(!U(t)||(e=t,it&&it in e))&&(Z(t)?ct:nt).test(ot(t));var e}function ft(t,e){var i=function(t,e){return null==t?void 0:t[e]}(t,e);return dt(i)?i:void 0}var ut=ft(L,"DataView"),pt=ft(L,"Map"),gt=ft(L,"Promise"),vt=ft(L,"Set"),yt=ft(L,"WeakMap"),wt=ot(ut),bt=ot(pt),mt=ot(gt),xt=ot(vt),St=ot(yt),Ct=V;(ut&&"[object DataView]"!=Ct(new ut(new ArrayBuffer(1)))||pt&&"[object Map]"!=Ct(new pt)||gt&&"[object Promise]"!=Ct(gt.resolve())||vt&&"[object Set]"!=Ct(new vt)||yt&&"[object WeakMap]"!=Ct(new yt))&&(Ct=function(t){var e=V(t),i="[object Object]"==e?t.constructor:void 0,r=i?ot(i):"";if(r)switch(r){case wt:return"[object DataView]";case bt:return"[object Map]";case mt:return"[object Promise]";case xt:return"[object Set]";case St:return"[object WeakMap]"}return e});var kt=Ct;function zt(t){return null!=t&&"object"==typeof t}var Mt="[object Arguments]";function Et(t){return zt(t)&&V(t)==Mt}var Tt=Object.prototype,At=Tt.hasOwnProperty,Bt=Tt.propertyIsEnumerable,_t=Et(function(){return arguments}())?Et:function(t){return zt(t)&&At.call(t,"callee")&&!Bt.call(t,"callee")},jt=Array.isArray,Rt=9007199254740991;function Ot(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Rt}function Ht(t){return null!=t&&Ot(t.length)&&!Z(t)}var Wt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Lt=Wt&&"object"==typeof module&&module&&!module.nodeType&&module,It=Lt&&Lt.exports===Wt?L.Buffer:void 0,Pt=(It?It.isBuffer:void 0)||function(){return!1},Dt={};function Xt(t){return function(e){return t(e)}}Dt["[object Float32Array]"]=Dt["[object Float64Array]"]=Dt["[object Int8Array]"]=Dt["[object Int16Array]"]=Dt["[object Int32Array]"]=Dt["[object Uint8Array]"]=Dt["[object Uint8ClampedArray]"]=Dt["[object Uint16Array]"]=Dt["[object Uint32Array]"]=!0,Dt["[object Arguments]"]=Dt["[object Array]"]=Dt["[object ArrayBuffer]"]=Dt["[object Boolean]"]=Dt["[object DataView]"]=Dt["[object Date]"]=Dt["[object Error]"]=Dt["[object Function]"]=Dt["[object Map]"]=Dt["[object Number]"]=Dt["[object Object]"]=Dt["[object RegExp]"]=Dt["[object Set]"]=Dt["[object String]"]=Dt["[object WeakMap]"]=!1;var Nt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Yt=Nt&&"object"==typeof module&&module&&!module.nodeType&&module,Gt=Yt&&Yt.exports===Nt&&H.process,Ft=function(){try{var t=Yt&&Yt.require&&Yt.require("util").types;return t||Gt&&Gt.binding&&Gt.binding("util")}catch(t){}}(),qt=Ft&&Ft.isTypedArray,Vt=qt?Xt(qt):function(t){return zt(t)&&Ot(t.length)&&!!Dt[V(t)]},Ut="[object Map]",$t="[object Set]",Kt=Object.prototype.hasOwnProperty;function Jt(t){if(null==t)return!0;if(Ht(t)&&(jt(t)||"string"==typeof t||"function"==typeof t.splice||Pt(t)||Vt(t)||_t(t)))return!t.length;var e=kt(t);if(e==Ut||e==$t)return!t.size;if(B(t))return!O(t).length;for(var i in t)if(Kt.call(t,i))return!1;return!0}var Qt="[object Symbol]";function Zt(t){return"symbol"==typeof t||zt(t)&&V(t)==Qt}var te=NaN,ee=/^\s+|\s+$/g,ie=/^[-+]0x[0-9a-f]+$/i,re=/^0b[01]+$/i,oe=/^0o[0-7]+$/i,ne=parseInt;function se(t){if("number"==typeof t)return t;if(Zt(t))return te;if(U(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=U(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ee,"");var i=re.test(t);return i||oe.test(t)?ne(t.slice(2),i?2:8):ie.test(t)?te:+t}function ae(t,e,i){return void 0===i&&(i=e,e=void 0),void 0!==i&&(i=(i=se(i))==i?i:0),void 0!==e&&(e=(e=se(e))==e?e:0),function(t,e,i){return t==t&&(void 0!==i&&(t=t<=i?t:i),void 0!==e&&(t=t>=e?t:e)),t}(se(t),e,i)}function he(t,e){return t===e||t!=t&&e!=e}function le(t,e){for(var i=t.length;i--;)if(he(t[i][0],e))return i;return-1}var ce=Array.prototype.splice;function de(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}de.prototype.clear=function(){this.__data__=[],this.size=0},de.prototype.delete=function(t){var e=this.__data__,i=le(e,t);return!(i<0||(i==e.length-1?e.pop():ce.call(e,i,1),--this.size,0))},de.prototype.get=function(t){var e=this.__data__,i=le(e,t);return i<0?void 0:e[i][1]},de.prototype.has=function(t){return le(this.__data__,t)>-1},de.prototype.set=function(t,e){var i=this.__data__,r=le(i,t);return r<0?(++this.size,i.push([t,e])):i[r][1]=e,this};var fe=ft(Object,"create");var ue="__lodash_hash_undefined__",pe=Object.prototype.hasOwnProperty;var ge=Object.prototype.hasOwnProperty;var ve="__lodash_hash_undefined__";function ye(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}function we(t,e){var i,r,o=t.__data__;return("string"==(r=typeof(i=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i)?o["string"==typeof e?"string":"hash"]:o.map}function be(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}ye.prototype.clear=function(){this.__data__=fe?fe(null):{},this.size=0},ye.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ye.prototype.get=function(t){var e=this.__data__;if(fe){var i=e[t];return i===ue?void 0:i}return pe.call(e,t)?e[t]:void 0},ye.prototype.has=function(t){var e=this.__data__;return fe?void 0!==e[t]:ge.call(e,t)},ye.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=fe&&void 0===e?ve:e,this},be.prototype.clear=function(){this.size=0,this.__data__={hash:new ye,map:new(pt||de),string:new ye}},be.prototype.delete=function(t){var e=we(this,t).delete(t);return this.size-=e?1:0,e},be.prototype.get=function(t){return we(this,t).get(t)},be.prototype.has=function(t){return we(this,t).has(t)},be.prototype.set=function(t,e){var i=we(this,t),r=i.size;return i.set(t,e),this.size+=i.size==r?0:1,this};var me=200;function xe(t){var e=this.__data__=new de(t);this.size=e.size}xe.prototype.clear=function(){this.__data__=new de,this.size=0},xe.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},xe.prototype.get=function(t){return this.__data__.get(t)},xe.prototype.has=function(t){return this.__data__.has(t)},xe.prototype.set=function(t,e){var i=this.__data__;if(i instanceof de){var r=i.__data__;if(!pt||r.length<me-1)return r.push([t,e]),this.size=++i.size,this;i=this.__data__=new be(r)}return i.set(t,e),this.size=i.size,this};var Se=function(){try{var t=ft(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function Ce(t,e,i){"__proto__"==e&&Se?Se(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function ke(t,e,i){(void 0===i||he(t[e],i))&&(void 0!==i||e in t)||Ce(t,e,i)}var ze,Me=function(t,e,i){for(var r=-1,o=Object(t),n=i(t),s=n.length;s--;){var a=n[ze?s:++r];if(!1===e(o[a],a,o))break}return t},Ee="object"==typeof exports&&exports&&!exports.nodeType&&exports,Te=Ee&&"object"==typeof module&&module&&!module.nodeType&&module,Ae=Te&&Te.exports===Ee?L.Buffer:void 0,Be=Ae?Ae.allocUnsafe:void 0;function _e(t,e){if(e)return t.slice();var i=t.length,r=Be?Be(i):new t.constructor(i);return t.copy(r),r}var je=L.Uint8Array;function Re(t){var e=new t.constructor(t.byteLength);return new je(e).set(new je(t)),e}function Oe(t,e){var i=e?Re(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function He(t,e){var i=-1,r=t.length;for(e||(e=Array(r));++i<r;)e[i]=t[i];return e}var We=Object.create,Le=function(){function t(){}return function(e){if(!U(e))return{};if(We)return We(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}(),Ie=_(Object.getPrototypeOf,Object);function Pe(t){return"function"!=typeof t.constructor||B(t)?{}:Le(Ie(t))}var De="[object Object]",Xe=Function.prototype,Ne=Object.prototype,Ye=Xe.toString,Ge=Ne.hasOwnProperty,Fe=Ye.call(Object);function qe(t,e){if("__proto__"!=e)return t[e]}var Ve=Object.prototype.hasOwnProperty;function Ue(t,e,i){var r=t[e];Ve.call(t,e)&&he(r,i)&&(void 0!==i||e in t)||Ce(t,e,i)}function $e(t,e,i,r){var o=!i;i||(i={});for(var n=-1,s=e.length;++n<s;){var a=e[n],h=r?r(i[a],t[a],a,i,t):void 0;void 0===h&&(h=t[a]),o?Ce(i,a,h):Ue(i,a,h)}return i}var Ke=9007199254740991,Je=/^(?:0|[1-9]\d*)$/;function Qe(t,e){var i=typeof t;return!!(e=null==e?Ke:e)&&("number"==i||"symbol"!=i&&Je.test(t))&&t>-1&&t%1==0&&t<e}var Ze=Object.prototype.hasOwnProperty;function ti(t,e){var i=jt(t),r=!i&&_t(t),o=!i&&!r&&Pt(t),n=!i&&!r&&!o&&Vt(t),s=i||r||o||n,a=s?function(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r}(t.length,String):[],h=a.length;for(var l in t)!e&&!Ze.call(t,l)||s&&("length"==l||o&&("offset"==l||"parent"==l)||n&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Qe(l,h))||a.push(l);return a}var ei=Object.prototype.hasOwnProperty;function ii(t){if(!U(t))return function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}(t);var e=B(t),i=[];for(var r in t)("constructor"!=r||!e&&ei.call(t,r))&&i.push(r);return i}function ri(t){return Ht(t)?ti(t,!0):ii(t)}function oi(t,e,i,r,o,n,s){var a=qe(t,i),h=qe(e,i),l=s.get(h);if(l)ke(t,i,l);else{var c,d=n?n(a,h,i+"",t,e,s):void 0,f=void 0===d;if(f){var u=jt(h),p=!u&&Pt(h),g=!u&&!p&&Vt(h);d=h,u||p||g?jt(a)?d=a:zt(c=a)&&Ht(c)?d=He(a):p?(f=!1,d=_e(h,!0)):g?(f=!1,d=Oe(h,!0)):d=[]:function(t){if(!zt(t)||V(t)!=De)return!1;var e=Ie(t);if(null===e)return!0;var i=Ge.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&Ye.call(i)==Fe}(h)||_t(h)?(d=a,_t(a)?d=function(t){return $e(t,ri(t))}(a):U(a)&&!Z(a)||(d=Pe(h))):f=!1}f&&(s.set(h,d),o(d,h,r,n,s),s.delete(h)),ke(t,i,d)}}function ni(t,e,i,r,o){t!==e&&Me(e,function(n,s){if(U(n))o||(o=new xe),oi(t,e,s,i,ni,r,o);else{var a=r?r(qe(t,s),n,s+"",t,e,o):void 0;void 0===a&&(a=n),ke(t,s,a)}},ri)}function si(t){return t}var ai=Math.max;var hi=Se?function(t,e){return Se(t,"toString",{configurable:!0,enumerable:!1,value:(i=e,function(){return i}),writable:!0});var i}:si,li=800,ci=16,di=Date.now;var fi,ui,pi,gi=(fi=hi,ui=0,pi=0,function(){var t=di(),e=ci-(t-pi);if(pi=t,e>0){if(++ui>=li)return arguments[0]}else ui=0;return fi.apply(void 0,arguments)});function vi(t,e){return gi(function(t,e,i){return e=ai(void 0===e?t.length-1:e,0),function(){for(var r=arguments,o=-1,n=ai(r.length-e,0),s=Array(n);++o<n;)s[o]=r[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=r[o];return a[e]=i(s),function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}(t,this,a)}}(t,e,si),t+"")}yi=function(t,e,i){ni(t,e,i)},vi(function(t,e){var i=-1,r=e.length,o=r>1?e[r-1]:void 0,n=r>2?e[2]:void 0;for(o=yi.length>3&&"function"==typeof o?(r--,o):void 0,n&&function(t,e,i){if(!U(i))return!1;var r=typeof e;return!!("number"==r?Ht(i)&&Qe(e,i.length):"string"==r&&e in i)&&he(i[e],t)}(e[0],e[1],n)&&(o=r<3?void 0:o,r=1),t=Object(t);++i<r;){var s=e[i];s&&yi(t,s,i,o)}return t});var yi,wi="__lodash_hash_undefined__";function bi(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new be;++e<i;)this.add(t[e])}function mi(t,e){for(var i=-1,r=null==t?0:t.length;++i<r;)if(e(t[i],i,t))return!0;return!1}bi.prototype.add=bi.prototype.push=function(t){return this.__data__.set(t,wi),this},bi.prototype.has=function(t){return this.__data__.has(t)};var xi=1,Si=2;function Ci(t,e,i,r,o,n){var s=i&xi,a=t.length,h=e.length;if(a!=h&&!(s&&h>a))return!1;var l=n.get(t);if(l&&n.get(e))return l==e;var c=-1,d=!0,f=i&Si?new bi:void 0;for(n.set(t,e),n.set(e,t);++c<a;){var u=t[c],p=e[c];if(r)var g=s?r(p,u,c,e,t,n):r(u,p,c,t,e,n);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!mi(e,function(t,e){if(s=e,!f.has(s)&&(u===t||o(u,t,i,r,n)))return f.push(e);var s})){d=!1;break}}else if(u!==p&&!o(u,p,i,r,n)){d=!1;break}}return n.delete(t),n.delete(e),d}function ki(t){var e=-1,i=Array(t.size);return t.forEach(function(t,r){i[++e]=[r,t]}),i}function zi(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i}var Mi=1,Ei=2,Ti="[object Boolean]",Ai="[object Date]",Bi="[object Error]",_i="[object Map]",ji="[object Number]",Ri="[object RegExp]",Oi="[object Set]",Hi="[object String]",Wi="[object Symbol]",Li="[object ArrayBuffer]",Ii="[object DataView]",Pi=I?I.prototype:void 0,Di=Pi?Pi.valueOf:void 0;function Xi(t,e){for(var i=-1,r=e.length,o=t.length;++i<r;)t[o+i]=e[i];return t}function Ni(t,e,i){var r=e(t);return jt(t)?r:Xi(r,i(t))}function Yi(){return[]}var Gi=Object.prototype.propertyIsEnumerable,Fi=Object.getOwnPropertySymbols,qi=Fi?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var i=-1,r=null==t?0:t.length,o=0,n=[];++i<r;){var s=t[i];e(s,i,t)&&(n[o++]=s)}return n}(Fi(t),function(e){return Gi.call(t,e)}))}:Yi;function Vi(t){return Ht(t)?ti(t):O(t)}function Ui(t){return Ni(t,Vi,qi)}var $i=1,Ki=Object.prototype.hasOwnProperty;var Ji=1,Qi="[object Arguments]",Zi="[object Array]",tr="[object Object]",er=Object.prototype.hasOwnProperty;function ir(t,e,i,r,o,n){var s=jt(t),a=jt(e),h=s?Zi:kt(t),l=a?Zi:kt(e),c=(h=h==Qi?tr:h)==tr,d=(l=l==Qi?tr:l)==tr,f=h==l;if(f&&Pt(t)){if(!Pt(e))return!1;s=!0,c=!1}if(f&&!c)return n||(n=new xe),s||Vt(t)?Ci(t,e,i,r,o,n):function(t,e,i,r,o,n,s){switch(i){case Ii:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Li:return!(t.byteLength!=e.byteLength||!n(new je(t),new je(e)));case Ti:case Ai:case ji:return he(+t,+e);case Bi:return t.name==e.name&&t.message==e.message;case Ri:case Hi:return t==e+"";case _i:var a=ki;case Oi:var h=r&Mi;if(a||(a=zi),t.size!=e.size&&!h)return!1;var l=s.get(t);if(l)return l==e;r|=Ei,s.set(t,e);var c=Ci(a(t),a(e),r,o,n,s);return s.delete(t),c;case Wi:if(Di)return Di.call(t)==Di.call(e)}return!1}(t,e,h,i,r,o,n);if(!(i&Ji)){var u=c&&er.call(t,"__wrapped__"),p=d&&er.call(e,"__wrapped__");if(u||p){var g=u?t.value():t,v=p?e.value():e;return n||(n=new xe),o(g,v,i,r,n)}}return!!f&&(n||(n=new xe),function(t,e,i,r,o,n){var s=i&$i,a=Ui(t),h=a.length;if(h!=Ui(e).length&&!s)return!1;for(var l=h;l--;){var c=a[l];if(!(s?c in e:Ki.call(e,c)))return!1}var d=n.get(t);if(d&&n.get(e))return d==e;var f=!0;n.set(t,e),n.set(e,t);for(var u=s;++l<h;){var p=t[c=a[l]],g=e[c];if(r)var v=s?r(g,p,c,e,t,n):r(p,g,c,t,e,n);if(!(void 0===v?p===g||o(p,g,i,r,n):v)){f=!1;break}u||(u="constructor"==c)}if(f&&!u){var y=t.constructor,w=e.constructor;y!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof w&&w instanceof w)&&(f=!1)}return n.delete(t),n.delete(e),f}(t,e,i,r,o,n))}function rr(t,e,i,r,o){return t===e||(null==t||null==e||!zt(t)&&!zt(e)?t!=t&&e!=e:ir(t,e,i,r,rr,o))}var or=1,nr=2;function sr(t){return t==t&&!U(t)}function ar(t,e){return function(i){return null!=i&&(i[t]===e&&(void 0!==e||t in Object(i)))}}function hr(t){var e=function(t){for(var e=Vi(t),i=e.length;i--;){var r=e[i],o=t[r];e[i]=[r,o,sr(o)]}return e}(t);return 1==e.length&&e[0][2]?ar(e[0][0],e[0][1]):function(i){return i===t||function(t,e,i,r){var o=i.length,n=o,s=!r;if(null==t)return!n;for(t=Object(t);o--;){var a=i[o];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<n;){var h=(a=i[o])[0],l=t[h],c=a[1];if(s&&a[2]){if(void 0===l&&!(h in t))return!1}else{var d=new xe;if(r)var f=r(l,c,h,t,e,d);if(!(void 0===f?rr(c,l,or|nr,r,d):f))return!1}}return!0}(i,t,e)}}var lr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cr=/^\w*$/;function dr(t,e){if(jt(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!Zt(t))||(cr.test(t)||!lr.test(t)||null!=e&&t in Object(e))}var fr="Expected a function";function ur(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(fr);var i=function(){var r=arguments,o=e?e.apply(this,r):r[0],n=i.cache;if(n.has(o))return n.get(o);var s=t.apply(this,r);return i.cache=n.set(o,s)||n,s};return i.cache=new(ur.Cache||be),i}ur.Cache=be;var pr=500;var gr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vr=/\\(\\)?/g,yr=function(t){var e=ur(t,function(t){return i.size===pr&&i.clear(),t}),i=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(gr,function(t,i,r,o){e.push(r?o.replace(vr,"$1"):i||t)}),e});var wr=1/0,br=I?I.prototype:void 0,mr=br?br.toString:void 0;function xr(t){if("string"==typeof t)return t;if(jt(t))return function(t,e){for(var i=-1,r=null==t?0:t.length,o=Array(r);++i<r;)o[i]=e(t[i],i,t);return o}(t,xr)+"";if(Zt(t))return mr?mr.call(t):"";var e=t+"";return"0"==e&&1/t==-wr?"-0":e}function Sr(t,e){return jt(t)?t:dr(t,e)?[t]:yr(function(t){return null==t?"":xr(t)}(t))}var Cr=1/0;function kr(t){if("string"==typeof t||Zt(t))return t;var e=t+"";return"0"==e&&1/t==-Cr?"-0":e}function zr(t,e){for(var i=0,r=(e=Sr(e,t)).length;null!=t&&i<r;)t=t[kr(e[i++])];return i&&i==r?t:void 0}function Mr(t,e){return null!=t&&e in Object(t)}function Er(t,e){return null!=t&&function(t,e,i){for(var r=-1,o=(e=Sr(e,t)).length,n=!1;++r<o;){var s=kr(e[r]);if(!(n=null!=t&&i(t,s)))break;t=t[s]}return n||++r!=o?n:!!(o=null==t?0:t.length)&&Ot(o)&&Qe(s,o)&&(jt(t)||_t(t))}(t,e,Mr)}var Tr=1,Ar=2;function Br(t,e){return dr(t)&&sr(e)?ar(kr(t),e):function(i){var r=function(t,e,i){var r=null==t?void 0:zr(t,e);return void 0===r?i:r}(i,t);return void 0===r&&r===e?Er(i,t):rr(e,r,Tr|Ar)}}function _r(t){return dr(t)?(e=kr(t),function(t){return null==t?void 0:t[e]}):function(t){return function(e){return zr(e,t)}}(t);var e}function jr(t){return"function"==typeof t?t:null==t?si:"object"==typeof t?jt(t)?Br(t[0],t[1]):hr(t):_r(t)}var Rr=1/0,Or=1.7976931348623157e308;function Hr(t){return t?(t=se(t))===Rr||t===-Rr?(t<0?-1:1)*Or:t==t?t:0:0===t?t:0}var Wr=Math.max;var Lr,Ir=(Lr=function(t,e,i){var r=null==t?0:t.length;if(!r)return-1;var o,n,s=null==i?0:(o=Hr(i),n=o%1,o==o?n?o-n:o:0);return s<0&&(s=Wr(r+s,0)),function(t,e,i,r){for(var o=t.length,n=i+(r?1:-1);r?n--:++n<o;)if(e(t[n],n,t))return n;return-1}(t,jr(e),s)},function(t,e,i){var r=Object(t);if(!Ht(t)){var o=jr(e);t=Vi(t),e=function(t){return o(r[t],t,r)}}var n=Lr(t,e,i);return n>-1?r[o?t[n]:n]:void 0});function Pr(t,e){return rr(t,e)}function Dr(t,e){return e.length<2?t:zr(t,function(t,e,i){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(i=i>o?o:i)<0&&(i+=o),o=e>i?0:i-e>>>0,e>>>=0;for(var n=Array(o);++r<o;)n[r]=t[r+e];return n}(e,0,-1))}function Xr(t,e){return null==(t=Dr(t,e=Sr(e,t)))||delete t[kr((i=e,r=null==i?0:i.length,r?i[r-1]:void 0))];var i,r}var Nr=Array.prototype.splice;function Yr(t,e){var i=[];if(!t||!t.length)return i;var r=-1,o=[],n=t.length;for(e=jr(e);++r<n;){var s=t[r];e(s,r,t)&&(i.push(s),o.push(r))}return function(t,e){for(var i=t?e.length:0,r=i-1;i--;){var o=e[i];if(i==r||o!==n){var n=o;Qe(o)?Nr.call(t,o,1):Xr(t,o)}}}(t,o),i}var Gr=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Xi(e,qi(t)),t=Ie(t);return e}:Yi;function Fr(t){return Ni(t,ri,Gr)}var qr=Object.prototype.hasOwnProperty;var Vr=/\w*$/;var Ur=I?I.prototype:void 0,$r=Ur?Ur.valueOf:void 0;var Kr="[object Boolean]",Jr="[object Date]",Qr="[object Map]",Zr="[object Number]",to="[object RegExp]",eo="[object Set]",io="[object String]",ro="[object Symbol]",oo="[object ArrayBuffer]",no="[object DataView]",so="[object Float32Array]",ao="[object Float64Array]",ho="[object Int8Array]",lo="[object Int16Array]",co="[object Int32Array]",fo="[object Uint8Array]",uo="[object Uint8ClampedArray]",po="[object Uint16Array]",go="[object Uint32Array]";function vo(t,e,i){var r,o,n,s=t.constructor;switch(e){case oo:return Re(t);case Kr:case Jr:return new s(+t);case no:return function(t,e){var i=e?Re(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case so:case ao:case ho:case lo:case co:case fo:case uo:case po:case go:return Oe(t,i);case Qr:return new s;case Zr:case io:return new s(t);case to:return(n=new(o=t).constructor(o.source,Vr.exec(o))).lastIndex=o.lastIndex,n;case eo:return new s;case ro:return r=t,$r?Object($r.call(r)):{}}}var yo="[object Map]";var wo=Ft&&Ft.isMap,bo=wo?Xt(wo):function(t){return zt(t)&&kt(t)==yo},mo="[object Set]";var xo=Ft&&Ft.isSet,So=xo?Xt(xo):function(t){return zt(t)&&kt(t)==mo},Co=1,ko=2,zo=4,Mo="[object Arguments]",Eo="[object Function]",To="[object GeneratorFunction]",Ao="[object Object]",Bo={};function _o(t,e,i,r,o,n){var s,a=e&Co,h=e&ko,l=e&zo;if(i&&(s=o?i(t,r,o,n):i(t)),void 0!==s)return s;if(!U(t))return t;var c=jt(t);if(c){if(s=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&qr.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!a)return He(t,s)}else{var d=kt(t),f=d==Eo||d==To;if(Pt(t))return _e(t,a);if(d==Ao||d==Mo||f&&!o){if(s=h||f?{}:Pe(t),!a)return h?function(t,e){return $e(t,Gr(t),e)}(t,function(t,e){return t&&$e(e,ri(e),t)}(s,t)):function(t,e){return $e(t,qi(t),e)}(t,function(t,e){return t&&$e(e,Vi(e),t)}(s,t))}else{if(!Bo[d])return o?t:{};s=vo(t,d,a)}}n||(n=new xe);var u=n.get(t);if(u)return u;if(n.set(t,s),So(t))return t.forEach(function(r){s.add(_o(r,e,i,r,t,n))}),s;if(bo(t))return t.forEach(function(r,o){s.set(o,_o(r,e,i,o,t,n))}),s;var p=l?h?Fr:Ui:h?keysIn:Vi,g=c?void 0:p(t);return function(t,e){for(var i=-1,r=null==t?0:t.length;++i<r&&!1!==e(t[i],i,t););}(g||t,function(r,o){g&&(r=t[o=r]),Ue(s,o,_o(r,e,i,o,t,n))}),s}Bo[Mo]=Bo["[object Array]"]=Bo["[object ArrayBuffer]"]=Bo["[object DataView]"]=Bo["[object Boolean]"]=Bo["[object Date]"]=Bo["[object Float32Array]"]=Bo["[object Float64Array]"]=Bo["[object Int8Array]"]=Bo["[object Int16Array]"]=Bo["[object Int32Array]"]=Bo["[object Map]"]=Bo["[object Number]"]=Bo[Ao]=Bo["[object RegExp]"]=Bo["[object Set]"]=Bo["[object String]"]=Bo["[object Symbol]"]=Bo["[object Uint8Array]"]=Bo["[object Uint8ClampedArray]"]=Bo["[object Uint16Array]"]=Bo["[object Uint32Array]"]=!0,Bo["[object Error]"]=Bo[Eo]=Bo["[object WeakMap]"]=!1;var jo=1,Ro=4;for(var Oo=function(t,e){return t(e={exports:{}},e.exports),e.exports}(function(t){var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var i=new Uint8Array(16);t.exports=function(){return e(i),i}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}}),Ho=[],Wo=0;Wo<256;++Wo)Ho[Wo]=(Wo+256).toString(16).substr(1);var Lo=function(t,e){var i=e||0,r=Ho;return[r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]]].join("")};var Io=function(t,e,i){var r=e&&i||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||Oo)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var n=0;n<16;++n)e[r+n]=o[n];return e||Lo(o)},Po=function(){return L.Date.now()},Do="Expected a function",Xo=Math.max,No=Math.min;function Yo(t,e,i){var r,o,n,s,a,h,l=0,c=!1,d=!1,f=!0;if("function"!=typeof t)throw new TypeError(Do);function u(e){var i=r,n=o;return r=o=void 0,l=e,s=t.apply(n,i)}function p(t){var i=t-h;return void 0===h||i>=e||i<0||d&&t-l>=n}function g(){var t=Po();if(p(t))return v(t);a=setTimeout(g,function(t){var i=e-(t-h);return d?No(i,n-(t-l)):i}(t))}function v(t){return a=void 0,f&&r?u(t):(r=o=void 0,s)}function y(){var t=Po(),i=p(t);if(r=arguments,o=this,h=t,i){if(void 0===a)return function(t){return l=t,a=setTimeout(g,e),c?u(t):s}(h);if(d)return a=setTimeout(g,e),u(h)}return void 0===a&&(a=setTimeout(g,e)),s}return e=se(e)||0,U(i)&&(c=!!i.leading,n=(d="maxWait"in i)?Xo(se(i.maxWait)||0,e):n,f="trailing"in i?!!i.trailing:f),y.cancel=function(){void 0!==a&&clearTimeout(a),l=0,r=h=o=a=void 0},y.flush=function(){return void 0===a?s:v(Po())},y}var Go=Math.max,Fo=Math.min;function qo(t,e,i){return e=Hr(e),void 0===i?(i=e,e=0):i=Hr(i),function(t,e,i){return t>=Fo(e,i)&&t<Go(e,i)}(t=se(t),e,i)}var Vo="[object Number]";function Uo(t){return"number"==typeof t||zt(t)&&V(t)==Vo}function $o(t){return null==t}function Ko(t,e){return!(e[0][1]>t[1][1]||e[1][1]<t[0][1]||e[0][0]>t[1][0]||e[1][0]<t[0][0])}var Jo=function(){};function Qo(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Array.from(new Array(e-t),function(e,i){return i+t})}function Zo(t,e){var i=[],r=e.map(function(i,r){return t.substring(0===r?0:e[r-1],i)});return r.push(t.substring(e[e.length-1])),r.forEach(function(t){t.split("/n").forEach(function(t){i.push(t)})}),i}function tn(t,e,i){return t>=e&&t<=i||t>=i&&t<=e}function en(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y<=e.y+e.height&&t.y>=e.y}function rn(t,e,i,r,o,n){return(o-t)*(r-e)==(i-t)*(n-e)&&Math.min(t,i)<=o&&o<=Math.max(t,i)&&Math.min(e,r)<=n&&n<=Math.max(e,r)}function on(t,e,i){t.addEventListener(e,i)}function nn(t,e,i){t.removeEventListener(e,i)}function sn(t){t.xclickoutside&&(nn(window.document.body,"mousedown",t.xclickoutside),delete t.xclickoutside)}function an(t,e,i){void 0===e&&(e=function(t){t.hide()}),void 0===i&&(i=!0),t.xclickoutside=function(r){2===r.detail||t.contains(r.target)||(e(t),i&&sn(t))},on(window.document.body,"mousedown",t.xclickoutside)}var hn,ln={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},cn=(hn=Object.freeze({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",default:ln}))&&hn.default||hn;const dn=function(t){return(e={exact:!0},(e=e||{}).exact?/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/:/rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)/gi).test(t);var e},fn=function(t){return(e={exact:!0},(e=e||{}).exact?/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)$/:/rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)/gi).test(t);var e},un=function(t){return(e={exact:!0},(e=e||{}).exact?/^hsl\(\s*(\d+)\s*,\s*(\d*(?:\.\d+)?%)\s*,\s*(\d*(?:\.\d+)?%)\)$/:/hsl\(\s*(\d+)\s*,\s*(\d*(?:\.\d+)?%)\s*,\s*(\d*(?:\.\d+)?%)\)/gi).test(t);var e},pn=function(t){return(e={exact:!0},(e=e||{}).exact?/^hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)$/:/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)/gi).test(t);var e},gn=function(t){return(e={exact:!0},(e=e&&"object"==typeof e?e:{}).strict?/^#([a-f0-9]{3,4}|[a-f0-9]{4}(?:[a-f0-9]{2}){1,2})\b$/i:/#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})\b/gi).test(t);var e},vn=function(t){return cn.hasOwnProperty(t)},yn=function(t){return"inherit"===t},wn=function(t){return"currentColor"===t||"currentcolor"===t},bn=function(t){return"transparent"===t};var mn=function(t){return dn(t)||fn(t)||un(t)||pn(t)||gn(t)||vn(t)||yn(t)||wn(t)||bn(t)},xn=dn,Sn=fn,Cn=un,kn=pn,zn=gn,Mn=vn,En=yn,Tn=wn,An=bn;mn.isRgb=xn,mn.isRgba=Sn,mn.isHsl=Cn,mn.isHsla=kn,mn.isHex=zn,mn.isKeyword=Mn,mn.isInherit=En,mn.isCurrentColor=Tn,mn.isTransparent=An;var Bn=function(t){return/^(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset)$/i.test(t)};function _n(t){var e={style:"none",color:"#000000",width:0};return t.split(" ").forEach(function(t){var i;mn(t)&&(e.color=t),(/^(\+|-)?([0-9]*\.)?[0-9]+(em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)$/i.test(i=t)||/^(\+|-)?(0*\.)?0+$/.test(i))&&(e.width=parseFloat(t)),Bn(t)&&(e.style=t)}),e}var jn=new Map,Rn=new Map;function On(t){var e=jn.get(t);if(e)return new Promise(function(t){t(e)});var i=Rn.get(t)||new Promise(function(e,i){var r=new Image;r.src=t,r.onload=function(){jn.set(t,r),e(r)},r.onerror=function(t){i(t)}});return Rn.set(t,i),i}function Hn(t){return jn.get(t)}var Wn=function(){function t(t){var e=this;this.mouseDownHandler=function(t,i,r,o){e.props.listeners&&e.props.listeners.forEach(function(n){var s;"CELL_MOUSE_DOWN"===n.eventName&&(null===(s=n.action)||void 0===s||s.call(e,t,i,r,o))})},this.mouseLeaveHandler=function(t,i,r,o){e.props.listeners&&e.props.listeners.forEach(function(n){var s;"CELL_MOUSE_LEAVE"===n.eventName&&(null===(s=n.action)||void 0===s||s.call(e,t,i,r,o))})},this.clickHandler=function(t,i,r,o){var n=!1;return e.props.listeners&&e.props.listeners.forEach(function(s){var a;"CELL_CLICK"===s.eventName&&(n=null===(a=s.action)||void 0===a?void 0:a.call(e,t,i,r,o))}),n},this.hoverHandler=function(t,i,r,o){e.props.listeners&&e.props.listeners.forEach(function(n){var s;"CELL_HOVER"===n.eventName&&(null===(s=n.action)||void 0===s||s.call(e,t,i,r,o))})},this.dbClickHandler=function(t,i,r,o){e.props.listeners&&e.props.listeners.forEach(function(n){var s;"CELL_DOUBLE_CLICK"===n.eventName&&(null===(s=n.action)||void 0===s||s.call(e,t,i,r,o))})},this.props=t;var i=t.x,r=void 0===i?0:i,o=t.y,n=void 0===o?0:o,s=t.width,a=t.height,h=t.top,l=t.left;this.width=s,this.height=a,this.top=h||n,this.left=l||r,this.style=function(t){var e=t.x,i=void 0===e?0:e,r=t.y,o=void 0===r?0:r,n=t.top,s=t.left,a=t.width,h=t.height,l=t.style,c=void 0===l?{}:l,d=t.autoWrapInfo,f=c.backgroundSize,u=c.backgroundImage,p=c.backgroundColor,g=void 0===p?"":p,v=c.color,y=void 0===v?"":v,w=c.textAlign,b=c.fontWeight,m=void 0===b?"normal":b,x=c.fontFamily,C=void 0===x?"SimSun":x,k=c.fontSize,z=void 0===k?"9pt":k,M=c.fontStyle,E=void 0===M?"normal":M,T=c.verticalAlign,A=c.border,B=void 0===A?"":A,_=c.borderTop,j=void 0===_?"":_,R=c.borderBottom,O=void 0===R?"":R,H=c.borderLeft,W=void 0===H?"":H,L=c.borderRight,I=void 0===L?"":L,P=c.rotate,D=c.textShadow,X=c.underline,N=c.strikeThrough,Y=c.lineHeight,G=c.subscript,F=c.supscript,q=c.newLine,V=c.verticalText,U=c.verTextDirection,$=c.cellJust,K={};if(K.top=n||o,K.left=s||i,K.width=a,K.height=h,K.color=new S(y),K.textAlign=w,K.verticalAlign=T,K.fontWeight=m,K.fontSize=z,K.fontFamily=C,K.fontStyle=E,K.textShadow=D,K.underline=X,K.strikeThrough=N,K.lineHeight=Y,K.subscript=G,K.supscript=F,K.backgroundColor=new S(g),K.backgroundImage=u,K.backgroundSize=f,B){var J=_n(B),Q=J.width,Z=J.style,tt=J.color;K.borderLeftWidth=K.borderTopWidth=K.borderBottomWidth=K.borderRightWidth=Q,K.borderLeftStyle=K.borderTopStyle=K.borderBottomStyle=K.borderRightStyle=Z,K.borderLeftColor=K.borderTopColor=K.borderBottomColor=K.borderRightColor=new S(tt)}if(j){var et=_n(j),it=et.width,rt=et.color,ot=et.style;K.borderTopWidth=it,K.borderTopStyle=ot,K.borderTopColor=new S(rt)}if(O){var nt=_n(O),st=nt.width,at=nt.color,ht=nt.style;K.borderBottomWidth=st,K.borderBottomStyle=ht,K.borderBottomColor=new S(at)}if(W){var lt=_n(W),ct=lt.width,dt=lt.color,ft=lt.style;K.borderLeftWidth=ct,K.borderLeftStyle=ft,K.borderLeftColor=new S(dt)}if(I){var ut=_n(I),pt=ut.width,gt=ut.color,vt=ut.style;K.borderRightWidth=pt,K.borderRightStyle=vt,K.borderRightColor=new S(gt)}return K.rotate=P,K.newLine=q,K.verticalText=V,K.verTextDirection=U,K.cellJust=$,K.autoWrapInfo=d&&JSON.parse(""+d),K}(t)}return t.prototype.getBounds=function(){return{left:this.left,top:this.top,right:this.left+this.width,bottom:this.top+this.height,width:this.width,height:this.height}},t.prototype.getChildren=function(){},t.prototype.getStyle=function(){return this.style},t.prototype.getText=function(){},t.prototype.getRealWidth=function(){return this.width},t=o([l("bi.widget")],t)}(),Ln=(function(t){function i(e){var i=t.call(this,e)||this,r=e.text;return i.text=r,i}e(i,t),i.prototype.getText=function(){return this.text},i.prototype.getRealWidth=function(){return(t=this.getText()||"",e=this.style,i=document.createElement("canvas").getContext("2d",{alpha:!1}),z(i,e),i.measureText(t)).width;var t,e,i},i=o([l("bi.label")],i)}(Wn),function(t){function i(e){return t.call(this,e)||this}e(i,t),i.prototype.getChildren=function(){return[c({type:"bi.widget",width:5,height:8,left:this.left,top:this.top,style:{rotate:"45",borderBottom:"2px solid #000",borderRight:"2px solid #000"}})]},i=o([l("bi.checkbox")],i)}(Wn),function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.getChildren=function(){return this.children},i.prototype.getRealWidth=function(){return this.getChildren().reduce(function(t,e){return e.getRealWidth()+t},0)},i}(Wn)),In=(function(t){function i(e){var i=t.call(this,e)||this;return i.clickHandler=function(t,e,r,o){for(var n=0;n<i.children.length;n++){var s=i.children[n].getBounds();if(s.left<=e&&s.right>e)return i.children[n].clickHandler.call(null,t,e,r,o)}return!0},i.items=e.items||[],i.children=[],i.digest(),i}e(i,t),i.prototype.digest=function(){var t=this.getBounds(),e=0,i=t.width-this.items.reduce(function(t,e){return t+(parseFloat(e.width)||0)},0);this.children=this.items.map(function(r){var o=r.el;return o.top=t.top,o.left=t.left+e,r.width?o.width=r.width:o.width=i,o.height=t.height,e+=o.width,c(o)})},i=o([l("bi.htape")],i)}(Ln),function(t){function i(e){var i=t.call(this,e)||this;return i.clickHandler=function(t,e,r,o,n){for(var s=!1,a=0;a<i.children.length;a++){var h=i.children[a].getBounds(),l=(n||{x:e}).x;if(h.left<=l&&h.right>l)return i.children[a].clickHandler.call(null,t,e,r,o)}return i.props.listeners&&i.props.listeners.forEach(function(n){"CELL_CLICK"===n.eventName&&(s=n.action.call(i,t,e,r,o))}),s},i.items=e.items||[],i.children=[],i.digest(),i}return e(i,t),i.prototype.digest=function(){var t=this.getBounds();this.children=this.items.map(function(e){var i=e.el;return i.top=t.top+(e.top||0),i.left=t.left+(e.left||0),i.right=t.right-(e.right||0),i.bottom=t.bottom-(e.bottom||0),"bi.label"===i.type?(i.width=i.right-i.left,i.height=i.bottom-i.top):(i.width=t.width,i.height=t.height),c(i)})},i=o([l("bi.absolute")],i)}(Ln)),Pn=(function(t){function n(e){var o=t.call(this,e)||this,n=e.icon||{},s=n.width,a=n.height,h=n.size,l=void 0===h?16:h,c=n.backgroundColor,d=n.top,f=n.left,u=r(n,["width","height","size","backgroundColor","top","left"]);return o.iconStyle=i({width:s||l,height:a||l,size:l,backgroundColor:c||"",top:d,left:f},u),o}e(n,t),n.prototype.getChildren=function(){if(this.children)return this.children;var t=this.iconStyle,e=t.width,o=t.height,n=t.text,s=t.size,a=t.backgroundColor,h=t.top,l=void 0===h?0:h,d=t.left,f=void 0===d?0:d,u=r(t,["width","height","text","size","backgroundColor","top","left"]),p=this.getBounds(),g=p.left,v=p.right,y=p.height,w=p.top,b=p.bottom;return this.children=[c({type:"bi.absolute",left:g,top:w+(y-o)/2,bottom:b-(y-o)/2,right:v,style:{backgroundColor:a},width:e,height:o,items:[{el:{type:"bi.label",style:i(i({},u),{lineHeight:o-1,fontSize:s+"px",verticalAlign:"middle"}),width:e,height:o,text:n},left:f,top:l,bottom:-l,right:-f,width:e,height:o}]})],this.children},n.prototype.getRealWidth=function(){return this.getChildren().reduce(function(t,e){return e.getRealWidth()+t},0)},n=o([l("bi.icon")],n)}(Wn),function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.adjustAndGenerate=function(t){var e=this,i=t,r=this.getBounds();this.children=this.items.map(function(t,o){var n=t.el;n.top=r.top+(t.top||0),n.left=i+(t.left||0);var s=e.children[o].getRealWidth();return n.width=0===o?s:Math.min(r.width-(i-r.left)-(t.left||0),s),n.height=e.children[o].height,i+=n.width+(t.left||0),c(n)})},i}(In)),Dn=(function(t){function i(){return null!==t&&t.apply(this,arguments)||this}e(i,t),i.prototype.digest=function(){t.prototype.digest.call(this);var e=this.getBounds().left;this.adjustAndGenerate(e)},i=o([l("bi.flow_left")],i)}(Pn),function(t){function i(){return null!==t&&t.apply(this,arguments)||this}e(i,t),i.prototype.digest=function(){var e=this;t.prototype.digest.call(this);var i=this.getBounds(),r=this.children.reduce(function(t,i,r){return i.getRealWidth()+e.items[r].left+t},0),o=Math.max((i.width-r)/2,0)+i.left;this.adjustAndGenerate(o)},i=o([l("bi.flow_center")],i)}(Pn),function(t){function i(){return null!==t&&t.apply(this,arguments)||this}e(i,t),i.prototype.digest=function(){var e=this;t.prototype.digest.call(this);var i=this.getBounds(),r=this.children.reduce(function(t,i,r){return i.getRealWidth()+e.items[r].left+t},0),o=Math.max(i.width-r,0)+i.left;this.adjustAndGenerate(o)},i=o([l("bi.flow_right")],i)}(Pn),function(){function t(t){this.hoverCellX=-1,this.hoverCellY=-1,this.loadData(t),this.digest()}return t.prototype.doMouseDown=function(t,e,i){var r=this.getMergeCell(e.ri,e.ci),o=c(r);window.setTimeout(function(){o.mouseDownHandler.call(null,t,e.x,e.y,r,i)},0)},t.prototype.doMouseLeave=function(t,e,i){var r=this.getMergeCell(e.ri,e.ci),o=c(r);window.setTimeout(function(){o.mouseLeaveHandler.call(null,t,e.x,e.y,r,i)},0)},t.prototype.doClick=function(t,e,i){var r=this.getMergeCell(e.ri,e.ci),o=c(r);window.setTimeout(function(){o.clickHandler.call(null,t,e.x,e.y,r,i)},0)},t.prototype.doDbClick=function(t,e,i){var r=this.getMergeCell(e.ri,e.ci),o=c(r);window.setTimeout(function(){o.dbClickHandler&&o.dbClickHandler.call(null,t,e.x,e.y,r,i)},0)},t.prototype.doHover=function(t,e,i){var r=this.getMergeCell(e.ri,e.ci);if(this.hoverCellX!==e.ri||this.hoverCellY!==e.ci){this.hoverCellX=e.ri,this.hoverCellY=e.ci;var o=c(r);window.setTimeout(function(){o.hoverHandler&&o.hoverHandler.call(null,t,e.x,e.y,r,i)},0)}},t.prototype.disHover=function(){if(-1!==this.hoverCellX||-1!==this.hoverCellY){var t=c(this.getMergeCell(this.hoverCellX,this.hoverCellY));this.hoverCellX=-1,this.hoverCellY=-1,window.setTimeout(function(){t.hoverHandler&&t.hoverHandler.call(null)},0)}},t.prototype.getSumHeight=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.rowc);var i=0;t=Math.max(0,t),e=Math.min(e,this.rowc);for(var r=t;r<e;r++)i+=this.getRowHeight(r);return i},t.prototype.getSumWidth=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.colc);var i=0;t=Math.max(0,t),e=Math.min(e,this.colc);for(var r=t;r<e;r++)i+=this.getColWidth(r);return i},t.prototype.getRowHeight=function(t){return $o(this.rows[t])?30:this.rows[t]},t.prototype.getColWidth=function(t){return $o(this.cols[t])?80:this.cols[t]},t.prototype.getCellsInRange=function(t){for(var e=[],r=t[0],o=t[1],n=r[1];n<=o[1];n++)for(var s=o[0];s>=r[0];s--){var a=this.getMergeCell(n,s);e.push(i(i({},a),{x:a.x+.5,y:a.y+.5}))}return e},t.prototype.getCellSquareInRange=function(t){for(var e=[],r=t[0],o=t[1],n=r[1];n<=o[1];n++){for(var s=[],a=r[0];a<=o[0];a++){var h=this.getMergeCell(n,a);s.push(i(i({},h),{x:h.x+.5,y:h.y+.5}))}e.push(s)}return e},t.prototype.getRangeBounds=function(t){for(var e=0,i=0,r=0,o=0,n=t[0],s=t[1],a=0;a<=s[1];a++)a===n[1]&&(o=e),e+=this.getRowHeight(a);for(a=0;a<=s[0];a++)a===n[0]&&(r=i),i+=this.getColWidth(a);return{x:r,y:o,width:i-r,height:e-o}},t.prototype.getCellIndexs=function(t,e){for(var i=0,r=0,o=0,n=0,s=0;s<this.rowc;s++){if(e<=(r+=this.getRowHeight(s))){o=s;break}o=s}for(s=0;s<this.colc;s++){if(t<=(i+=this.getColWidth(s))){n=s;break}n=s}return[n,o]},t.prototype.getCellPoistion=function(t,e){return{x:this.getSumWidth(0,e),y:this.getSumHeight(0,t)}},t.prototype.getCellBounds=function(t,e){return{x:this.getSumWidth(0,e),y:this.getSumHeight(0,t),width:this.getColWidth(e),height:this.getRowHeight(t)}},t.prototype.findMergeRange=function(t,e){return Ir(this.merges,function(i){var r=i[0],o=i[1];return t>=r[1]&&t<=o[1]&&e>=r[0]&&e<=o[0]})||[[e,t],[e,t]]},t.prototype.getCellArea=function(t,e,i,r){return[this.getMergeCell(t,e),this.getMergeCell(i,r)]},t.prototype.getCell=function(t,e){var r=this.data[t]&&this.data[t][e]||null;return i(i(i({valid:null!==r,x:0,y:0},r),this.getCellBounds(t,e)),{ri:t,ci:e})},t.prototype.getViewData=function(){return this.data},t.prototype.isHoverText=function(t,e,i){return(t.textArea||[]).some(function(r){return t.x+r.x<=e&&t.y+r.y<=i&&t.x+r.x+r.width>=e&&t.y+r.y+r.height>=i})},t.prototype.getMergeCell=function(t,e){var r=this.findMergeRange(t,e),o=r[0],n=r[1];return i(i({},this.getCell(o[1],o[0])),{ri:o[1],ci:o[0],width:this.getSumWidth(o[0],n[0]+1),height:this.getSumHeight(o[1],n[1]+1),rp:n[1]-o[1],cp:n[0]-o[0]})},t.prototype.updateCell=function(t,e,i){this.data[t]&&(this.data[t][e]=i)},t.prototype.getStickers=function(){return this.stickers},t.prototype.setRowHeight=function(t,e){this.rows[t]=e,this.digest()},t.prototype.setColWidth=function(t,e){this.cols[t]=e,this.digest()},t.prototype.insertRows=function(t,e,i){var r,o,s=i.rows;this.rowc+=e.length,(r=this.rows).splice.apply(r,n([t,0],s)),(o=this.data).splice.apply(o,n([t,0],e)),t<this.freeze[1]&&(this.freeze[1]+=e.length),this.updateMerges(t,e.length,0,0),this.updateStickers(t,e.length,0,0),this.digest()},t.prototype.deleteRows=function(t,e){this.rowc=Math.max(t,this.rowc-e),this.rows.splice(t,e),this.data.splice(t,e),this.updateMerges(t,-e,0,0),this.updateStickers(t,-e,0,0),this.digest()},t.prototype.inserCols=function(t,e,i){var r,o=i.cols;this.colc+=e.length,(r=this.cols).splice.apply(r,n([t,0],o)),this.data.forEach(function(i,r){i.splice.apply(i,n([t,0],e[r]))}),t<this.freeze[0]&&(this.freeze[0]+=e.length),this.updateMerges(0,0,t,e.length),this.updateStickers(0,0,t,e.length),this.digest()},t.prototype.deleteCols=function(t,e){this.colc=Math.max(t,this.colc-e),this.cols.splice(t,e),this.data.forEach(function(i){i.splice(t,e)}),this.updateMerges(0,0,t,e),this.updateStickers(0,0,t,e),this.digest()},t.prototype.digest=function(){this.totalWidth=this.getSumWidth(),this.totalHeight=this.getSumHeight(),this.freezeWidth=this.getSumWidth(0,this.freeze[0]),this.freezeHeight=this.getSumHeight(0,this.freeze[1])},t.prototype.loadData=function(t){var e=t.colc,i=t.rowc,r=t.cols,o=t.rows,n=t.data,s=t.freeze,a=t.merges,h=t.styles,l=t.stickers;this.colc=e,this.rowc=i,this.cols=r||[],this.rows=o||[],this.cols.length=e,this.rows.length=i,this.freeze=s||[0,0],this.data=n||[],this.merges=a||[],this.styles=h||[],this.stickers=(l||[]).map(function(t){return t.id=t.id||Io(),t}),this.digest()},t.prototype.updateMerges=function(t,e,i,r){this.merges.forEach(function(o){var n=o[0],s=o[1];n[0]>=i&&(n[0]+=r),n[1]>=t&&(n[1]+=e),s[0]>=i&&(s[0]+=r),s[1]>=t&&(s[1]+=e)})},t.prototype.updateStickers=function(t,e,i,r){this.stickers.forEach(function(o){var n=o.position;"row"in n&&"col"in n&&(n.row>t&&n.row<=t-e||n.col>i&&n.col<=i-r?o.tag="delete":o.tag="normal",n.col>=i&&(n.col+=r),n.row>=t&&(n.row+=e)),"x"in n&&"y"in n&&(n.x>=i&&(n.x+=r),n.y>=t&&(n.y+=e))})},t.prototype.getSelctionRange=function(t,e,i,r){if(!this.data[0])return[];for(var o=this.data[0].length,n=[],s=e,a=t;s<=r&&!(s===r&&a>i);){var h=this.getCell(s,a);h&&n.push(h),a===o?(s++,a=0):a++}return n},t.prototype.reset=function(){this.getViewData().forEach(function(t){t.forEach(function(t){(t||t.textArea)&&(t.textArea=[])})})},t}()),Xn={sheet:{colc:0,rowc:0},scroll:{x:0,y:0,sr:0,sc:0,er:0,ec:0},selection:{},selectable:!1,width:0,height:0,topSequnce:{enable:!1,size:30},leftSequnce:{enable:!1,size:80},offsetX:0,offsetY:0,align:!1},Nn=[-1,-1],Yn=function(){function t(){this.start={x:0,y:0},this.end={x:0,y:0},this.selectedTexts=[],this.reset()}return t.prototype.selectCell=function(t,e,i){this.cell=[e,t],this.range=[Nn,Nn],this.start=i},t.prototype.selectRange=function(t,e,i,r,o){this.cell===Nn&&(this.cell=[0,0]),this.range=[[e,t],[r,i]],this.end=o},t.prototype.getCell=function(){return this.cell},t.prototype.getRange=function(){return[this.range[0]===Nn?this.cell:this.range[0],this.range[1]===Nn?this.cell:this.range[1]]},t.prototype.getPosition=function(){return this.start.y>this.end.y?{start:this.end,end:this.start}:this.start.y===this.end.y&&this.start.x>this.end.x?{start:this.end,end:this.start}:{start:this.start,end:this.end}},t.prototype.reset=function(){this.cell=Nn,this.range=[Nn,Nn],this.start={x:0,y:0},this.end={x:0,y:0},this.setSelectedTexts([])},t.prototype.setSelectedTexts=function(t){this.selectedTexts=t},t.prototype.getSelectedTexts=function(){return this.selectedTexts},t}(),Gn=function(){function t(t,e){void 0===t&&(t="sheet"),this.name=t,this.selection=new Yn,this.options=i(i({},_o(Xn,jo|Ro)),e),this.view=new Dn(this.options.sheet),this.scroll=this.options.scroll,this.scroll.x=isNaN(this.scroll.x)?0:this.scroll.x,this.scroll.y=isNaN(this.scroll.y)?0:this.scroll.y,this.update()}return t.prototype.getRenderBounds=function(t){var e=this.view.freezeWidth,i=this.view.freezeHeight;return"horizontal"===t?{x:e,y:0,width:this.width-e,height:this.options.height}:{x:0,y:i,width:this.width,height:this.options.height-i}},t.prototype.select=function(t,e,i,r,o){if(void 0!==i&&void 0!==r){var n=this.correctSelectRange(t,e,i,r),s=n[0],a=s[0],h=s[1],l=n[1],c=l[0],d=l[1];this.selection.selectRange(h,a,d,c,o)}else this.selection.selectCell(t,e,o)},t.prototype.scrollTo=function(t,e,i){this.sc(t,e,i)},t.prototype.scrollX=function(t,e){t=ae(t,0,this.maxScrollX),this.sc(t,this.scroll.y,e)},t.prototype.scrollY=function(t,e){t=ae(t,0,this.maxScrollY),this.sc(this.scroll.x,t,e)},t.prototype.getViewRange=function(){return[this.view.getCellIndexs(this.scroll.x,this.scroll.y),this.view.getCellIndexs(this.scroll.x+this.width,this.scroll.y+this.height)]},t.prototype.getScrollRange=function(){return[this.view.getCellIndexs(this.scroll.x+this.view.freezeWidth,this.scroll.y+this.view.freezeHeight),this.view.getCellIndexs(this.scroll.x+this.width,this.scroll.y+this.height)]},t.prototype.getViewBounds=function(){return{width:this.width,height:this.height}},t.prototype.getScroll=function(){return this.scroll},t.prototype.getCellIndexs=function(t,e){var i=this.view.freezeWidth,r=this.view.freezeHeight;t>i&&(t+=this.scroll.x),e>r&&(e+=this.scroll.y);var o=this.view.getCellIndexs(t,e),n=this.view.getMergeCell(o[1],o[0]);return[n.ci,n.ri]},t.prototype.getCellByOffset=function(t,e){if(t<this.offset.offsetX||e<this.offset.offsetY)return null;var i=this.getPositionByOffset(t,e),r=i.x,o=i.y,n=this.view.getCellIndexs(r,o);return this.view.getMergeCell(n[1],n[0])},t.prototype.getPositionByOffset=function(t,e){var i=this.view.freezeWidth,r=this.view.freezeHeight;return t-=this.offset.offsetX,e-=this.offset.offsetY,t>i&&(t+=this.scroll.x),e>r&&(e+=this.scroll.y),{x:t,y:e}},t.prototype.updateCell=function(t,e,i){this.view.updateCell(t,e,i)},t.prototype.getCellIndexsByOffset=function(t,e){var i=this.offset,r=i.offsetX,o=i.offsetY;if(t>=r&&e>=o&&(e-=o,(t-=r)<=this.view.totalWidth&&e<=this.view.totalHeight)){var n=this.getCellIndexs(t,e),s=n[0],a=n[1];return!1===this.view.getCell(a,s).valid?null:[s,a]}},t.prototype.getFreezeBounds=function(){return[{x:this.view.freezeWidth,y:0,width:this.width-this.view.freezeWidth,height:this.view.freezeHeight},{x:0,y:this.view.freezeHeight,width:this.view.freezeWidth,height:this.height-this.view.freezeHeight},{x:0,y:0,width:this.view.freezeWidth,height:this.view.freezeHeight}]},t.prototype.cellIsFreezed=function(t){return{horizontalFreezed:t.y+t.height<=this.view.freezeHeight,verticalFreezed:t.x+t.width<=this.view.freezeWidth}},t.prototype.getCellsInBounds=function(t,e,i,r){var o=this,n=[],s=[];(t=Math.max(t,0),e=Math.max(e,0),i=Math.min(i,this.width-t),r=Math.min(r,this.height-e),t<this.view.freezeWidth&&e<this.view.freezeHeight)?n=this.view.getCellsInRange([this.view.getCellIndexs(t,e),this.view.getCellIndexs(this.view.freezeWidth,this.view.freezeHeight)]):t<this.view.freezeWidth?n=this.view.getCellsInRange([this.view.getCellIndexs(t,e+this.scroll.y),this.view.getCellIndexs(this.view.freezeWidth,e+this.scroll.y+r)]):e<this.view.freezeHeight?n=this.view.getCellsInRange([this.view.getCellIndexs(t+this.scroll.x,e),this.view.getCellIndexs(t+this.scroll.x+i,this.view.freezeHeight)]):s=this.view.getCellsInRange([this.view.getCellIndexs(t+this.scroll.x,e+this.scroll.y),this.view.getCellIndexs(t+this.scroll.x+i,r+e+this.scroll.y)]);var a=new Set,h=[];return Array.prototype.concat(s,n).reduce(function(t,e){var i=e.ci+"-"+e.ri;return a.has(i)?t:(a.add(i),t.push(o.correctBounds(e)),t)},h),h},t.prototype.getCellBounds=function(t,e){var i=this.view.freeze,r=this.view.getCellBounds(t,e);return t>i[1]&&(r.y-=this.scroll.y),e>i[0]&&(r.x-=this.scroll.x),r},t.prototype.getCell=function(t,e){return i(i({},this.getCellBounds(t,e)),{ri:t,ci:e})},t.prototype.getMergeCells=function(){var t=this;return this.view.merges.map(function(e){var r=e[0],o=t.view.getRangeBounds(e);return t.correctBounds(i(i(i({},t.view.getCell(r[1],r[0])),o),{x:o.x+.5,y:o.y+.5}))})},t.prototype.getRangeBounds=function(t){return this.view.getRangeBounds(t)},t.prototype.correctDeltaY=function(t){if(!t)return t;var e=this.scroll.y+t;if(e<=0)return-this.scroll.y;if(e>=this.maxScrollY)return this.maxScrollY-this.scroll.y;if(!this.options.align)return t;for(var i=e+this.view.freezeHeight,r=this.view.freezeHeight,o=e,n=this.view.freeze[1];n<this.view.rowc;n++){var s=this.view.getRowHeight(n);if(i>=r&&i<r+s){o=i>r+s/2?r+s:r;break}r+=s}return o-this.scroll.y-this.view.freezeHeight},t.prototype.correctDeltaX=function(t){if(!t)return t;var e=this.scroll.x+t;if(e<=0)return-this.scroll.x;if(e>=this.maxScrollX)return this.maxScrollX-this.scroll.x;if(!this.options.align)return t;for(var i=e+this.view.freezeWidth,r=this.view.freezeWidth,o=e,n=this.view.freeze[0];n<this.view.colc;n++){var s=this.view.getColWidth(n);if(i>=r&&i<r+s){o=i>r+s/2?r+s:r;break}r+=s}return o-this.scroll.x-this.view.freezeWidth},t.prototype.getSequnceCells=function(){var t=this,e=this.selection.getRange(),r=e[0],o=r[0],n=r[1],s=e[1],a=s[0],h=s[1],l=[],c=[],d=this.view.getCellArea(n,o,h,a),f=d[0],u=d[1],p=Math.min(f.ci,u.ci),g=Math.max(f.ci+f.cp,u.ci+u.cp),v=Math.min(f.ri,u.ri),y=Math.max(f.ri+f.rp,u.ri+u.rp);return this.options.topSequnce.enable&&(l=Array.prototype.concat(Qo(this.scroll.sc,this.scroll.ec+1),Qo(0,this.view.freeze[0])).map(function(e){var r,o=t.getCellBounds(0,e);return i(i({},o),{x:o.x+.5,y:o.y-t.offset.offsetY+.5,width:t.view.getColWidth(e),height:t.offset.offsetY,type:"bi.label",text:(r=e,parseInt(""+r,10).toString(26).split("").reduce(function(t,e){return t+String.fromCharCode(parseInt(parseInt(e,26).toString(10),10)+65)},"")),ri:-1,ci:e,style:{color:"#5f6368",backgroundColor:tn(e,p,g)?"#e8eaed":"#f8f9fa"}})})),this.options.leftSequnce.enable&&(c=Array.prototype.concat(Qo(this.scroll.sr,this.scroll.er+1),Qo(0,this.view.freeze[1])).map(function(e){var r=t.getCellBounds(e,0);return i(i({},r),{x:r.x-t.offset.offsetX+.5,y:r.y+.5,width:t.offset.offsetX-.5,height:t.view.getRowHeight(e)-.5,type:"bi.label",text:e+1,ci:-1,ri:e,style:{color:"#5f6368",backgroundColor:tn(e,v,y)?"#e8eaed":"#f8f9fa"}})})),Array.prototype.concat(l,c)},t.prototype.isInSticker=function(t,e){return this.getStickers().some(function(i){return i.left<=t&&i.left+i.width>=t&&i.top<=e&&i.top+i.height>=e})},t.prototype.getStickers=function(){var t=this;return this.view.getStickers().map(function(e){var i=e.el,r=e.position,o=e.id,n=e.tag,s=e.init,a=e.lazy,h=0,l=0,c=0,d=0;if("x"in r&&(l=r.x,h=r.y,c=r.width,d=r.height),"col"in r&&"row"in r){var f=t.view.findMergeRange(r.row,r.col),u=f[0],p=f[1],g=t.getStickerBounds(r.row,r.col);l=g.x,h=g.y,c=t.view.getSumWidth(u[0],p[0]+1),d=t.view.getSumHeight(u[1],p[1]+1)}return{id:o,top:h,left:l,width:c,height:d,el:i,tag:n,init:s,lazy:a}})},t.prototype.getStickerBounds=function(t,e){return this.view.getCellBounds(t,e)},t.prototype.getResizerCell=function(t,e){var r,o,n=t>this.offset.offsetX,s=n?t-this.offset.offsetX:t,a=n?e:e-this.offset.offsetY,h=this.getCellIndexs(s,a),l=this.getCellBounds(h[1],h[0]);return n?s-l.x<l.x+l.width-s?(r=[h[0],Math.max(h[1]-1,0)],o=this.getCellBounds(r[1],r[0])):(r=h,o=l):a-l.y<l.y+l.height-a?(r=[Math.max(h[0]-1,0),h[1]],o=this.getCellBounds(r[1],r[0])):(r=h,o=l),i(i({},o),{ri:r[1],ci:r[0],left:n?o.x+this.offset.offsetX:o.x,top:n?o.y:o.y+this.offset.offsetY,width:n?o.width:this.offset.offsetX,height:n?this.offset.offsetY:o.height})},t.prototype.getSelectCell=function(){var t=this.selection.getCell(),e=t[0],i=t[1];return this.view.getMergeCell(i,e)},t.prototype.getSelectRangeCells=function(){return this.view.getCellSquareInRange(this.getSelectRange())},t.prototype.getSelectRange=function(){var t=this.selection.getRange(),e=t[0],i=e[0],r=e[1],o=t[1],n=o[0],s=o[1],a=this.view.getMergeCell(r,i),h=this.view.getMergeCell(s,n),l=Math.min(a.ci,h.ci),c=Math.max(a.ci+a.cp,h.ci+h.cp);return[[l,Math.min(a.ri,h.ri)],[c,Math.max(a.ri+a.rp,h.ri+h.rp)]]},t.prototype.transformPosition=function(t,e,i){var r,o,n=this.selection.getRange(),s=n[0],a=s[0],h=s[1],l=n[1],c=l[0],d=l[1],f=i.ci===a&&i.ri===h,u=i.ci===c&&i.ri===d,p=this.getCellPosition({row:i.ri,col:i.ci},this.view.merges);return f&&u?(i.textArea||[]).some(function(r){return i.y+r.y<=t.y&&i.y+r.y+r.height>=t.y&&i.y+r.y<=e.y&&i.y+r.y+r.height>=e.y})&&t.x>e.x?[e,t]:[t,e]:f?(!en(t,{x:i.x,y:i.y,width:p.width,height:p.height})&&(t=(r=[e,t])[0],e=r[1]),[t,{x:i.x+p.width,y:i.y+i.height}]):u?(!en(e,{x:i.x,y:i.y,width:p.width,height:p.height})&&(t=(o=[e,t])[0],e=o[1]),[{x:i.x,y:i.y},e]):[{x:i.x,y:i.y},{x:i.x+p.width,y:i.y+p.height}]},t.prototype.getSelectBounds=function(){var t=this,e=this.selection.getRange(),i=e[0],r=i[0],o=i[1],n=e[1],s=n[0],a=n[1],h=this.selection.getPosition(),l=h.start,c=h.end,d=this.view.getSelctionRange(r,o,s,a),f=[],u=new Map;return d.forEach(function(e){var i=e.ci===r&&e.ri===o,n=e.ci===s&&e.ri===a,h=i||n,d=t.offset2Absolute(l,e),p=t.offset2Absolute(c,e),g=t.transformPosition(d,p,e),v=g[0],y=g[1],w="";(e.textArea||[]).forEach(function(i){var r=i.x,o=i.y,n=i.width,s=i.height,a=i.text;a&&(!h||(e.y+o<v.y?e.y+o+s>v.y:e.y+o<y.y)&&(!(e.y+o<v.y)||e.x+r+n>v.x)&&(!(e.y+o+s>y.y)||e.x+r<y.x))&&(f.push(t.spliteBounds(r+e.x,o+e.y,r+e.x+n,o+e.y+s)),w+=a)}),w&&u.set(e.y,(u.get(e.y)||[]).concat([w]))}),this.selection.setSelectedTexts(Array.from(u.values())),f},t.prototype.offset2Absolute=function(t,e){var i=[t.x,t.y],r=i[0],o=i[1],n=this.getScroll(),s=n.x,a=n.y,h=this.cellIsFreezed(e),l=h.verticalFreezed;return!h.horizontalFreezed&&(o+=a),!l&&(r+=s),{x:r,y:o}},t.prototype.getQuadrantBounds=function(t,e){var i=this.view.freezeWidth+1,r=this.view.freezeHeight+1,o=e<r,n=t<i;return{x:n?0:i,y:o?0:r,width:n?i:this.width-i,height:o?r:this.height-r}},t.prototype.spliteBounds=function(t,e,i,r){var o=[],n=this.view.freezeWidth,s=this.view.freezeHeight;return o.push({x:t,y:e,width:Math.min(n-t,i-t),height:Math.min(s-e,r-t)}),o.push({x:Math.max(n,t),y:e,width:i-Math.max(n,t),height:Math.min(s-e,r-e)}),o.push({x:t,y:Math.max(s,e),width:Math.min(n-t,i-t),height:r-Math.max(s,e)}),o.push({x:Math.max(n,t),y:Math.max(s,e),width:i-Math.max(n,t),height:r-Math.max(s,e)}),o},t.prototype.setOffset=function(t){var e=t.offsetX,i=t.offsetY;this.offset=t,this.width=this.width-e,this.height=this.height-i,this.update()},t.prototype.resizeRow=function(t,e){this.view.setRowHeight(t,e),this.updateMaxScroll(),this.updateScrollRange()},t.prototype.resizeCol=function(t,e){this.view.setColWidth(t,e),this.updateMaxScroll(),this.updateScrollRange()},t.prototype.insertRows=function(t,e,i){this.view.insertRows(t,e,i),this.update()},t.prototype.insertCols=function(t,e,i){this.view.inserCols(t,e,i),this.update()},t.prototype.deleteRows=function(t,e){this.view.deleteRows(t,e),this.update()},t.prototype.deleteCols=function(t,e){this.view.deleteCols(t,e),this.update()},t.prototype.setData=function(t){this.options=i(i(i({},Xn),this.options),t),this.view.loadData(this.options.sheet),this.scroll=this.options.scroll,this.update()},t.prototype.resize=function(t,e){this.options.width=t||this.options.width,this.options.height=e||this.options.height,this.view.reset(),this.update()},t.prototype.reset=function(){this.clearSelection()},t.prototype.update=function(){this.updateOffset(),this.updateMaxScroll(),this.updateScrollRange()},t.prototype.correctBounds=function(t){var e=t.x,r=t.y,o=this.view.freezeWidth,n=this.view.freezeHeight;return i(i({},t),{x:e>=o?e-this.scroll.x:e,y:r>=n?r-this.scroll.y:r,ox:e,oy:r})},t.prototype.clearSelection=function(){this.selection.reset()},t.prototype.sc=function(t,e,r){var o=i({},this.scroll);this.scroll.x=t,this.scroll.y=e,this.updateScrollRange(),r&&r(this.scroll,o)},t.prototype.updateScrollRange=function(){this.scroll.x=Math.ceil(Math.min(this.scroll.x,this.maxScrollX)),this.scroll.y=Math.ceil(Math.min(this.scroll.y,this.maxScrollY));var t=this.getScrollRange(),e=t[0],i=t[1];this.scroll.sr=e[1],this.scroll.sc=e[0],this.scroll.er=i[1],this.scroll.ec=i[0]},t.prototype.updateOffset=function(){this.offset={offsetX:(this.options.leftSequnce.enable?this.options.leftSequnce.size:0)+this.options.offsetX,offsetY:(this.options.topSequnce.enable?this.options.topSequnce.size:0)+this.options.offsetY},this.width=this.options.width-this.offset.offsetX,this.height=this.options.height-this.offset.offsetY},t.prototype.updateMaxScroll=function(){var t=this.getMaxScrollBounds(),e=t.width,i=t.height;this.maxScrollX=Math.ceil(e),this.maxScrollY=Math.ceil(i)},t.prototype.getMaxScrollBounds=function(){var t=0,e=0;if(!this.options.align)return{width:Math.max(this.view.totalWidth-this.width,0),height:Math.max(this.view.totalHeight-this.height,0)};for(var i=this.view.rowc-1;i>=0;i--){var r=this.view.getRowHeight(i);if(t+r>this.height-this.view.freezeHeight)break;t+=r}for(i=this.view.colc-1;i>=0;i--){var o=this.view.getColWidth(i);if(e+o>this.width-this.view.freezeWidth)break;e+=o}return{width:Math.max(this.view.totalWidth-this.view.freezeWidth-e,0),height:Math.max(this.view.totalHeight-this.view.freezeHeight-t,0)}},t.prototype.correctSelectRange=function(t,e,i,r){var o,n,s;t>i&&(t=(o=[i,t])[0],i=o[1],e=(n=[r,e])[0],r=n[1]),t===i&&e>r&&(e=(s=[r,e])[0],r=s[1]);for(var a=[[e,t],[r,i]],h=[[e,t],[r,i]],l=function(){a=h;var t=h;c.view.merges.forEach(function(e){var i,r;t=Ko(i=t,r=e)?[[Math.min(i[0][0],r[0][0]),Math.min(i[0][1],r[0][1])],[Math.max(i[1][0],r[1][0]),Math.max(i[1][1],r[1][1])]]:i}),h=t},c=this;!Pr(a,h);)l();return h},t.prototype.getCellPosition=function(t,e){var i=e.find(function(e){return e.findIndex(function(e){return 2===e.length&&e[0]===t.col&&e[1]===t.row})>=0});return i?this.view.getRangeBounds(i):this.view.getCellBounds(t.row,t.col)},t}();function Fn(t,e,i){var r=C();return t.width=Math.round(e*r),t.height=Math.round(i*r),a(t).offset({width:t.width/r,height:t.height/r}),t.getContext("2d").setTransform(r,0,0,r,0,0),t}var qn=function(){function t(t,e){var i=C();this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.ctx.setTransform(i,0,0,i,0,0)}return t.prototype.drawText=function(t,e,i,r,o,n){this.text(t,e,i,r,o,n)},t.prototype.wrapText=function(t,e){var r=this,o=t.text,n=t.x,s=t.y,a=t.width,h=t.height,l=t.lineHeight,c=t.options;this.ctx.save();var d=c.verticalAlign,f=c.clip,u=c.fontStyle,p=c.fontWeight,g=c.fontFamily,v=c.verticalText,y=c.textAlign,w=c.fontSize;f&&(this.ctx.beginPath(),this.ctx.rect(n,s,a,h),this.ctx.clip(),this.ctx.beginPath()),z(this.ctx,{fontFamily:g,fontSize:w,fontStyle:u,fontWeight:p}),l=l||1.2*parseFloat(w);var b=[],m=this.makeLineTextOpts(w,o,n,s,a,h,l,c);if(b=m.textOpts,w=m.fontSize,l=m.lineHeight,"VERTICAL_TEXT"===v){var x=l*b.length;b.forEach(function(t,o){var n=t.text,s=t.width,h=t.height,c=t.options,f=t.x,v=t.y;switch(y){case"left":break;case"center":f+=(a-x)/2;break;case"right":f+=a-x;break;case"distributed":f+=(a-x)/(b.length-1)*o}var m=Math.floor(h/l);switch(d){case"middle":v+=Math.floor((m-n.length)/2)*l;break;case"bottom":v+=(m-n.length)*l}if(r.textVertical(n,f,v,s,h,i(i({},c),{verticalAlign:d,fontFamily:g,fontSize:w,fontWeight:p,fontStyle:u,lineHeight:l,clip:!1}),e),0===o){var S=b.reduce(function(t,e){return Math.max(t,e.text.length)},0),C=b.length,k=E({fontFamily:g,fontSize:w}).baseline;v=1===C?v:t.y;for(var z=0;z<S;z++)v+=l,r.drawUnderline(f,v-l/4+parseFloat(k),f+s*C,v-l/4+parseFloat(k),c),r.drawStrikeThrough(f,v-l/4+parseFloat(w)/10,f+s*C,v-l/4+parseFloat(w)/10,c)}})}else{var S=l*b.length;b.forEach(function(t){var o=t.text,n=t.x,s=t.width,a=t.height,c=t.options,f=t.y;switch(d){case"top":break;case"middle":f+=h-S>0?(h-S)/2:2;break;case"bottom":f+=h-S>0?h-S:2}r.text(o,n,f,s,a,i(i({},c),{verticalAlign:"middle",fontFamily:g,fontSize:w,fontWeight:p,fontStyle:u,lineHeight:l,clip:!1}),e)})}this.ctx.restore()},t.prototype.drawLine=function(t,e,i,r,o){var n=o.color,s=o.lineWidth,a=o.lineStyle,h=o.lineDash;if(0!==s&&"none"!==a){switch(this.ctx.save(),n&&(this.ctx.strokeStyle=n),s&&(this.ctx.lineWidth=s),a){case"solid":break;case"dashed":this.ctx.setLineDash(h);break;case"dotted":this.ctx.setLineDash([1,1]);break;case"double":return this.ctx.lineWidth=s/2,this.drawDoubleLine({x:t,y:e,x1:i,y1:r}),void this.ctx.restore()}this.ctx.beginPath(),this.linePath([[t,e],[i,r]]),this.ctx.restore()}},t.prototype.drawDoubleLine=function(t){var e=t.x,i=t.y,r=t.x1,o=t.y1,n=r-e,s=o-i,a=Math.sqrt(n*n+s*s),h=1*-s/a,l=1*n/a;this.ctx.beginPath(),this.linePath([[e+h,i+l],[r+h,o+l]]),this.linePath([[e-h,i-l],[r-h,o-l]])},t.prototype.drawRect=function(t,e,i,r,o){this.ctx.save();var n=o.color,s=void 0===n?"#fff":n,a=o.fillColor,h=o.lineWidth,l=void 0===h?0:h,c=o.linearGradient,d=o.radiusConfig,f=a;if(this.ctx.beginPath(),d?this.drawRadiusRect(t,e,i,r,d):this.ctx.rect(t,e,i,r),this.ctx.closePath(),c){var u=c.degree,p=c.stops,g=function(t,e,i){t=t*Math.PI/180;var r=Math.sqrt(e*e+i*i),o=Math.atan(e/i),n=Math.cos(o-t)*r/2,s=Math.sin(t)*n,a=Math.cos(t)*n;return[[e/2-s,i/2-a],[e/2+s,i/2+a]]}(u,i,r),v=g[0],y=v[0],w=v[1],b=g[1],m=b[0],x=b[1],S=this.ctx.createLinearGradient(t+y,e+w,t+m,e+x);return p.forEach(function(t){S.addColorStop(t.per,t.color)}),this.ctx.fillStyle=S,this.ctx.fill(),this.ctx.restore()}f&&(this.ctx.fillStyle=f,this.ctx.fill()),l&&(this.ctx.strokeStyle=s,this.ctx.lineWidth=l,this.ctx.stroke()),this.ctx.restore()},t.prototype.drawRadiusRect=function(t,e,i,r,o){var n=o.radius,s=o.tlRadius,a=o.trRadius,h=o.blRadius,l=o.brRadius,c=Math.floor(Math.min(r/2,n)),d=Math.floor(Math.min(i/2,n));this.ctx.moveTo(t,e+c),s?this.ctx.quadraticCurveTo(t,e,t+d,e):this.ctx.lineTo(t,e),this.ctx.lineTo(t+i-d,e),a?this.ctx.quadraticCurveTo(t+i,e,t+i,e+c):this.ctx.lineTo(t+i,e),this.ctx.lineTo(t+i,e+r-c),l?this.ctx.quadraticCurveTo(t+i,e+r,t+i-d,e+r):this.ctx.lineTo(t+i,e+r),this.ctx.lineTo(t+d,e+r),h?this.ctx.quadraticCurveTo(t,e+r,t,e+r-c):this.ctx.lineTo(t,e+r),this.ctx.lineTo(t,e+c)},t.prototype.drawBias=function(t,e,r,o,n,s,a){var h=this;this.ctx.save();var l=a.fontSize,c=void 0===l?"9px":l,d=a.color,f=void 0===d?"#000000":d,u=a.fontWeight,p=void 0===u?400:u,g=a.fontFamily,v=void 0===g?"sans-serif":g,y=a.fontStyle,w=void 0===y?"normal":y,b={fontSize:c,color:f,fontWeight:p,fontFamily:v},m=1.3*parseFloat(c),x=function(t,e,i,r,o,n){void 0===o&&(o=!1);var s=[];if(!1===o){if(1===n&&s.push([[t,e],[t+i,e+r]]),2===n)s.push([[t,e],[t+i,e+2*r/3]]),s.push([[t,e],[t+2*i/3,e+r]]);else if(n>1)for(var a=Math.atan(r/i),h=Math.PI/2/(n+1),l=0,c=0;c<n;c++)(l+=h)<a?s.push([[t,e],[t+i,e+Math.ceil(Math.tan(l)*i)]]):s.push([[t,e],[t+Math.ceil(r*Math.tan(Math.PI/2-l)),e+r]])}else if(1===n&&s.push([[t,e+r],[t+i,e]]),2===n)s.push([[t,e+r],[t+2*i/3,e]]),s.push([[t,e+r],[t+i,e+r/3]]);else if(n>1)for(a=Math.atan(i/r),h=Math.PI/2/(n+1),l=0,c=0;c<n;c++)(l+=h)<a?s.push([[t,e+r],[t+Math.ceil(Math.tan(l)*r),e]]):s.push([[t,e+r],[t+i,e+r-Math.ceil(Math.tan(Math.PI/2-l)*i)]]);return s}(t,e,r,o,n,s.length-1);this.ctx.beginPath(),this.ctx.rect(t,e,r,o),this.ctx.clip(),z(this.ctx,{fontFamily:v,fontSize:c,fontStyle:w,fontWeight:p}),x.forEach(function(l,c){var d=l[0],u=l[1];if(h.drawLine(d[0],d[1],u[0],u[1],{color:f,lineWidth:1}),0===c){var p=m,g=[];if(p>o)return;for(;p<=o;){var v=null;if(n){var y=Math.abs((u[0]-d[0])/(u[1]-d[1]))*(o-p);v={x:t,y:e+p-m,width:y,height:m}}else{y=Math.abs((u[0]-d[0])/(u[1]-d[1]))*p;v={x:t+y,y:e+p-m,width:r-y,height:m}}g.push(v),p+=m}for(var w=(""+s[0]).split(""),S="",C=0,k=[],z=0;z<w.length;z++){var M=S+w[z],E=h.ctx.measureText(M).width;if(h.ctx.measureText(S).width>g[C].width)break;if(E>g[C].width){if(h.text(S,g[C].x,g[C].y,g[C].width,g[C].height,i(i({},b),{textAlign:"left",verticalAlign:"middle"})),k.push(i(i({x:g[C].x,y:g[C].y+g[C].height/2},g[C]),{text:S,options:a})),S=w[z],!g[++C])break}else S=M}S&&g[C]&&h.ctx.measureText(S).width<=g[C].width&&h.text(S,g[C].x,g[C].y,g[C].width,g[C].height,i(i({},b),{textAlign:"left",verticalAlign:"middle"}))}if(c===x.length-1){var T=o-m;for(g=[];T>=0;){v=null;if(n){y=Math.abs((u[0]-d[0])/(u[1]-d[1]))*(T+e-u[1]);v={x:t+r-y,y:e+T,width:y,height:m}}else{y=Math.abs((u[0]-d[0])/(u[1]-d[1]))*T;v={x:t,y:e+T,width:y,height:m}}g.push(v),T-=m}for(var A=h.ctx.measureText(""+s[s.length-1]).width,B=Math.floor(g.length/2),_=g.length%2==1?g[B].width:g[B].width+g[g.length-B-1].width;_<A&&B<g.length-1;)_+=g[++B].width+g[g.length-B-1].width;k=[];var j=!0;for(g.reverse();j;){w=(""+s[s.length-1]).split("");var R="";C=g.length-B-1;k=[];for(z=0;z<w.length;z++){M=R+w[z];if((E=h.ctx.measureText(M).width)>g[C].width){if(k.push({text:R,x:g[C].x,y:g[C].y,width:g[C].width,height:g[C].height,options:i(i({},b),{textAlign:"left",verticalAlign:"middle"})}),R=w[z],!g[++C])break}else R=M}R&&C<g.length&&k.push({text:R,x:g[C].x,y:g[C].y,width:g[C].width,height:g[C].height,options:i(i({},b),{textAlign:"left",verticalAlign:"middle"})}),R&&C>=g.length||R&&h.ctx.measureText(R).width>g[C].width?B++:j=!1,B>=g.length&&(j=!1)}k.forEach(function(t){var e=t.text,i=t.x,r=t.y,o=t.width,n=t.height,s=t.options;h.text(e,i,r,o,n,s)})}if(0!==c&&s.length>2){var O=x[c-1];if(n){var H=Math.atan(Math.abs((O[1][1]-O[0][1])/(O[1][0]-O[0][0]))),W=Math.atan(Math.abs((l[1][1]-l[0][1])/(l[1][0]-l[0][0]))),L=Math.abs(m/2/Math.sin((W-H)/2));h.ctx.save(),h.ctx.translate(t+Math.cos(H)*L,e+o-Math.sin(H)*L),h.ctx.rotate(-(H+(W-H)/2)),h.text(""+s[c],0,0,h.ctx.measureText(""+s[c]).width,m,i(i({},b),{textAlign:"left",verticalAlign:"middle"})),h.ctx.restore()}else{H=Math.atan((O[1][1]-O[0][1])/(O[1][0]-O[0][0])),W=Math.atan((l[1][1]-l[0][1])/(l[1][0]-l[0][0])),L=m/2/Math.sin((W-H)/2);h.ctx.save(),h.ctx.translate(t+Math.cos(H)*L,e+Math.sin(H)*L),h.ctx.rotate(H+(W-H)/2),h.text(""+s[c],0,0,h.ctx.measureText(""+s[c]).width,m,i(i({},b),{textAlign:"left",verticalAlign:"middle"})),h.ctx.restore()}}}),this.ctx.restore()},t.prototype.drawCurrencyLine=function(t,e,i,r,o,n,s){var a=this,h=o.intPart,l=h+o.deciPart,c=i/l,d="#8e877e",f="#2df713",u="#fe1713",p=function(t,i){a.drawLine(i+c,e,i+c,e+r,{color:t,lineWidth:1})},g=n.split(".")[0];n=n.replace(".","");for(var v=g.length<h?h-g.length:0,y=0;y<l;y++){var w=y-v;if(w>=0&&n.length>w){var b=n.substring(w,w+1);s.textAlign="center",this.text(b,t,e,c,r,s)}y+1!==l&&p(y+1===h?u:(y+1)%3==0?f:d,t),t+=c}},t.prototype.drawSelf=function(t,e,i,r,o,n){if(0!==o&&0!==n){var s=C();t*=s,e*=s,i*=s,r*=s,o*=s,n*=s,o=Math.min(o,this.canvas.width-i,this.canvas.width-t),n=Math.min(n,this.canvas.height-r,this.canvas.height-e),this.ctx.save();var a=this.getCacheCanvas(),h=this.getCacheContext();h.save(),h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,a.width,a.height),h.drawImage(this.canvas,t,e,o,n,i,r,o,n),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(i,r,o,n),this.ctx.drawImage(a,i,r,o,n,i,r,o,n),h.restore(),this.ctx.restore()}},t.prototype.drawImage=function(t,e,i,r,o,n,s){switch(void 0===n&&(n="center"),void 0===s&&(s={}),this.ctx.save(),this.ctx.beginPath(),s.radiusConfig?this.drawRadiusRect(e,i,r,o,s.radiusConfig):this.ctx.rect(e,i,r,o),this.ctx.clip(),"default"===n&&(n=t.width>r||t.height>o?"repeat":"center"),t.width===r&&t.height===o&&(this.ctx.imageSmoothingEnabled=!1),n){case"center":this.ctx.drawImage(t,0,0,t.width,t.height,e+(r-t.width||1)/2,i+(o-t.height||1)/2,t.width,t.height);break;case"stretch":this.ctx.drawImage(t,0,0,t.width,t.height,e,i,r,o);break;case"adapt":var a=o*(t.width/t.height),h=r*(t.height/t.width);a<=r?this.ctx.drawImage(t,e+(r-a)/2,i,a,o):h<=o&&this.ctx.drawImage(t,e,i+(o-h)/2,r,h);break;case"repeat":var l=this.ctx.createPattern(t,"repeat");this.ctx.fillStyle=l,this.ctx.translate(e,i),this.ctx.fillRect(0,0,r,o)}this.ctx.restore()},t.prototype.draw=function(t,e){var i=t.type,r=t.x,o=t.y,n=t.x1,s=t.y1,a=t.text,h=t.width,l=t.height,c=t.image,d=t.imageLayout,f=t.options;switch(i){case"text":var u=f.wrap,p=f.lineHeight;"wrap"===u?this.wrapText({text:a,x:r,y:o,width:h,height:l,lineHeight:parseFloat(p),options:f},e):this.drawText(a,r,o,h,l,f);break;case"rect":this.drawRect(r,o,h,l,f);break;case"line":this.drawLine(r,o,n,s,f);break;case"image":this.drawImage(c,r,o,h,l,d)}},t.prototype.clear=function(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.canvas.clientWidth),void 0===r&&(r=this.canvas.clientHeight),this.ctx.clearRect(t,e,i,r)},t.prototype.clip=function(t,e,i,r,o){if(0===i||0===r)return o&&o();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(t,e,i,r),this.ctx.clip(),o&&o(),this.ctx.restore()},t.prototype.getDefaultFont=function(){var t=window.getComputedStyle(this.canvas);return t.fontStyle+" "+t.fontWeight+" "+t.fontSize+" "+t.fontFamily},t.prototype.resize=function(t,e){Fn(this.canvas,t,e),this.cacheCanvas&&Fn(this.cacheCanvas,t,e)},t.prototype.linePath=function(t){if(t.length>1){var e=t[0],i=e[0],r=e[1];this.ctx.moveTo(i,r);for(var o=1;o<t.length;o++)this.ctx.lineTo(t[o][0],t[o][1]);this.ctx.stroke()}},t.prototype.text=function(t,e,i,r,o,n,s){var a=this;this.ctx.save();var h=i,l=n.clip,c=n.color,d=void 0===c?"":c,f=n.verticalAlign,u=n.textAlign,p=n.fontWeight,g=void 0===p?400:p,v=n.fontSize,y=void 0===v?"12px":v,w=n.fontFamily,b=void 0===w?"sans-serif":w,m=n.fontStyle,x=void 0===m?"normal":m,S=n.textShadow,C=n.subscript,k=n.supscript,M=n.lineHeight,T=n.rotate;d&&(this.ctx.fillStyle=d),z(this.ctx,{fontFamily:b,fontSize:y,fontStyle:x,fontWeight:g}),l&&(this.ctx.beginPath(),this.ctx.rect(e,i,r,o),this.ctx.clip()),S&&(this.ctx.shadowColor=S.shadowColor,this.ctx.shadowOffsetX=S.shadowOffsetX,this.ctx.shadowOffsetY=S.shadowOffsetY,this.ctx.shadowBlur=S.shadowBlur);var A=this.ctx.measureText(t),B=E({fontFamily:b,fontSize:y}).baseline,_=A.width;if(T){var j=function(t){var e=t.rotate,i=t.x,r=t.y,o=t.width,n=t.height,s=t.textAlign,a=t.boundsWidth,h=t.baseline,l=r+n/2-a/2,c=r+n/2+a/2;return Math.abs(e)<80||"center"===s?{baseX:i+o/2-h,baseY:r+n/2,textBaseline:e>0?"top":"bottom",textAlign:"center"}:"left"===s?{baseX:i,baseY:e<0?l:c,textBaseline:e>0?"top":"bottom",textAlign:s}:"right"===s?{baseX:i+o,baseY:e<0?c:l,textBaseline:e>0?"bottom":"top",textAlign:s}:{baseX:i,baseY:r,textBaseline:"bottom",textAlign:"left"}}({x:e,y:i,width:r,height:o,rotate:T,textAlign:u,boundsWidth:A.width,baseline:B}),R=j.baseX,O=j.baseY,H=j.textBaseline,W=j.textAlign;this.ctx.textAlign=W,this.ctx.translate(R,O),this.ctx.textBaseline=H,this.ctx.rotate(-T*Math.PI/180),this.ctx.fillText(t,0,0)}else{if(k)this.ctx.textBaseline="top",i-=o/2-B;else if(C)this.ctx.textBaseline="bottom",i=i+o+(o/2-B);else switch(f){case"top":this.ctx.textBaseline="top";break;case"middle":this.ctx.textBaseline="middle",i+=o/2;break;case"bottom":this.ctx.textBaseline="bottom",i+=o}switch(u){case"center":e=e+r/2-A.width/2;break;case"left":e=e;break;case"right":e=e+r-A.width}if("distributed"===u&&t.length>1){var L=(r-A.width)/(t.length-1),I=e;t.split("").forEach(function(t){a.ctx.fillText(t,I,i),s&&s({text:t,x:I,y:h,width:a.ctx.measureText(t).width,height:M}),I=I+a.ctx.measureText(t).width+L}),_=r}else{var P=e;(""+t).split("").forEach(function(t){s&&s({text:t,x:P,y:h,width:a.ctx.measureText(t).width,height:M}),P+=a.ctx.measureText(t).width}),this.ctx.fillText(t,e,i)}}this.drawUnderline(e,i+parseFloat(B),e+_,i+parseFloat(B),n),this.drawStrikeThrough(e,i+parseFloat(y)/20,e+_,i+parseFloat(y)/20,n),this.ctx.restore()},t.prototype.getVisualRangeText=function(t,e,i){if(this.ctx.measureText(t).width<e)return t;var r=this;return function o(n,s){var a=Math.floor((n+s)/2),h=t.substring(0,a)+i,l=t.substring(0,a+1)+i;return r.ctx.measureText(h).width>=e?o(n,s=a-1):r.ctx.measureText(l).width>=e?h:o(n=a+1,s)}(0,t.length)},t.prototype.textVertical=function(t,e,i,r,o,n,s){var a=this;this.ctx.save();var h=n.lineHeight,l=n.color,c=n.textShadow;l&&(this.ctx.fillStyle=l),c&&(this.ctx.shadowColor=c.shadowColor,this.ctx.shadowOffsetX=c.shadowOffsetX,this.ctx.shadowOffsetY=c.shadowOffsetY,this.ctx.shadowBlur=c.shadowBlur),t.split("").forEach(function(t){var o=a.ctx.measureText(t);i+=h,a.ctx.fillText(t,e+r/2-o.width/2,i),s&&s({word:t,x:e+r/2-o.width/2,y:i-2*h/3,width:o.width,height:h})}),this.ctx.restore()},t.prototype.drawUnderline=function(t,e,i,r,o){var n=o.underline;n&&n.width>0&&this.drawLine(t,e,i,r,{lineWidth:n.width,color:n.color,lineDash:n.dash,lineStyle:n.style})},t.prototype.drawStrikeThrough=function(t,e,i,r,o){var n=o.strikeThrough,s=o.fontSize,a=o.color;"solid"===n&&this.drawLine(t,e,i,r,{lineWidth:parseFloat(s)/10,color:a})},t.prototype.getCacheCanvas=function(){if(!this.cacheCanvas){var t=C();this.cacheCanvas=document.createElement("canvas"),this.cacheCanvas.width=this.canvas.width,this.cacheCanvas.height=this.canvas.height,this.cacheCanvas.getContext("2d").setTransform(t,0,0,t,0,0)}return this.cacheCanvas},t.prototype.getCacheContext=function(){return this.getCacheCanvas().getContext("2d")},t.prototype.makeLineTextOpts=function(t,e,i,r,o,n,s,a){var h=[],l=0;switch(a.newLine){case"SINGLE_LINE_ADJUST_FONT":1.2*(l=o/this.ctx.measureText(e).width*parseFloat(t))+10>n&&(l=(n-10)/1.2),t=l+"px",h=[{text:e,x:i,y:r,width:o,height:s=1.2*l,options:a}];break;case"MULTI_LINE_ADJUST_FONT":l=parseFloat(t)/(128/72);var c=o*(128/72);s=n/(h=this.makeTextOpts(e,i,r,c,n,s,a)).length,(h=this.makeTextOpts(e,i,r,c,n,s,a)).forEach(function(t){t.width=o}),t=l+"px";break;default:h=this.makeTextOpts(e,i,r,o,n,s,a)}return{textOpts:h,fontSize:t,lineHeight:s}},t.prototype.makeVerticalWrap=function(t,e,i,r,o,n,s){var a=s.newLine,h=s.verTextDirection,l=s.autoWrapInfo,c=n,d=[];if("SINGLE_LINE"===a)return[{text:t.substring(0,l[0]),x:e,y:i,width:c,height:o,options:s}];var f=Zo(t,l);return"RIGHT_TO_LEFT"===h&&(f=f.reverse()),f.forEach(function(t){d.push({text:t,x:e,y:i,width:c,height:o,options:s}),e+=n}),d},t.prototype.makeVerticalOpts=function(t,e,i,r,o,n,s){var a=s.newLine,h=s.verTextDirection,l=Math.floor(o/n),c=[],d=n;if("SINGLE_LINE"===a)return[{text:t.substring(l),x:e,y:i,width:d,height:o,options:s}];var f=[];return t.split("\n").forEach(function(t){for(var e=t;""!==e;)e.length>l?(f.push(e.substring(0,l)),e=e.substring(l)):(f.push(e),e="")}),"RIGHT_TO_LEFT"===h&&(f=f.reverse()),f.forEach(function(t){c.push({text:t,x:e,y:i,width:d,height:o,options:s}),e+=n}),c},t.prototype.makeSingleLineOpts=function(t,e,i,r,o,n,s){var a=s.overflowHide,h=s.hideType,l=s.appendTailStr,c=s.hideStrLength,d=t.split("\\n")[0];if(a)switch(h){case"CHAR_LENGTH":d=d.length<=c?d:d.substring(0,c)+l;break;case"CELL_WIDTH":d=this.getVisualRangeText(d,r,l)}else d=this.getVisualRangeText(d,r,"");return[this.newLine(d,e,i,r,o,n,s)]},t.prototype.newLine=function(t,e,i,r,o,n,s){return{text:t,x:e,y:i,width:r,height:n,options:s}},t.prototype.makeTextOpts=function(t,e,i,r,o,n,s){return s.autoWrapInfo?this.makeTextOptsByWrapInfo(t,e,i,r,o,n,s):this.makeTextOptsByWrapAuto(t,e,i,r,o,n,s)},t.prototype.makeTextOptsByWrapInfo=function(t,e,i,r,o,n,s){var a=this,h=s.newLine,l=s.verticalText,c=s.cellJust,d=s.rotate,f=s.autoWrapInfo;if(0!==d)return[this.newLine(t,e,i,r,o,n,s)];if("SINGLE_LINE"===h||"NONE"===c)return[this.newLine(t.substring(0,f[0]),e,i,r,o,n,s)];if("VERTICAL_TEXT"===l)return this.makeVerticalWrap(t,e,i,r,o,n,s);var u=Zo(t,f),p=[];return u.forEach(function(t){p.push(a.newLine(t,e,i,r,o,n,s)),i+=n}),p},t.prototype.makeTextOptsByWrapAuto=function(t,e,i,r,o,n,s){var a=this,h=s.newLine,l=s.verticalText,c=s.cellJust;if(0!==s.rotate)return[this.newLine(t,e,i,r,o,n,s)];if("SINGLE_LINE"===h||"NONE"===c)return this.makeSingleLineOpts(t,e,i,r,o,n,s);if("VERTICAL_TEXT"===l)return this.makeVerticalOpts(t,e,i,r,o,n,s);var d=function(t){if(t.length<=1)return[t];var e=t.replace(new RegExp(/(\r\n|\\n)/g),"\n").split("\n"),i=[];return e.forEach(function(t){for(;t.length>0;){var e=t.substring(0,1);if(/[\d|A-Za-z|_]/.test(e)){var r=t.replace(/^([\d|A-Za-z|_]+).*$/,"$1");t=t.replace(r,""),i.push(r)}else i.push(e),t=t.length>0?t.substring(1,t.length):""}i.push("\n")}),i.pop(),i}(t),f="",u=[];return d.forEach(function(t){var h=f+t,l=a.ctx.measureText(h).width;if("\n"===t)u.push(a.newLine(f,e,i,r,o,n,s)),f="",i+=n;else if(l<=r)f=h;else if(""!==f&&(u.push(a.newLine(f,e,i,r,o,n,s)),f="",i+=n),a.ctx.measureText(t).width/r>1)for(var c=(""+t).split(""),d=0;d<c.length;d++){var p=f+c[d];a.ctx.measureText(p).width>=r?(""!==f&&(u.push(a.newLine(f,e,i,r,o,n,s)),i+=n),f=c[d]):f=p}else f=t}),u.push(this.newLine(f,e,i,r,o,n,s)),u},t}();function Vn(t,e){return void 0===e&&(e={}),function(t,e){var i=a("canvas","sheet-table-canvas"),r=t.offset(),o=e.width,n=void 0===o?r.width:o,s=e.height,h=void 0===s?r.height:s,l=i.el;t.children(l);var c=C();return l.width=n*c,l.height=h*c,i.offset({width:n,height:h}),new qn(l,e)}(t,e)}function Un(t,e,i,r,o){function n(t,e,i,r,o){void 0===o&&(o=0),o=o*Math.PI/180;var n=Math.cos,s=Math.sin;return[(t-i)*n(o)-(e-r)*s(o)+i,(t-i)*s(o)+(e-r)*n(o)+r]}if(o.rotate){var s=o.center,a=s[0],h=s[1],l=n(t,e,a,h,o.rotate),c=n(i,r,a,h,o.rotate);t=l[0],e=l[1],i=c[0],r=c[1]}return{type:"line",x:t,y:e,x1:i,y1:r,options:o}}function $n(t,e,i){var r=t.getStyle();!function(t,e,i){var r=t.backgroundColor&&!t.backgroundColor.isTransparent(),o=t.backgroundImage&&t.backgroundSize,n={};if(r&&(n={type:"rect",x:t.left,y:t.top,width:t.width,height:t.height,options:{fillColor:t.backgroundColor.toString()}}),o){var s=Hn(t.backgroundImage);s?n={type:"image",x:t.left,y:t.top,width:t.width,height:t.height,image:s,imageLayout:t.backgroundSize}:On(t.backgroundImage).then(Yo(function(){i()}))}e.draw(n)}(r,e,i),function(t,e){var i=t.top,r=t.left,o=t.width,n=t.height,s=[r+o/2,i+n/2],a=[];t.borderTopStyle&&!t.borderTopColor.isTransparent()&&a.push(Un(r,i,r+o,i,{color:t.borderTopColor.toString(),lineWidth:t.borderTopWidth,lineStyle:t.borderTopStyle,rotate:t.rotate,center:s})),t.borderBottomStyle&&!t.borderBottomColor.isTransparent()&&a.push(Un(r,i+n,r+o,i+n,{color:t.borderBottomColor.toString(),lineWidth:t.borderBottomWidth,lineStyle:t.borderBottomStyle,rotate:t.rotate,center:s})),t.borderLeftStyle&&!t.borderLeftColor.isTransparent()&&a.push(Un(r,i,r,i+n,{color:t.borderLeftColor.toString(),lineWidth:t.borderLeftWidth,lineStyle:t.borderLeftStyle,rotate:t.rotate,center:s})),t.borderRightStyle&&!t.borderRightColor.isTransparent()&&a.push(Un(r+o,i,r+o,i+n,{color:t.borderRightColor.toString(),lineWidth:t.borderRightWidth,lineStyle:t.borderRightStyle,rotate:t.rotate,center:s})),a.forEach(function(t){t&&e.draw(t)})}(r,e)}function Kn(t){return t.props?t.props.overflowConfig:{}}function Jn(t,e,r){var o=t.getText();if(null!=o&&""!==o){var n=t.getStyle(),s=n.top,a=n.left,h=n.width,l=n.height,c=n.textAlign,d=n.verticalAlign,f=n.color;e.draw({type:"text",text:""+o,x:a,y:s,width:h,height:l,options:i(i(i({},n),{wrap:"wrap",textAlign:c||"center",verticalAlign:d||"middle",color:""+f,clip:!0}),Kn(t))},r)}}var Qn,Zn=function(){function t(t,e){var i=this;this.reRender=function(){i.renderGrid(),i.renderSequnce(),i.renderFreeze()},this.render=function(){i.renderStickers(),i.reRender()},this.refresh=function(){i.clear(),i.renderGrid()},this.resize=function(){i.renderer.resize(i.data.width+i.data.offset.offsetX,i.data.height+i.data.offset.offsetY)},this.debounceRender=Yo(function(){i.render()},50),this.el=a("div","sheet-table"),this.data=t,this.container=e,this.renderer=Vn(this.el,{width:t.width+t.offset.offsetX,height:t.height+t.offset.offsetY})}return t.prototype.renderSequnce=function(){var t=this,e=this.data.offset.offsetX,i=this.data.offset.offsetY;this.renderer.clear(0,0,this.data.width+e,i),this.renderer.clear(0,0,e,this.data.height+i);var r=this.data.getSequnceCells();this.clearBorderSet(),r.forEach(function(e){t.renderContent(e),t.renderBorder(e)}),this.clearBorderSet()},t.prototype.scroll=function(t,e){var i=this,r=Math.ceil(isNaN(e)?0:e),o=Math.ceil(isNaN(t)?0:t);if(o||r)if(o!==r&&(o===(r||o)||r===(o||r))){var n=this.data.getRenderBounds(r?"vertical":"horizontal"),s={x:Math.ceil(n.x),y:Math.ceil(n.y),width:Math.ceil(n.width),height:Math.ceil(n.height)},a=this.getReRenderBounds(o,r,s),h=a.cacheBounds,l=a.canvasBounds,c=a.renderBounds;this.clip(s.x,s.y,s.width,s.height,function(){i.drawSelf(h.x,h.y,l.x,l.y,l.width,l.height),i.clip(c.x,c.y,c.width,c.height,function(){i.clear(),i.rerenderBounds(c.x,c.y,c.width,c.height)})}),this.renderSequnce(),this.renderFreeze()}else this.reRender()},t.prototype.getReRenderBounds=function(t,e,i){var r,o,n;if(e<0&&(r={x:i.x,y:i.y,width:i.width,height:i.height+e},o={x:i.x,y:i.y-e,width:i.width,height:i.height+e},n={x:i.x,y:i.y,width:i.width,height:i.height-o.height+1}),e>0){var s=ae(i.width-i.x,0,i.width),a=ae(i.height-i.y-e,0,i.height);r={x:i.x,y:i.y+e,width:s,height:a},o={x:i.x,y:i.y,width:s,height:a},n={x:i.x,y:o.y+o.height,width:i.width,height:i.height-o.height}}if(t<0&&(r={x:i.x,y:i.y,width:i.width+t,height:i.height},o={x:i.x-t,y:i.y,width:i.width+t,height:i.height},n={x:i.x,y:i.y,width:i.width-o.width+1,height:i.height}),t>0){s=ae(i.width-i.x-t,0,i.width),a=ae(i.height-i.y,0,i.height);r={x:i.x+t,y:i.y,width:s,height:a},n={x:(o={x:i.x,y:i.y,width:s,height:a}).x+o.width,y:i.y,width:i.width-o.width,height:i.height}}return{cacheBounds:r,canvasBounds:o,renderBounds:n}},t.prototype.clip=function(t,e,i,r,o){var n=this.data.offset,s=n.offsetX,a=n.offsetY;this.renderer.clip(t+s,e+a,i,r,o)},t.prototype.clear=function(t,e,i,r){var o=this.data.offset,n=o.offsetX,s=o.offsetY;this.renderer.clear(t&&t+n,e&&e+s,i,r)},t.prototype.drawSelf=function(t,e,i,r,o,n){var s=this.data.offset,a=s.offsetX,h=s.offsetY;this.renderer.drawSelf(t+a,e+h,i+a,r+h,o,n)},t.prototype.renderFreeze=function(){var t=this;this.data.getFreezeBounds().forEach(function(e){var i=e.x,r=e.y,o=e.width,n=e.height;if(o>0&&n>0){var s=t.data.getCellsInBounds(i,r,o,n);t.clip(i,r,o,n,function(){t.clear(),s.forEach(function(e){t.renderContent(e)})}),t.clip(i,r,o+1,n+1,function(){t.clearBorderSet(),s.forEach(function(e){t.renderBorder(e)})})}})},t.prototype.rerenderBounds=function(t,e,i,r){var o=this;this.data.spliteBounds(t,e,t+i,e+r).forEach(function(t){var e=t.x,i=t.y,r=t.width,n=t.height;r<=0||n<=0||o.clip(e,i,r,n,function(){var t=o.data.getCellsInBounds(e,i,r,n);t.forEach(function(t){o.renderContent(t)}),o.clearBorderSet(),t.forEach(function(t){o.renderBorder(t)})})}),this.clearBorderSet()},t.prototype.clearBorderSet=function(){this.cacheBorderSet=new Set,this.cacheBorderPosition=new Set},t.prototype.renderGrid=function(){this.clear(0,0,this.data.width,this.data.height),this.rerenderBounds(0,0,this.data.width,this.data.height)},t.prototype.renderContent=function(t){t.ci<this.data.view.colc&&t.ri<this.data.view.rowc&&this.renderCellComponent(t)},t.prototype.renderCell=function(t){var e=this,r=i(i({},t),this.data.correctBounds(t)),o=this.data.getQuadrantBounds(t.x,t.y),n=this.data.getCell(t.ri+t.rp+1,t.ci);n=i(i(i({},n),this.data.correctBounds(n)),{borderStyle:n.borderStyle?{borderTop:n.borderStyle.borderTop}:{}});var s=this.data.getCell(t.ri,t.ci+t.cp+1);s=i(i(i({},s),this.data.correctBounds(s)),{borderStyle:s.borderStyle?{borderTop:s.borderStyle.borderLeft}:{}}),this.clip(o.x,o.y,o.width,o.height,function(){e.clear(r.x,r.y,r.width,r.height),e.renderContent(r),e.renderCellBorder(r),e.renderCellBorder(n),e.renderCellBorder(s)})},t.prototype.renderBorder=function(t){t.ci<this.data.view.colc&&t.ri<this.data.view.rowc&&this.renderCellBorder(t)},t.prototype.renderCellComponent=function(t){var e=this,r=t.width,o=t.height;if(0!==r&&0!==o){t.x+=this.data.offset.offsetX,t.y+=this.data.offset.offsetY;var n=[];this.renderCellBg(t),t.stick?this.container.stickCell(t.ri,t.ci,t.init):function(t,e,i,r){for(var o=[c(t)];o.length>0;){var n=o.shift();n&&($n(n,e,i),Jn(n,e,r),o=o.concat(n.getChildren()||[]))}}(t,this.renderer,this.debounceRender,function(r){var o=e.data.view.getViewData();if(o[t.ri]&&o[t.ri][t.ci]){var s=o[t.ri][t.ci],a=i(i({},r),{x:r.x-t.x,y:r.y-t.y});n.push(a),s.textArea=n}})}},t.prototype.renderCellBorder=function(t){var e,i=t.borderStyle,r=void 0===i?{}:i,o=null===(e=null==t?void 0:t.backgroundStyle)||void 0===e?void 0:e.backgroundColor,n=t.x,s=t.y,a=t.width,h=t.height;if(!(a<=0||h<=0)){var l=r.borderTop,c=r.borderLeft,d=r.borderBottom,f=r.borderRight;this.renderCellBorderLine(n,s,n+a,s,l,o),this.renderCellBorderLine(n,s+h,n+a,s+h,d,o),this.renderCellBorderLine(n,s,n,s+h,c,o),this.renderCellBorderLine(n+a,s,n+a,s+h,f,o)}},t.prototype.renderCellBorderLine=function(t,e,i,r,o,n){var s=t+"-"+e+"-"+i+"-"+r;if((null==o?void 0:o.width)>0){var a=t+"-"+e+"-"+i+"-"+r+"-"+o.width+"-"+o.color;this.cacheBorderSet.has(a)||(this.renderer.drawLine(t,e,i,r,{color:o.color,lineWidth:o.width,lineStyle:o.style,lineDash:o.dash}),this.cacheBorderSet.add(a),this.cacheBorderPosition.add(s))}else if(n&&!this.cacheBorderSet.has(s)){var h=!1;this.cacheBorderSet.forEach(function(o){if(!h){var n=o.split("-"),s=n[0],a=n[1],l=n[2],c=n[3],d=n[4],f=Math.floor(1e4*Number(s))/1e4,u=Math.floor(1e4*Number(a))/1e4,p=Math.floor(1e4*Number(l))/1e4,g=Math.floor(1e4*Number(c))/1e4,v=Math.floor(1e4*t)/1e4,y=Math.floor(1e4*e)/1e4,w=Math.floor(1e4*i)/1e4,b=Math.floor(1e4*r)/1e4;h=rn(f,u,p,g,v,y)&&rn(f,u,p,g,w,b)||rn(t,e,i,r,f,u)&&rn(t,e,i,r,p,g);var m=rn(f,u,p,g,v,y),x=rn(f,u,p,g,w,b);m&&!x&&u===g&&b!==g&&(e+=~~d),!m&&x&&u===g&&y!==g&&(r-=~~d),m&&!x&&f===p&&w!==p&&(t+=~~d),!m&&x&&f===p&&v!==p&&(i-=~~d)}}),h||this.renderer.drawLine(t,e,i,r,{color:n,lineWidth:1,lineStyle:"solid",lineDash:[]})}},t.prototype.renderCellBg=function(t){var e=t.bias,i=t.style,r=void 0===i?{}:i,o=t.backgroundStyle,n=void 0===o?{}:o,s=t.currencyLineAttr,a=t.value,h=t.x,l=t.y,c=t.width,d=t.height;if(!(c<=0||d<=0)){var f=n.backgroundColor,u=n.backgroundImage,p=n.linearGradient,g=n.backgroundImageLayout;if(p)this.renderer.drawRect(h,l,c,d,{linearGradient:p,radiusConfig:n.radiusConfig});else if(u){var v=Hn(u);v?this.renderer.drawImage(v,h,l,c,d,g,{radiusConfig:n.radiusConfig}):On(u).then(this.debounceRender)}else f&&this.renderer.drawRect(h,l,c,d,{fillColor:f,radiusConfig:n.radiusConfig});e&&this.renderer.drawBias(h,l,c,d,e.backslash,e.texts,r),s&&this.renderer.drawCurrencyLine(h,l,c,d,s,a,r)}},t.prototype.renderStickers=function(){var t=this;this.data.getStickers().forEach(function(e){"delete"===e.tag?t.container.tearSticker(e.id):t.container.stick(e,e.init)})},t}(),ts=function(){function t(){this.eventMap={}}return t.prototype.on=function(t,e){this.eventMap[t]=this.eventMap[t]||[],this.eventMap[t].push(e)},t.prototype.off=function(t,e){this.eventMap[t]=this.eventMap[t]||[];var i=this.eventMap[t].indexOf(e);-1!==i&&this.eventMap[t].splice(i,i)},t.prototype.emit=function(t,e){void 0===e&&(e=[]),this.eventMap[t]&&this.eventMap[t].forEach(function(t){t.call.apply(t,n([null],e))})},t}();!function(t){t[t.WHEELMODE_FOCUS=0]="WHEELMODE_FOCUS",t[t.WHEELMODE_WHEEL=1]="WHEELMODE_WHEEL"}(Qn||(Qn={}));var es={borderTop:!1,borderBottom:!1,borderLeft:!1,borderRight:!1},is=function(t){function r(e){var i=t.call(this)||this;i.focusMode=0,i.activeAreas=new Set,i.width=0,i.height=0;var r=e.width,o=void 0===r?0:r,n=e.height,s=void 0===n?0:n,h=e.scrollTop,l=void 0===h?0:h,c=e.scrollLeft,d=void 0===c?0:c,f=e.cls,u=void 0===f?"":f,p=e.totalWidth,g=e.totalHeight,v=e.top,y=void 0===v?0:v,w=e.left,b=void 0===w?0:w;return i.el=a("div","grid-container "+u),i.scrollTopDelta=0,i.scrollLeftDelta=0,i.scrollTop=l,i.scrollLeft=d,i.scrollEl=a("div","scrollable-grid"),i.scrollEl.offset({top:l,left:d,width:p||0,height:g||0}),i.width=o,i.height=s,i.el.offset({width:o,height:s,top:y,left:b}),i.on("wheelMode",function(t){i.focusMode=t}),i.el.el.onscroll=function(){i.el.el.clientHeight>0&&i.focusMode===Qn.WHEELMODE_FOCUS&&i.emit("focus",[i.el.el.scrollLeft,i.el.el.scrollTop])},i}return e(r,t),r.prototype.hideSelect=function(){},r.prototype.selectAreas=function(t,e){var i=this;this.checkScrollElMounted(),(t||[]).forEach(function(t){i.selectArea(i.createActiveArea(),t,e)})},r.prototype.selectArea=function(t,e,r){var o=t.p,n=t.c,s=t.t,a=t.b,h=t.l,l=t.r,c=i(i({},es),r),d=c.borderLeft,f=c.borderTop,u=c.borderRight,p=c.borderBottom;!e||e.x<0||e.y<0||e.width<=0||e.height<=0?o.hide():(o.css({position:"absolute",top:e.y+"px",left:e.x+"px",width:"0px",height:"0px"}),n.offset({width:e.width,height:e.height}),s.offset({top:0,left:0,width:e.width}),s.css({display:f?"block":"none"}),a.offset({top:e.height,left:0,width:e.width}),a.css({display:p?"block":"none"}),h.offset({top:0,left:0,height:e.height}),h.css({display:d?"block":"none"}),l.offset({top:0,left:e.width,height:e.height}),l.css({display:u?"block":"none"}),o.show())},r.prototype.hideSelectAreas=function(){this.activeAreas.forEach(function(t){[t.p,t.c,t.t,t.l,t.r,t.b].forEach(function(t){t&&(t.hide(),t.remove())})}),this.activeAreas.clear()},r.prototype.scroll=function(t,e){void 0===t&&(t=this.scrollLeftDelta),void 0===e&&(e=this.scrollTopDelta),this.scrollTopDelta=e,this.scrollLeftDelta=t,this.el.scroll({top:Math.abs(e+this.scrollTop),left:Math.abs(t+this.scrollLeft)})},r.prototype.createActiveArea=function(){var t=a("div"),e=a("div","active-area"),i=a("div","range-border active-area-border"),r=a("div","range-border active-area-border"),o=a("div","range-border active-area-border"),n=a("div","range-border active-area-border");t.children(e,i,n,r,o),this.scrollEl.children(t);var s={p:t,c:e,t:i,l:r,r:o,b:n};return this.activeAreas.add(s),s},r.prototype.offset=function(t){var e=t.width,i=void 0===e?0:e,r=t.height,o=void 0===r?0:r,n=t.scrollTop,s=void 0===n?0:n,a=t.scrollLeft,h=void 0===a?0:a,l=t.left,c=void 0===l?0:l,d=t.top,f=void 0===d?0:d;this.width=i,this.height=o,this.el.offset({width:i,height:o,left:c,top:f}),this.scrollTop=s,this.scrollLeft=h,this.scroll()},r.prototype.updateScrollEl=function(t){var e=t.totalWidth,i=t.totalHeight,r=t.top,o=void 0===r?0:r,n=t.left,s=void 0===n?0:n;this.scrollEl.offset({width:e,height:i,top:o,left:s})},r.prototype.stick=function(t){var e=t.top,i=t.left,r=t.el;this.checkScrollElMounted(),this.el.removeClass("empty"),this.scrollEl.children(r),a(r).offset({top:e,left:i})},r.prototype.isStickerInRange=function(t){return qo(t.top-this.scrollTop,-.25*this.height,1.25*this.height)&&qo(t.left-this.scrollLeft,-.25*this.width,1.25*this.width)},r.prototype.checkScrollElMounted=function(){this.el.hasChild(this.scrollEl.el)||(this.el.children(this.scrollEl),0===this.scrollLeftDelta&&0===this.scrollTopDelta||this.scroll())},r}(ts),rs=function(t){function i(e){var i,r,o,n=t.call(this)||this;return n.el=a("div","grid-container"),/(msie|trident)/i.test(navigator.userAgent.toLowerCase())&&(i=navigator.userAgent.toLowerCase(),r=i.match(/(?:msie\s([\w.]+))/),o=i.match(/(?:trident.*rv:([\w.]+))/),(r&&o&&r[1]&&o[1]?Math.max(1*parseInt(r[1],10),1*parseInt(o[1],10)):r&&r[1]?1*parseInt(r[1],10):o&&o[1]?1*~~o[1]:0)<=10)&&n.el.addClass("ie10-below"),n.stickers={},n.digest(e),n.render(),n}return e(i,t),i.prototype.render=function(){var t=this,e=this.width-this.freezeWidth,i=this.height-this.freezeHeight;this.tGrid=new is({cls:"grid-container-top t-grid",width:this.width,height:this.freezeHeight}),this.bGrid=new is({cls:"grid-container-bottom b-grid",width:this.width,height:i,top:this.freezeHeight}),this.tlGrid=new is({cls:"inline-grid tl-grid",width:this.freezeWidth,height:this.freezeHeight}),this.trGrid=new is({cls:"inline-grid tr-grid",width:e,height:this.freezeHeight,scrollLeft:-this.freezeWidth,totalWidth:this.totalWidth,totalHeight:this.freezeHeight,left:this.freezeWidth}),this.blGrid=new is({cls:"inline-grid bl-grid",width:this.freezeWidth,height:i,scrollTop:-this.freezeHeight,totalWidth:this.freezeWidth,totalHeight:this.totalHeight}),this.brGrid=new is({cls:"inline-grid br-grid",width:e,height:i,scrollLeft:-this.freezeWidth,scrollTop:-this.freezeHeight,totalWidth:this.totalWidth,totalHeight:this.totalHeight,left:this.freezeWidth}),this.mountGrid(),this.on("wheelMode",function(e){t.brGrid.emit("wheelMode",[e]),t.blGrid.emit("wheelMode",[e]),t.trGrid.emit("wheelMode",[e])}),this.brGrid.on("focus",function(e,i){t.emit("focus",[e,i])}),this.trGrid.on("focus",function(e){t.emit("focus",[e])}),this.blGrid.on("focus",function(e,i){t.emit("focus",[void 0,i])})},i.prototype.showSelectArea=function(t){var e=this;this.hideSelectArea(),t.forEach(function(t){e.tlGrid.selectAreas([t[0]]),e.trGrid.selectAreas([t[1]]),e.blGrid.selectAreas([t[2]]),e.brGrid.selectAreas([t[3]])})},i.prototype.hideSelectArea=function(){this.tlGrid.hideSelectAreas(),this.trGrid.hideSelectAreas(),this.blGrid.hideSelectAreas(),this.brGrid.hideSelectAreas()},i.prototype.scroll=function(t,e){this.trGrid.scroll(t,0),this.blGrid.scroll(0,e),this.brGrid.scroll(t,e)},i.prototype.getGrids=function(){return[this.tlGrid,this.trGrid,this.blGrid,this.brGrid]},i.prototype.update=function(t){this.digest(t);var e=this.width-this.freezeWidth,i=this.height-this.freezeHeight;this.tGrid.offset({width:this.width,height:this.freezeHeight}),this.bGrid.offset({width:this.width,height:i,top:this.freezeHeight}),this.tlGrid.offset({width:this.freezeWidth,height:this.freezeHeight}),this.trGrid.updateScrollEl({totalWidth:this.totalWidth,totalHeight:this.freezeHeight,left:-this.freezeWidth}),this.trGrid.offset({width:e,height:this.freezeHeight,left:this.freezeWidth}),this.blGrid.updateScrollEl({totalWidth:this.freezeWidth,totalHeight:this.totalHeight,top:-this.freezeHeight}),this.blGrid.offset({width:this.freezeWidth,height:i}),this.brGrid.updateScrollEl({totalWidth:this.totalWidth,totalHeight:this.totalHeight,top:-this.freezeHeight,left:-this.freezeWidth}),this.brGrid.offset({width:e,height:i,left:this.freezeWidth}),this.mountGrid()},i.prototype.digest=function(t){var e=t.width,i=t.height,r=t.freezeWidth,o=t.freezeHeight,n=t.totalWidth,s=t.totalHeight;this.width=e,this.height=i,this.freezeWidth=r,this.freezeHeight=o,this.totalWidth=n,this.totalHeight=s},i.prototype.getResponseGrid=function(t,e){return t<this.freezeWidth&&e<this.freezeHeight?this.tlGrid:t>=this.freezeWidth&&e<this.freezeHeight?this.trGrid:t<this.freezeWidth&&e>=this.freezeHeight?this.blGrid:this.brGrid},i.prototype.stick=function(t){var e=t.left,r=t.top,o=t.width,n=t.height,s=t.el,h=t.id,l=void 0===h?Io():h,c=t.lazy,d=this.getResponseGrid(e,r),f=a("div",i.STICKER_CONTAINER_CLASS_NAME);f.offset({width:o,height:n}),this.stickers[l]=f,s&&(Z(s)?s.call(null,f):f.html(s));var u={id:l,left:e,top:r,width:o,height:n,el:f.el},p=d.isStickerInRange(u);function g(){d.stick(u)}return!c&&g(),{id:l,mount:c?g:void 0,isInRange:p}},i.prototype.updateStick=function(t){var e=t.left,i=t.top,r=t.width,o=t.height,n=t.id,s=this.getResponseGrid(e,i);return this.stickers[n]&&s.stick({id:n,left:e,top:i,width:r,height:o,el:this.stickers[n].el}),""},i.prototype.tear=function(t){this.stickers[t]&&(this.stickers[t].remove(),delete this.stickers[t])},i.prototype.getStick=function(t){return this.stickers[t]},i.prototype.clean=function(){for(var t=0,e=Object.entries(this.stickers);t<e.length;t++){e[t][1].remove()}this.stickers={}},i.prototype.mountGrid=function(){this.freezeWidth||this.freezeHeight?(this.tGrid.el.children(this.tlGrid.el,this.trGrid.el),this.bGrid.el.children(this.blGrid.el,this.brGrid.el),this.el.children(this.tGrid.el,this.bGrid.el)):(this.bGrid.el.children(this.brGrid.el),this.el.children(this.bGrid.el))},i.STICKER_CONTAINER_CLASS_NAME="waffle-borderless-sticker",i}(ts),os=function(){function t(t){this.isOver=!1,this.autoShow=!0,this.minScrollBarLength=24,this.direction=t.direction,this.state=!1,this.position=0,this.startPosition=0,this.size=t.size,this.scrollSize=t.scrollSize,this.sliderSize=this.getScrollBarLength(),this.startTrigger=t.startScroll||Jo,this.scrollTrigger=t.onScoll||Jo,this.endTrigger=t.endScroll||Jo,this.el=a("div","sheet-scrollbar sheet-scrollbar-"+(this.vertical()?"y":"x")),this.sliderEl=a("div","sheet-scrollbar-slider"),this.el.css(this.vertical()?"height":"width",k(t.size)),this.sliderEl.css(this.vertical()?"height":"width",k(this.sliderSize)),this.el.children(this.sliderEl),this._initEvent(),this.sliderEl.hide(),this.checkScrollSize()}return t.prototype._initEvent=function(){var t=this;this.el.on("mousedown",function(t){t.preventDefault()}),this.el.on("mouseover",function(){t.isOver=!0,t.checkScrollSize(),t.sliderEl.show()}),this.el.on("mouseleave",function(){t.isOver=!1,!t.state&&t._resetTimeout()}),this.sliderEl.on("mousedown",function(e){t._startScroll(e),e.preventDefault()}),this.sliderEl.on("touchstart",function(e){t.state=!0,t.sliderEl.show(),t._startScroll(e.targetTouches[0])}),this.sliderEl.on("mousemove",function(e){t._scroll(e)}),this.sliderEl.on("touchmove",function(e){t._scroll(e.targetTouches[0])}),this.sliderEl.on("touchend",function(){t.state=!1,t._resetTimeout()}),document.addEventListener("mousemove",function(e){t._scroll(e)}),this.sliderEl.on("mouseup",function(e){t._endScroll(e)}),document.addEventListener("mouseup",function(e){t._endScroll(e)}),document.addEventListener("mouseleave",function(e){t._endScroll(e)})},t.prototype._startScroll=function(t){this.startPosition=this.vertical()?t.clientY:t.clientX,this.state=!0,this.el.addClass("active"),this.startTrigger()},t.prototype._scroll=function(t){if(this.state){this.moveOutside&&(this.vertical()?this.startPosition=this.startPosition+t.clientY-this.cachePosition:this.startPosition=this.startPosition+t.clientX-this.cachePosition,this.moveOutside=!1);var e=0,i=0;this.vertical()?(i=t.clientY-this.startPosition+this.position,this.startPosition=t.clientY):(e=t.clientX-this.startPosition+this.position,this.startPosition=t.clientX),e=Math.round(Math.max(0,Math.min(e,this.size-this.sliderSize))),i=Math.round(Math.max(0,Math.min(i,this.size-this.sliderSize)));var r=this.position;this.position=e||i;var o=(this.position-r)*this.scrollSize/(this.size-this.sliderSize);this._scrollTo(e,i),0===o&&this.adjustScroll(e,i),this.scrollTrigger(this.vertical()?0:o,this.vertical()?o:0)}},t.prototype.adjustScroll=function(t,e){var i=this.vertical()?e:t,r=this.vertical()?0:5,o=this.vertical()?5:0;0===i&&this.scrollTrigger(0-r,0-o),i===this.size-this.sliderSize&&this.scrollTrigger(r,o)},t.prototype._endScroll=function(t){this.state&&(this.state=!1,this.el.removeClass("active"),this._resetTimeout(),this.endTrigger(),t.preventDefault())},t.prototype._scrollTo=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.sliderEl.css({transform:"translate("+k(t)+", "+k(e)+")","-webkit-transform":"translate("+k(t)+", "+k(e)+")","-moz-transform":"translate("+k(t)+", "+k(e)+")","-o-transform":"translate("+k(t)+", "+k(e)+")","-ms-transform":"translate("+k(t)+", "+k(e)+")"})},t.prototype.checkScrollSize=function(){this.autoShow&&(this.scrollSize<=0?this.el.hide():this.el.show())},t.prototype.vertical=function(){return"vertical"===this.direction},t.prototype.inScrollBounds=function(t){var e=this.sliderSize/2,i=this.size-this.sliderSize/2,r=this.vertical()?t.clientY:t.clientX;return r>=e&&r<=i},t.prototype._resetTimeout=function(){this.timer&&window.clearTimeout(this.timer),this.timer=this.sliderElHide()},t.prototype.scroll=function(t,e){void 0===e&&(e=!0),!this.isOver&&this.scrollSize>0&&e&&(this.sliderEl.show(),this._resetTimeout()),t=t*(this.size-this.sliderSize)/this.scrollSize;var i=this.vertical()?0:t,r=this.vertical()?t:0;this.position=t,this._scrollTo(i,r)},t.prototype.update=function(t){this.state=!1,this.startPosition=0,this.size=t.size,this.scrollSize=t.scrollSize,this.sliderSize=this.getScrollBarLength();var e=this.vertical()?0:Math.min(this.position,this.size-this.sliderSize),i=this.vertical()?Math.min(this.position,this.size-this.sliderSize):0;this.position=e||i,this.el.css(this.vertical()?"height":"width",k(t.size)),this.sliderEl.css(this.vertical()?"height":"width",k(this.sliderSize)),this._scrollTo(e,i),this.scrollTrigger(0,0,{force:!0}),this.checkScrollSize(),this.sliderEl.hide()},t.prototype.getScrollBarLength=function(){var t=Math.round(Math.pow(this.size,2)/(this.scrollSize+this.size));return this.size<this.minScrollBarLength?t:Math.max(t,this.minScrollBarLength)},t.prototype.setVisible=function(t){t?this.el.show():this.el.hide(),t?this.sliderEl.show():this.sliderEl.hide(),this.autoShow=!1},t.prototype.sliderElHide=function(){var t=this;return window.setTimeout(function(){!t.state&&t.autoShow&&t.sliderEl.hide()},5e3)},t}(),ns=!1,ss=function(){function t(t){var e=this;this.onMouseDown=function(t){t.preventDefault(),t.stopPropagation(),ns=!0,e.prevX=0,e.prevY=0,e.distance=0,e.lineEl.show(),window.addEventListener("mousemove",e.onMouseMove),window.addEventListener("mouseup",e.onMouseUp)},this.onMouseMove=function(t){if(t.preventDefault(),t.stopPropagation(),ns){var i=e,r=i.prevX,o=i.prevY,n=i.min,s=i.max,a=r?t.screenX-r:0,h=o?t.screenY-o:0;e.prevX=t.screenX,e.prevY=t.screenY,"vertical"===e.direction?(e.distance+=a,e.el.css("margin-left",ae(e.distance,n,s)+"px")):(e.distance+=h,e.el.css("margin-top",ae(e.distance,n,s)+"px")),t.preventDefault()}},this.onMouseUp=function(t){if(t.preventDefault(),t.stopPropagation(),ns){ns=!1,e.lineEl.hide();var i=parseFloat(e.el.css("margin-left"))||parseFloat(e.el.css("margin-top"));e.onResize&&e.onResize(e.rect,i,e.direction),e.el.css("margin-left","0px"),e.el.css("margin-top","0px"),e.distance=0,e.hide()}window.removeEventListener("mousemove",e.onMouseMove),window.removeEventListener("mouseup",e.onMouseUp)};var i=t.direction,r=void 0===i?"vertical":i,o=t.onResize;this.direction=r,this.onResize=o,this.el=a("div","sheet-resizer "+r),this.hoverEl=a("div","sheet-resizer-hover"),this.lineEl=a("div","sheet-resizer-line"),this.el.children(this.hoverEl,this.lineEl),this.lineEl.hide(),this.hoverEl.on("mousedown",this.onMouseDown)}return t.prototype.show=function(t,e,i){if(!ns){this.rect=t;var r=t.left,o=t.top,n=t.width,s=t.height,a="vertical"===this.direction,h=i.min,l=void 0===h?-1/0:h,c=i.max,d=void 0===c?1/0:c;this.min=l,this.max=d,this.el.offset({left:a?r+n-5:r,top:a?o:o+s-5}).show();var f=a?5:n,u=a?s:5;this.hoverEl.offset({width:f,height:u}),this.lineEl.offset({top:a?s:3,left:a?3:n,width:e.width,height:e.height})}},t.prototype.hide=function(){ns||this.el.offset({width:0,height:0}).hide()},t}(),as=function(){function t(){this.el=a("div","sheet-tooltip"),this.hideEl(),this.isShow=!1,document.body.appendChild(this.el.el)}return t.prototype.show=function(t,e,i){var r=this,o=i+10,n=e+10;this.el.text(t);var s=this.el.el.clientWidth,a=this.el.el.clientHeight;if(a>window.innerHeight){var h=e-10,l=window.innerWidth-e-10;h>l?(this.el.css("max-width",h+"px"),n=0):(this.el.css("max-width",l+"px"),n=e+10),o=i+10-(a=this.el.el.clientHeight)}else window.innerHeight-i<=a&&(o-=a+15),window.innerWidth-e<=s&&(n-=s+10);o=Math.max(o,0),n=Math.max(n,0),this.el.offset({left:n,top:o}),this.isShow||(this.isShow=!0,this.timeOut=setTimeout(function(){r.showEl()},900))},t.prototype.hide=function(){this.timeOut&&clearTimeout(this.timeOut),this.hideEl(),this.isShow=!1},t.prototype.showEl=function(){this.el.css("visibility","visible"),this.el.css("opacity","inherit")},t.prototype.hideEl=function(){this.el.css("visibility","hidden"),this.el.css("opacity","0")},t.prototype.tear=function(){document.body.removeChild(this.el.el)},t}(),hs=100,ls=function(t){function r(e,i){var r=t.call(this)||this;return r.stickerTimeouts=[],r.deltaXCache=0,r.deltaYCache=0,r.sync=!1,r.getPointByClient=function(t,e){return{x:t,y:e}},r.previousPosition=null,r.onMouseDown=function(t){var e=r.getPointInfo(t),i=e.x,o=e.y,n=e.clientX,s=e.clientY,a=r.getActiveCell(i,o);if(null===a||a.stopPropagation)r.moving=0;else{var h=[a.ci,a.ri];if(r.moving=1,t.shiftKey){var l=r.data.selection.getRange()[0];r.emit("select",[l[1],l[0],h[1],h[0],{x:i,y:o}]),r.showSelectArea()}else{if(2===t.button){if(window.setTimeout(function(){r.emit("contextmenu",[n,s])},0),r.moving=0,Ko([h,h],r.data.getSelectRange()))return;return r.emit("select",[h[1],h[0],void 0,void 0,{x:i,y:o}]),void r.showSelectArea()}r.emit("select",[h[1],h[0],void 0,void 0,{x:i,y:o}]),r.data.view.doMouseDown(t,{x:i,y:o,ri:a.ri,ci:a.ci},r.data.getPositionByOffset(i,o))}}},r.onMouseMove=function(t){r.verticalScrollBar.scroll(r.data.scroll.y),r.horizontalScrollBar.scroll(r.data.scroll.x);var e=r.getPointInfo(t),i=e.x,o=e.y,n=e.clientX,s=e.clientY;if(n<=0&&s<=0)r.data.view.disHover();else{if(i<r.data.offset.offsetX||o<r.data.offset.offsetY){var a=r.data.getResizerCell(i,o);o>r.data.offset.offsetY&&(r.verticalResizer.hide(),r.horizontalResizer.show(a,{width:r.data.width,height:2},{min:-a.height})),i>r.data.offset.offsetX&&(r.verticalResizer.show(a,{width:2,height:r.data.height},{min:-a.width}),r.horizontalResizer.hide())}else{r.horizontalResizer&&r.horizontalResizer.hide(),r.verticalResizer&&r.verticalResizer.hide();var h=r.getActiveCell(i,o),l=r.data.getPositionByOffset(i,o);if(null===h)return null!==r.previousPosition&&(r.data.view.doMouseLeave(t,{x:i,y:o,ri:r.previousPosition.ri,ci:r.previousPosition.ci},l),r.previousPosition=null),r.toolTip.hide(),r.setMouseCursorByEvent(t,"default"),void r.data.view.disHover();var c={ri:h.ri,ci:h.ci};if(Pr(r.previousPosition,c)||null===r.previousPosition||r.data.view.doMouseLeave(t,{x:i,y:o,ri:r.previousPosition.ri,ci:r.previousPosition.ci},l),r.previousPosition=c,r.moving){r.moving=2;var d=r.data.selection.getCell();r.emit("select",[d[1],d[0],h.ri,h.ci,{x:i,y:o}]),r.showSelectArea()}var f=r.data.view.getMergeCell(h.ri,h.ci);r.data.view.doHover(t,{x:i,y:o,ri:h.ri,ci:h.ci},l);var u=r.data.offset2Absolute({x:i,y:o},f),p=u.x,g=u.y;r.data.view.isHoverText(f,p,g)&&(f.cursor&&"default"!==f.cursor?r.setMouseCursorByEvent(t,f.cursor):r.setMouseCursorByEvent(t,"text")),f.title?r.toolTip.show(f.title,n,s):r.toolTip.hide()}r.emit("hover",[i,o])}},r.onMouseleave=function(){r.toolTip.hide()},r.onDoubleClick=function(t){r.setWheelMode(Qn.WHEELMODE_FOCUS);var e=r.getPointInfo(t),i=e.x,o=e.y,n=r.getActiveCell(i,o),s=r.data.getSelectCell();r.isDoubleClickable(i,o,s)||(r.emit("dblclick",[i,o]),r.data.view.doDbClick(t,{x:i,y:o,ri:n.ri,ci:n.ci},r.data.getPositionByOffset(i,o)))},r.onMouseUp=function(t){r.setWheelMode(Qn.WHEELMODE_FOCUS);var e=r.getPointInfo(t),i=e.x,o=e.y,n=r.getActiveCell(i,o),s=r.data.selection.getCell();if(n&&(1===r.moving||2===r.moving&&n.ri===s[1]&&n.ci===s[0])&&!t.shiftKey&&2!==t.button){if(null===n||n.stopPropagation)return void(r.moving=0);2!==r.moving&&r.hideSelectArea(),r.data.view.doClick(t,{x:i,y:o,ri:n.ri,ci:n.ci},r.data.getPositionByOffset(i,o))}else 0===r.moving&&(t.currentTarget===document||n||r.hideSelectArea());r.moving=0},r.resizeHandler=function(t,e,i){r.emit("resize",[t,e,i]),r.resize()},r.scrollHandler=function(t,e,i){if(void 0===i&&(i={smooth:!1,force:!1}),0===t&&0===e&&!i.force)return!0;r.hideSelectArea(),r.scrollTimeout&&clearTimeout(r.scrollTimeout),i.smooth&&(t=Math.min(t,hs),e=Math.min(e,hs));var o=r.data.getScroll(),n=o.x,s=o.y,a=t,h=e;t+=r.deltaXCache,e+=r.deltaYCache;var l=r.data.correctDeltaX(t),c=r.data.correctDeltaY(e);l=a>0?Math.max(0,l):Math.min(0,l),c=h>0?Math.max(0,c):Math.min(0,c),r.deltaXCache=t-l,r.deltaYCache=e-c,r.scrollTimeout=setTimeout(function(){r.deltaXCache=0,r.deltaYCache=0,r.showSelectArea()},300);var d=Math.round(ae(n+l,0,r.data.maxScrollX)),f=Math.round(ae(s+c,0,r.data.maxScrollY));return(d===r.data.maxScrollX&&t>0||0===d&&t<0)&&(r.deltaXCache=0),(f===r.data.maxScrollY&&e>0||0===f&&e<0)&&(r.deltaYCache=0),Math.abs(l)>Math.abs(c)?r.emit("scroll",[d,"horizontal"]):r.emit("scroll",[f,"vertical"]),r.waffle.scroll(-d,-f),!(Math.abs(l)>Math.abs(c)?d<=0||d>=r.data.maxScrollX:f<=0||f>=r.data.maxScrollY)||0!==r.deltaXCache||0!==r.deltaYCache},r.el=a("div","grid-container"),r.data=e,r.cellCache=new Set,r.moving=0,r.sync=i.sync||!1,i.getPointByClient&&(r.getPointByClient=i.getPointByClient),r.supportCSSTransform=i.supportCSSTransform,r.initResizer(),r.initWaffle(),r.initScrollbar(),r.initTootip(),r.initEvent(),r}return e(r,t),r.prototype.correctBounds=function(t){return i(i({},t),{x:t.x+this.data.offset.offsetX,y:t.y+this.data.offset.offsetY})},r.prototype.resize=function(){this.waffle.update({width:this.data.width+this.data.offset.offsetX,height:this.data.height+this.data.offset.offsetY,freezeWidth:this.data.view.freezeWidth+this.data.offset.offsetX,freezeHeight:this.data.view.freezeHeight+this.data.offset.offsetY,totalWidth:this.data.view.totalWidth,totalHeight:this.data.view.totalHeight}),this.showSelectArea(),this.updateStickCells(),this.updateScrollBar(),this.whellScroll(0,0)},r.prototype.reset=function(){this.resize(),this.clean()},r.prototype.stick=function(t,e){var i=this,r=t.id;if(this.cellCache.has(t.id))this.waffle.updateStick(t);else if(t.width>0&&t.height>0){t.left=t.left+this.data.offset.offsetX,t.top=t.top+this.data.offset.offsetY;var o=this.waffle.stick(t),n=o.id,s=o.mount,a=o.isInRange;if(this.cellCache.add(n),Z(e)){if(this.sync)return e(this.waffle.getStick(n),t.width,t.height,s,a),r;var h=window.setTimeout(function(){e(i.waffle.getStick(n),t.width,t.height,s,a)});this.stickerTimeouts.push(h)}}return r},r.prototype.tearSticker=function(t){this.waffle.tear(t)},r.prototype.tear=function(){this.toolTip.tear()},r.prototype.stickCell=function(t,e,i){var r=t+"-"+e,o=this.data.view.getMergeCell(t,e),n=o.el,s=o.width,a=o.height,h=o.x,l=o.y;return this.stick({el:n,width:s,height:a,left:h,top:l,id:r},i),r},r.prototype.whellScroll=function(t,e){var i=this.data.getScroll(),r=i.x,o=i.y,n=Math.round(ae(r+t,0,this.data.maxScrollX)),s=Math.round(ae(o+e,0,this.data.maxScrollY));return this.scrollHandler(t,e,{smooth:!1,force:!1}),this.verticalScrollBar.scroll(this.data.scroll.y,!1),this.horizontalScrollBar.scroll(this.data.scroll.x,!1),{scrollX:n,scrollY:s,maxScrollX:this.data.maxScrollX,maxScrollY:this.data.maxScrollY}},r.prototype.updateStickCells=function(){var t=this;this.cellCache.forEach(function(e){var i=e.split("-"),r=i[0],o=i[1];t.stickCell(~~r,~~o)})},r.prototype.setWheelMode=function(t){this.waffle.emit("wheelMode",[t])},r.prototype.initEvent=function(){var t=this;this.waffle.el.on("mouseover",function(){t.mountResizer(),t.mountScrollbar()}),this.waffle.el.on("contextmenu",function(t){return t.preventDefault()}),this.waffle.el.on("mousedown",this.onMouseDown),this.waffle.el.on("mouseup",this.onMouseUp),this.waffle.el.on("mousemove",this.onMouseMove),this.waffle.el.on("dblclick",this.onDoubleClick),this.waffle.el.on("mouseleave",this.onMouseleave),this.waffle.el.on("wheel",function(e){var i,r;1===e.deltaMode?(i=20*e.deltaX,r=20*e.deltaY):(i=e.deltaX,r=e.deltaY),t.scrollHandler(i,r,{smooth:!0,force:!1})&&e.preventDefault(),t.verticalScrollBar.scroll(t.data.scroll.y),t.horizontalScrollBar.scroll(t.data.scroll.x)});var e=[0,0];this.waffle.el.on("touchstart",function(i){var r=t.getPointInfo(i),o=r.x,n=r.y;e=[o,n]}),this.waffle.el.on("touchmove",function(i){var r=e[0],o=e[1],n=t.getPointInfo(i),s=n.x,a=n.y;e=[s,a],t.scrollHandler(r-s,o-a,{smooth:!0,force:!1}),t.verticalScrollBar.scroll(t.data.scroll.y),t.horizontalScrollBar.scroll(t.data.scroll.x)}),this.waffle.el.on("mouseout",function(){t.data.view.disHover()}),document.addEventListener("mouseup",this.onMouseUp),an(this.waffle.el,function(){t.hideSelectArea()},!1),this.waffle.on("focus",function(e,i){t.focusHandler(e,i)})},r.prototype.initResizer=function(){this.verticalResizer=new ss({direction:"vertical",onResize:this.resizeHandler}),this.horizontalResizer=new ss({direction:"horizontal",onResize:this.resizeHandler})},r.prototype.initTootip=function(){this.toolTip=new as},r.prototype.initScrollbar=function(){var t=this.data.getViewBounds();this.verticalScrollBar=new os({direction:"vertical",size:t.height,scrollSize:this.data.maxScrollY,slider:{},onScoll:this.scrollHandler}),this.horizontalScrollBar=new os({direction:"horizontal",size:t.width,scrollSize:this.data.maxScrollX,slider:{},onScoll:this.scrollHandler})},r.prototype.mountResizer=function(){this.el.hasChild(this.verticalResizer.el.el)||this.el.hasChild(this.horizontalResizer.el.el)||this.el.children(this.verticalResizer.el,this.horizontalResizer.el)},r.prototype.mountScrollbar=function(){this.el.hasChild(this.verticalScrollBar.el.el)||this.el.hasChild(this.horizontalScrollBar.el.el)||(this.el.children(this.verticalScrollBar.el),this.el.children(this.horizontalScrollBar.el))},r.prototype.updateScrollBar=function(){var t=this.data.getViewBounds();this.verticalScrollBar.update({size:t.height,scrollSize:this.data.maxScrollY}),this.horizontalScrollBar.update({size:t.width,scrollSize:this.data.maxScrollX})},r.prototype.initWaffle=function(){var t=this.data.width+this.data.offset.offsetX,e=this.data.height+this.data.offset.offsetY,i=this.data.view.freezeWidth+this.data.offset.offsetX,r=this.data.view.freezeHeight+this.data.offset.offsetY;this.waffle=new rs({width:t,height:e,freezeWidth:i,freezeHeight:r,totalWidth:this.data.view.totalWidth,totalHeight:this.data.view.totalHeight}),this.el.children(this.waffle.el)},r.prototype.isDoubleClickable=function(t,e,i){var r=this,o=this.data.cellIsFreezed(i),n=o.verticalFreezed,s=o.horizontalFreezed,a=t+(n?0:this.data.getScroll().x)-this.data.offset.offsetX,h=e+(s?0:this.data.getScroll().y)-this.data.offset.offsetY;return!1===i.dblclick&&i.left<=a&&i.left+i.width>=a&&i.top<=h&&i.top+i.height>=h||!!i.items&&i.items.some(function(i){return r.isDoubleClickable(t,e,i.el)})},r.prototype.focusHandler=function(t,e){var i=t,r=this.data.scroll.x,o=e,n=this.data.scroll.y;Math.abs(i-r)>1&&Uo(t)&&this.whellScroll(i-r,0),Math.abs(o-n)>1&&Uo(e)&&this.whellScroll(0,o-n)},r.prototype.showInputCell=function(){var t=this.data.getSelectCell();t.x=t.x+this.data.offset.offsetX,t.y=t.y+this.data.offset.offsetY},r.prototype.showSelectArea=function(){var t=this.data.getSelectBounds();this.waffle.showSelectArea(t)},r.prototype.hideSelectArea=function(){this.waffle.hideSelectArea(),this.data.clearSelection()},r.prototype.clean=function(){this.cellCache=new Set,this.stickerTimeouts.forEach(function(t){window.clearTimeout(t)}),this.stickerTimeouts=[],this.waffle.clean()},r.prototype.getActiveCell=function(t,e){var i=this.data.getCellByOffset(t,e);return i?!1===i.valid?null:i:null},r.prototype.setMouseCursorByEvent=function(t,e){for(var i=this.waffle.getGrids().map(function(t){return t.el.el}),r=this.waffle.el.el,o=t.target;o&&o!==r&&!i.includes(o);)o=o.parentElement;o&&(o.style.cursor=e)},r.prototype.getActivePosition=function(t,e){var i=this.el.el.getBoundingClientRect();return[t-i.left,e-i.top]},r.prototype.getPointInfo=function(t){var e=this.getClientByEvent(t),i=this.getPointByEvent(t);return{x:i.x,y:i.y,clientX:e.x,clientY:e.y}},r.prototype.getClientByEvent=function(t){var e=t;return window.TouchEvent&&t instanceof TouchEvent&&(e="touchend"===t.type?t.changedTouches[0]:t.targetTouches[0]),{x:e.clientX,y:e.clientY}},r.prototype.getPointByEvent=function(t){var e=this.waffle.getGrids().map(function(t){return t.el.el}),i=this.waffle.el.el,r=rs.STICKER_CONTAINER_CLASS_NAME;if(this.supportCSSTransform&&t instanceof MouseEvent)return{x:function(t,o){for(var n=t,s=o;s&&s!==i&&!e.includes(s);)(""+s.className).includes(r)?n=t+s.offsetLeft:n+=s.offsetLeft,s=s.parentElement;return s&&(n-=s.scrollLeft-s.offsetLeft),n}(t.offsetX,t.target),y:function(t,o){for(var n=t,s=o;s&&s!==i&&!e.includes(s);)(""+s.className).includes(r)?n=t+s.offsetTop:n+=s.offsetTop,s=s.parentElement;return s&&s.parentElement&&(n-=s.scrollTop-s.parentElement.offsetTop),n}(t.offsetY,t.target)};var o=this.getClientByEvent(t),n=o.x,s=o.y;return this.getPointByClient(n,s)},r}(ts),cs="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function ds(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on".concat(e),function(){i(window.event)})}function fs(t,e){for(var i=e.slice(0,e.length-1),r=0;r<i.length;r++)i[r]=t[i[r].toLowerCase()];return i}function us(t){t||(t="");for(var e=(t=t.replace(/\s/g,"")).split(","),i=e.lastIndexOf("");i>=0;)e[i-1]+=",",e.splice(i,1),i=e.lastIndexOf("");return e}function ps(t,e){for(var i=t.length>=e.length?t:e,r=t.length>=e.length?e:t,o=!0,n=0;n<i.length;n++)-1===r.indexOf(i[n])&&(o=!1);return o}for(var gs={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"":20,",":188,".":190,"/":191,"`":192,"-":cs?173:189,"=":cs?61:187,";":cs?59:186,"'":222,"[":219,"]":221,"\\":220},vs={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":cs?224:91,cmd:cs?224:91,command:cs?224:91},ys={16:"shiftKey",18:"altKey",17:"ctrlKey"},ws={16:!1,18:!1,17:!1},bs={},ms=1;ms<20;ms++)gs["f".concat(ms)]=111+ms;ys[cs?224:91]="metaKey",ws[cs?224:91]=!1;var xs=[],Ss="all",Cs=[],ks=function(t){return gs[t.toLowerCase()]||vs[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)};function zs(t){Ss=t||"all"}function Ms(){return Ss||"all"}function Es(t,e,i){var r;if(e.scope===i||"all"===e.scope){for(var o in r=e.mods.length>0,ws)Object.prototype.hasOwnProperty.call(ws,o)&&(!ws[o]&&e.mods.indexOf(+o)>-1||ws[o]&&-1===e.mods.indexOf(+o))&&(r=!1);(0!==e.mods.length||ws[16]||ws[18]||ws[17]||ws[91])&&!r&&"*"!==e.shortcut||!1===e.method(t,e)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}function Ts(t){var e=bs["*"],i=t.keyCode||t.which||t.charCode;if(As.filter.call(this,t)){if(-1===xs.indexOf(i)&&229!==i&&xs.push(i),93!==i&&224!==i||(i=91),i in ws){for(var r in ws[i]=!0,vs)vs[r]===i&&(As[r]=!0);if(!e)return}for(var o in ws)Object.prototype.hasOwnProperty.call(ws,o)&&(ws[o]=t[ys[o]]);var n=Ms();if(e)for(var s=0;s<e.length;s++)e[s].scope===n&&("keydown"===t.type&&e[s].keydown||"keyup"===t.type&&e[s].keyup)&&Es(t,e[s],n);if(i in bs)for(var a=0;a<bs[i].length;a++)if(("keydown"===t.type&&bs[i][a].keydown||"keyup"===t.type&&bs[i][a].keyup)&&bs[i][a].key){for(var h=bs[i][a].key.split("+"),l=[],c=0;c<h.length;c++)l.push(ks(h[c]));(l=l.sort()).join("")===xs.sort().join("")&&Es(t,bs[i][a],n)}}}function As(t,e,i){var r=us(t),o=[],n="all",s=document,a=0,h=!1,l=!0;for(void 0===i&&"function"==typeof e&&(i=e),"[object Object]"===Object.prototype.toString.call(e)&&(e.scope&&(n=e.scope),e.element&&(s=e.element),e.keyup&&(h=e.keyup),e.keydown&&(l=e.keydown)),"string"==typeof e&&(n=e);a<r.length;a++)o=[],(t=r[a].split("+")).length>1&&(o=fs(vs,t)),(t="*"===(t=t[t.length-1])?"*":ks(t))in bs||(bs[t]=[]),bs[t].push({keyup:h,keydown:l,scope:n,mods:o,shortcut:r[a],method:i,key:r[a]});void 0!==s&&!function(t){return Cs.indexOf(t)>-1}(s)&&window&&(Cs.push(s),ds(s,"keydown",function(t){Ts(t)}),ds(window,"focus",function(){xs=[]}),ds(s,"keyup",function(t){Ts(t),function(t){var e=t.keyCode||t.which||t.charCode,i=xs.indexOf(e);if(i>=0&&xs.splice(i,1),t.key&&"meta"===t.key.toLowerCase()&&xs.splice(0,xs.length),93!==e&&224!==e||(e=91),e in ws)for(var r in ws[e]=!1,vs)vs[r]===e&&(As[r]=!1)}(t)}))}var Bs={setScope:zs,getScope:Ms,deleteScope:function(t,e){var i,r;for(var o in t||(t=Ms()),bs)if(Object.prototype.hasOwnProperty.call(bs,o))for(i=bs[o],r=0;r<i.length;)i[r].scope===t?i.splice(r,1):r++;Ms()===t&&zs(e||"all")},getPressedKeyCodes:function(){return xs.slice(0)},isPressed:function(t){return"string"==typeof t&&(t=ks(t)),-1!==xs.indexOf(t)},filter:function(t){var e=t.target||t.srcElement,i=e.tagName,r=!0;return!e.isContentEditable&&"TEXTAREA"!==i&&("INPUT"!==i&&"TEXTAREA"!==i||e.readOnly)||(r=!1),r},unbind:function(t,e,i){var r,o,n=us(t),s=[];"function"==typeof e&&(i=e,e="all");for(var a=0;a<n.length;a++){if(s=(r=n[a].split("+")).length>1?fs(vs,r):[],t="*"===(t=r[r.length-1])?"*":ks(t),e||(e=Ms()),!bs[t])return;for(var h=0;h<bs[t].length;h++)o=bs[t][h],(!i||o.method===i)&&o.scope===e&&ps(o.mods,s)&&(bs[t][h]={})}}};for(var _s in Bs)Object.prototype.hasOwnProperty.call(Bs,_s)&&(As[_s]=Bs[_s]);if("undefined"!=typeof window){var js=window.hotkeys;As.noConflict=function(t){return t&&window.hotkeys===As&&(window.hotkeys=js),As},window.hotkeys=As}var Rs=function(){function t(t){var e=this;t&&t.hotkeys&&Object.keys(t.hotkeys).forEach(function(i){e.bindHotkeys(i,t.hotkeys[i])})}return t.prototype.bindHotkeys=function(t,e){As(t,e)},t.prototype.unbindHotkeys=function(t,e){As.unbind(t,e)},t.KEY={COPY:"ctrl+c,command+c"},t}(),Os=function(){function t(t){void 0===t&&(t=[{key:"copy",icon:"",label:"",accel:""}]),this.el=a("div","sheet-menu").css({userSelect:"none"}).hide(),this.clickHandler=Jo,this.menuItems=t,this.buildItems(),this.el.el.addEventListener("contextmenu",function(t){return t.preventDefault()}),document.body.appendChild(this.el.el)}return t.prototype.show=function(t,e,i){var r=this.el.show().offset(),o=r.width,n=r.height;this.configItems(i);var s=e,a=t;window.innerHeight-e<=n&&(s-=n),window.innerWidth-t<=o&&(a-=o),this.el.offset({left:a,top:s}),an(this.el)},t.prototype.hide=function(){this.el.hide(),sn(this.el)},t.prototype.bindHandler=function(t){this.clickHandler=t},t.prototype.tear=function(){document.body.removeChild(this.el.el)},t.prototype.configItems=function(t){var e=this;this.menuItems.forEach(function(i){t[i.key]?e.el.childEnable(i.key):e.el.disableChild(i.key)})},t.prototype.buildItems=function(){var t=this;this.menuItems.forEach(function(e){"separator"===e.key&&t.el.children(a("div","sheet-menuseparator")),t.el.children(a("div","sheet-menuitem "+e.key).on("mousedown",function(t){t.stopPropagation()}).on("click",function(){t.clickHandler(e.key),t.hide()}).children(a("div","sheet-menuitem-icon"),a("span","sheet-menuitem-label").text(e.label||""),a("span","sheet-menuitem-accel").text(e.accel||"")))})},t}(),Hs=function(){function t(t){var e=t.data,i=t.editable,r=void 0!==i&&i;this.data=e,this.el=a("div","input-box").hide(),this.input=a("div","cell-input").attr("contenteditable",""+!!r),this.el.children(this.input),document.body.appendChild(this.el.el)}return t.prototype.show=function(t,e,i,r){if(!(i<=0||r<=0)){this.el.css({left:t-2+"px",top:e-2+"px",maxWidth:this.data.width-t+this.data.offset.offsetX-12+"px",minWidth:i+2+"px",minHeight:r+2+"px",maxHeight:this.data.height-e+this.data.offset.offsetY-12+"px"}).show(),this.input.text(""),this.text=this.text||a("span"),this.text.text(this.data.getSelectCell().value),this.input.children(this.text);var o,n,s=T(),h=document.createRange();s.removeAllRanges(),h.selectNodeContents(this.text.el),h.setStart(h.startContainer,h.endOffset),s.addRange(h),an(this.el),o=this.el,void 0===n&&(n=function(t){t.hide()}),o.mouseWhell=function(){n(o)},on(window.document.body,"mousewheel",o.mouseWhell)}},t.prototype.hide=function(){var t;this.el.hide(),sn(this.el),(t=this.el).mouseWhell&&(nn(window.document.body,"mousewheel",t.mouseWhell),delete t.mouseWhell)},t.prototype.tear=function(){document.body.removeChild(this.el.el)},t}(),Ws=function(){function t(){var t=this;this.texts=[],this.cells=null,this.trigger=document.createElement("textarea"),this.trigger.className="trix-offscreen",this.trigger.innerText=" ",this.trigger.addEventListener("copy",function(e){t.setClipboardData(e)}),document.body.appendChild(this.trigger)}return t.prototype.copy=function(t){this.cells=t,this.isImage()?this.downloadImage():this.dispatchCopy()},t.prototype.copyText=function(t){0!==t.length&&(this.texts=t,this.dispatchCopy())},t.prototype.clear=function(){this.cells=null},t.prototype.tear=function(){document.body.removeChild(this.trigger)},t.prototype.isImage=function(){return this.cells.length>=1&&this.cells[0].length>=1&&this.cells[0][0].image},t.prototype.downloadImage=function(){var t=document.createElement("a");t.href=this.cells[0][0].image,t.download="image.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)},t.prototype.dispatchCopy=function(){var t=T(),e=document.createRange();t.removeAllRanges(),e.selectNodeContents(this.trigger),t.addRange(e),this.trigger.setSelectionRange(0,99999),this.trigger.focus(),document.execCommand("copy"),this.trigger.blur()},t.prototype.transform2HTML=function(){if(!this.cells)return"";var t={},e=[],i=[];return this.cells.forEach(function(r){r.forEach(function(r){var o=r.ri,n=r.ci,s=r.width,a=r.height;e[n]!==s&&(e[n]||0===e[n]?(e[n]=Math.min(e[n],s),e[n+1]=Math.max(e[n],s)-e[n]):e[n]=s),i[o]!==a&&(i[o]||0===i[o]?(i[o]=Math.min(i[o],a),i[o+1]=Math.max(i[o],a)-i[o]):i[o]=a),t[r.ci+"-"+r.ri]=""})}),""},t.prototype.transform2Text=function(){return this.texts.map(function(t){return t.join("\t")}).join("\n")},t.prototype.setClipboardData=function(t){var e;if(t.clipboardData)t.clipboardData.setData("text/html",this.transform2HTML()),t.clipboardData.setData("text/plain",this.transform2Text());else{this.transform2HTML();null===(e=window.clipboardData)||void 0===e||e.setData("text",this.transform2Text())}t.preventDefault()},t}(),Ls=function(){function t(t,e){var i,r,o=this;void 0===e&&(e={}),this.scrollHandler=function(t,e){"vertical"===e?o.data.scrollY(t,o.scrollTable):o.data.scrollX(t,o.scrollTable)},this.resizeHandler=function(t,e,i){"vertical"===i?o.data.resizeCol(t.ci,t.width+e):o.data.resizeRow(t.ri,t.height+e),o.render()},this.scrollTable=function(t,e){o.container.setWheelMode(Qn.WHEELMODE_WHEEL);var i=t.y-e.y,r=t.x-e.x;o.table.scroll(r,i),(o.eventsMap.scroll||[]).forEach(function(e){e.call(null,{x:t.x,y:t.y,deltaX:r,deltaY:i})})},this.selectHandler=function(t,e,i,r,n){o.data.select(t,e,i,r,n),o.table.renderSequnce()},this.showContextMenu=function(t,e){if(!(Z(o.disableContextMenu)?o.disableContextMenu():o.disableContextMenu)){for(var i=!1,r=0,n=o.data.getSelectRangeCells();r<n.length;r++){if(i=n[r].some(function(t){return!!t.canCopy}))break}o.contextMenu.show(t,e,{copy:i&&!Jt(o.data.selection.getSelectedTexts())})}},this.contextMenuHandler=function(t){switch(t){case"copy":default:o.copy()}},this.render=function(){var t,e;o.table.render(),null===(e=(t=o.events).render)||void 0===e||e.call(t)},this.copy=function(){o.clipboard.copyText(o.data.selection.getSelectedTexts())},this.events=e,this.el=a("div","sheet"),this.el.offset({width:t.width,height:t.height}),this.data=new Gn("sheet",t),this.disableContextMenu=t.disableContextMenu,this.container=new ls(this.data,{sync:t.sync,getPointByClient:this.getPointByClient.bind(this),supportCSSTransform:t.supportCSSTransform}),this.table=new Zn(this.data,this.container),this.container.el.unshiftChildren(this.table.el),this.el.children(this.container.el),this.initEvent(),this.initHotKeys(),this.contextMenu=new Os(t.contextMenuItems),this.contextMenu.bindHandler(this.contextMenuHandler),this.inputBox=new Hs({data:this.data}),null===(r=(i=this.events).created)||void 0===r||r.call(i),this.render()}return t.prototype.initEvent=function(){this.eventsMap={},this.container.on("scroll",this.scrollHandler),this.container.on("resize",this.resizeHandler),this.container.on("select",this.selectHandler),this.container.on("contextmenu",this.showContextMenu)},t.prototype.initHotKeys=function(){this.hotkeys=new Rs,this.initCopyEvent()},t.prototype.initCopyEvent=function(){this.clipboard=new Ws,this.hotkeys.bindHotkeys(Rs.KEY.COPY,this.copy)},t.prototype.resizeEl=function(){this.el.offset({width:this.data.width+this.data.offset.offsetX,height:this.data.height+this.data.offset.offsetY})},t.prototype.addEventListener=function(t,e){this.eventsMap[t]=this.eventsMap[t]||[],this.eventsMap[t].includes(e)||this.eventsMap[t].push(e)},t.prototype.removeEventListener=function(t,e){this.eventsMap[t]=this.eventsMap[t]||[],Yr(this.eventsMap[t],e)},t.prototype.loadData=function(t){this.data.setData(t),this.reset()},t.prototype.updateCell=function(t,e){this.data.updateCell(t.ri,t.ci,e),this.table.renderCell(t)},t.prototype.getCellPosition=function(t){return this.data.getCellPosition(t,this.data.options.sheet.merges)},t.prototype.whellByBounds=function(t){var e=t.x,i=void 0===e?0:e,r=t.y,o=void 0===r?0:r,n=t.width,s=t.height,a=this.getBounds(),h=a.left,l=a.top,c=a.right,d=a.bottom,f=0,u=0;(i<=h||i+n>=c)&&(f=i+n-(i+n>=c?c-n:h+2*n));(o<=l||o+s>=d)&&(u=o+s-(o+s>=d?d-s:l+2*s));this.whellScroll(f,u)},t.prototype.getBounds=function(){var t=this.data.getScroll(),e=t.x,i=t.y;return{left:e,top:i,right:e+this.data.width,bottom:i+this.data.height,width:this.data.width,height:this.data.height}},t.prototype.insertRows=function(t,e,i){this.data.insertRows(t,e,i),this.render(),this.container.resize()},t.prototype.insertCols=function(t,e,i){this.data.insertCols(t,e,i),this.render(),this.container.resize()},t.prototype.deleteRows=function(t,e){this.data.deleteRows(t,e),this.render(),this.container.resize()},t.prototype.deleteCols=function(t,e){this.data.deleteCols(t,e),this.render(),this.container.resize()},t.prototype.reset=function(){this.data.reset(),this.container.reset(),this.table.resize(),this.render(),this.resizeEl()},t.prototype.resize=function(t,e){this.data.resize(t,e),this.container.resize(),this.table.resize(),this.render(),this.resizeEl()},t.prototype.setHScrollBarVisible=function(t){this.container.horizontalScrollBar.setVisible(t)},t.prototype.setVScrollBarVisible=function(t){this.container.verticalScrollBar.setVisible(t)},t.prototype.whellScroll=function(t,e){return this.container.whellScroll(t,e)},t.prototype.tear=function(){this.clipboard.tear(),this.contextMenu.tear(),this.inputBox.tear(),this.container.tear()},t.prototype.getPointByClient=function(t,e){var i=this.table.el.el.getBoundingClientRect();return{x:t-i.left,y:e-i.top}},t}(),Is=function(){function t(t,e,r){var o,n,s;if(void 0===r&&(r={}),!r.beforeInit||r.beforeInit()){null===(o=r.beforeCreate)||void 0===o||o.call(r),this.parent=a(t,"sheet-root");var h=this.parent.offset(),l=h.width,c=h.height,d=e.tableWidth,f=void 0===d?l:d,u=e.tableHeight,p=i({width:f,height:void 0===u?c:u},e.options);this.sheet=new Ls(p,r),null===(n=r.beforeMount)||void 0===n||n.call(r),this.parent.children(this.sheet.el),null===(s=r.mounted)||void 0===s||s.call(r)}}return t.prototype.loadData=function(t){return this.sheet.loadData(t),this},t.prototype.updateData=function(){return this},t.prototype.updateCell=function(t,e){this.sheet.updateCell(t,e)},t.prototype.getCellPosition=function(t){return this.sheet.getCellPosition(t)},t.prototype.resize=function(t,e){var i=this.parent.offset(),r=i.width,o=i.height;t=t||r,e=e||o,this.sheet.resize(t,e)},t.prototype.insertRows=function(t,e,i){this.sheet.insertRows(t,e,i)},t.prototype.insertCols=function(t,e,i){this.sheet.insertCols(t,e,i)},t.prototype.deleteRows=function(t,e){this.sheet.deleteRows(t,e)},t.prototype.deleteCols=function(t,e){this.sheet.deleteCols(t,e)},t.prototype.tear=function(){this.sheet.tear()},t}();return{createSheet:function(t,e,i){return new Is(t,e,i)}}}();
//# sourceMappingURL=sheet.es5.js.map
