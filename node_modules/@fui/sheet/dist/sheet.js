var finesheet=function(){"use strict";"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});!function(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var s=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===i&&s.firstChild?s.insertBefore(r,s.firstChild):s.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}(".sheet {\n  position: relative;\n  overflow: hidden;\n  color: #000000;\n}\n.sheet canvas {\n  -webkit-font-smoothing: subpixel-antialiased;\n  -moz-osx-font-smoothing: auto;\n}\n.sheet .grid-container .sheet-resizer {\n  position: absolute;\n  z-index: 7;\n}\n.sheet .grid-container .sheet-resizer.vertical .sheet-resizer-hover {\n  cursor: col-resize;\n}\n.sheet .grid-container .sheet-resizer.horizontal .sheet-resizer-hover {\n  cursor: row-resize;\n}\n.sheet .grid-container .sheet-resizer-hover {\n  background-color: #4d90fe;\n}\n.sheet .grid-container .sheet-resizer-line {\n  position: absolute;\n  background-color: #4d90fe;\n}\n.sheet .grid-container .grid-container.empty {\n  background-color: #ffffff;\n  opacity: 0;\n}\n.sheet .grid-container .ie10-below .grid-container-top,\n.sheet .grid-container .ie10-below .grid-container-bottom {\n  background-image: url('about:blank');\n}\n.sheet .sheet-table {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: auto;\n  height: auto;\n}\n.sheet .sheet-scrollbar {\n  z-index: auto;\n  transition: opacity 0.5s ease;\n}\n.sheet .sheet-scrollbar:hover,\n.sheet .sheet-scrollbar.active {\n  opacity: 1;\n}\n.sheet .sheet-scrollbar:hover .sheet-scrollbar-slider,\n.sheet .sheet-scrollbar.active .sheet-scrollbar-slider {\n  background-color: #7d7d7d;\n}\n.sheet .sheet-scrollbar.sheet-scrollbar-y {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  width: 12px;\n}\n.sheet .sheet-scrollbar.sheet-scrollbar-x {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  height: 12px;\n}\n.sheet .sheet-scrollbar .sheet-scrollbar-slider {\n  height: 10px;\n  margin: 1px;\n  background-color: #c2c2c2;\n  opacity: 0.8;\n  border-radius: 5px;\n}\n.sheet .sheet-scrollbar .sheet-scrollbar-slider:hover {\n  background-color: #7d7d7d;\n  opacity: 1;\n}\n.inline-grid {\n  display: inline-block;\n  position: absolute;\n  overflow: hidden;\n}\n.grid-container {\n  width: auto;\n  height: auto;\n}\n.grid-container-bottom,\n.grid-container-top {\n  position: absolute;\n  white-space: nowrap;\n  overflow: hidden;\n}\n.range-border {\n  position: absolute;\n  border-width: 0;\n  padding: 0;\n}\n.active-area {\n  background: #4d8ff5;\n  opacity: 0.4;\n}\n.active-cell-border,\n.active-area-border {\n  border-color: #1a73e8;\n  border-style: solid;\n  opacity: 1;\n}\n.waffle-borderless-sticker {\n  position: absolute;\n  white-space: normal;\n  overflow: hidden;\n}\n.trix-offscreen {\n  position: absolute;\n  left: -10000px;\n  top: -10000px;\n}\n.scrollable-grid {\n  position: absolute;\n}\n.sheet-tooltip {\n  position: absolute;\n  z-index: 1002;\n  padding: 2px;\n  font-size: 10px;\n  background: #647185;\n  border: 1px solid #647185;\n  max-width: 250px;\n  -webkit-border-radius: 2px;\n  -moz-border-radius: 2px;\n  border-radius: 2px;\n  font-size: 12px;\n  color: #ffffff;\n  white-space: pre;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  word-break: break-all;\n  overflow: hidden;\n}\n.sheet-menu {\n  position: absolute;\n  z-index: 1001;\n  padding: 2px 0;\n  font-size: 12px;\n  background: #ffffff;\n  cursor: default;\n  border: 1px solid transparent;\n  border-radius: 2px;\n  box-shadow: 0 2px 6px 2px rgba(60, 64, 67, 0.15);\n}\n.sheet-menu .sheet-menuitem {\n  cursor: pointer;\n  width: 120px;\n  height: 24px;\n  line-height: 24px;\n}\n.sheet-menu .sheet-menuitem.disable {\n  pointer-events: none;\n  color: #c1c1c1;\n}\n.sheet-menu .sheet-menuitem:active {\n  background: #e8eaed;\n}\n.sheet-menu .sheet-menuseparator {\n  border-top: 1px solid #dadce0;\n  margin: 4px 2px;\n}\n.input-box {\n  position: absolute;\n  z-index: 1000;\n  background: #ffffff;\n  border: 2px #1a73e8 solid;\n  overflow: auto;\n}\n.input-box .cell-input {\n  outline: none;\n  cursor: text;\n  user-select: text;\n  width: 100%;\n  height: 100%;\n  overflow-wrap: break-word;\n  white-space: pre-wrap;\n}\n");class t{constructor(t,e=""){"string"==typeof t?(this.el=document.createElement(t),this.el.className=e):this.el=t}on(t,e){return this.el.addEventListener(t,e),this}off(t,e){return this.el.removeEventListener(t,e),this}children(...e){return e.forEach(e=>{e instanceof t?this.el.appendChild(e.el):this.el.appendChild(e)}),this}unshiftChildren(...e){return e.forEach(e=>{e instanceof t?this.el.insertBefore(e.el,this.el.firstChild):this.el.insertBefore(e,this.el.firstChild)}),this}css(t,e){return void 0===e&&"string"==typeof t?this.el.style[t]:("number"==typeof t||"string"==typeof t?this.el.style[t]=e:Object.keys(t).forEach(e=>{this.el.style[e]=t[e]}),this)}offset(t){if(void 0===t){const{offsetTop:t,offsetLeft:e,offsetHeight:i,offsetWidth:s}=this.el;return{top:t,left:e,height:i-t,width:s-e}}return Object.keys(t).forEach(e=>{this.el.style[e]=`${t[e]}px`}),this}addClass(t){return new RegExp(t,"ig").test(this.el.className)||(this.el.className=`${this.el.className} ${t}`),this}removeClass(t){return new RegExp(t,"ig").test(this.el.className)&&(this.el.className=this.el.className.replace(t,"")),this}html(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}text(t){return void 0!==t?(this.el.innerText=t,this):this.el.innerText}attr(t,e){return this.el.setAttribute(t,e),this}contains(t){return this.el.contains(t)}remove(){this.el.remove()}hide(){return this.css("display","none"),this}show(){return this.css("display","block"),this}focus(){return this.el.focus(),this}disableChild(t){for(let e=0;e<this.el.childNodes.length;e++){const i=this.el.childNodes[e];i.className.includes(t)&&!i.className.includes("disable")&&(i.className=`${i.className} disable`)}}childEnable(t){for(let e=0;e<this.el.childNodes.length;e++){const i=this.el.childNodes[e];i.className.includes(t)&&(i.className=i.className.replace(" disable",""))}}hasChild(t){let e=!1;for(let i=0;i<this.el.childNodes.length;i++){const s=this.el.childNodes[i];if(e=t instanceof HTMLElement?s===t:s===t.el)break}return e}scroll({top:t,left:e}){this.el.scrollLeft=e,this.el.scrollTop=t}}const e=(e,i="")=>new t(e,i),i={};function s(t){return function(e){i[t]=e}}function r(t){const{type:e="bi.label"}=t;return i[e]?new i[e](t):null}const o={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},n=/^#([a-f0-9]{3})$/i,h=t=>{const e=t.match(n);return!!e&&[parseInt(e[1][0]+e[1][0],16),parseInt(e[1][1]+e[1][1],16),parseInt(e[1][2]+e[1][2],16),null]},l=/^#([a-f0-9]{6})$/i,a=t=>{const e=t.match(l);return!!e&&[parseInt(e[1].substring(0,2),16),parseInt(e[1].substring(2,4),16),parseInt(e[1].substring(4,6),16),null]},c=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/,d=t=>{const e=t.match(c);return!!e&&[Number(e[1]),Number(e[2]),Number(e[3]),null]},f=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/,u=t=>{const e=t.match(f);return!!(e&&e.length>4)&&[Number(e[1]),Number(e[2]),Number(e[3]),Number(e[4])]},g=t=>[Math.min(t[0],255),Math.min(t[1],255),Math.min(t[2],255),t.length>3?t[3]:null],p=t=>{const e=o[t.toLowerCase()];return e||!1};class w{constructor(t){const[e,i,s,r]=Array.isArray(t)?g(t):h(t)||d(t)||u(t)||p(t)||a(t)||[255,255,255,0];this.r=e,this.g=i,this.b=s,this.a=r}isTransparent(){return 0===this.a}toString(){return null!==this.a&&1!==this.a&&void 0!==this.a?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}}new w([0,0,0,0]);function b(){const t=window.screen;let e=1;return window.devicePixelRatio?e=window.devicePixelRatio:t.systemXDPI&&t.logicalXDPI&&(e=t.systemXDPI/t.logicalXDPI),e>1?Math.ceil(e):1}function v(t){return`${~~`${t}`}px`}function y(t,e){const{fontStyle:i="",fontWeight:s="",fontSize:r="",fontFamily:o=""}=e;t.font=`${i} ${s} ${r} "Helvetica Neue"`,t.font=`${i} ${s} ${r} "${o}"`}const m={};function x(t){const e=`${t.fontFamily} ${t.fontSize}`;return void 0===m[e]&&(m[e]=function(t){const e=document.createElement("div"),i=document.createElement("img"),s=document.createElement("span"),r=document.body;if(!r)throw new Error("");e.style.visibility="hidden",e.style.fontFamily=t.fontFamily,e.style.fontSize=t.fontSize,e.style.margin="0",e.style.padding="0",e.appendChild(document.createTextNode("Hidden Text")),r.appendChild(e),i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",i.width=1,i.height=Math.round(parseFloat(t.fontSize)/10),i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",e.appendChild(s),e.appendChild(i);const o=Math.round(parseFloat(t.fontSize)/3)+i.height+1;e.style.lineHeight="normal",i.style.verticalAlign="super";const n=i.offsetTop-e.offsetTop+i.height+1;return r.removeChild(e),{baseline:o,middle:n}}(t)),m[e]}function S(){return window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection}var C=Object.prototype;function k(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||C)}function z(t,e){return function(i){return t(e(i))}}var M=z(Object.keys,Object),j=Object.prototype.hasOwnProperty;function E(t){if(!k(t))return M(t);var e=[];for(var i in Object(t))j.call(t,i)&&"constructor"!=i&&e.push(i);return e}var O="object"==typeof global&&global&&global.Object===Object&&global,T="object"==typeof self&&self&&self.Object===Object&&self,A=O||T||Function("return this")(),R=A.Symbol,B=Object.prototype,_=B.hasOwnProperty,H=B.toString,W=R?R.toStringTag:void 0;var L=Object.prototype.toString;var I="[object Null]",P="[object Undefined]",$=R?R.toStringTag:void 0;function D(t){return null==t?void 0===t?P:I:$&&$ in Object(t)?function(t){var e=_.call(t,W),i=t[W];try{t[W]=void 0;var s=!0}catch(t){}var r=H.call(t);return s&&(e?t[W]=i:delete t[W]),r}(t):function(t){return L.call(t)}(t)}function X(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var N="[object AsyncFunction]",Y="[object Function]",G="[object GeneratorFunction]",F="[object Proxy]";function q(t){if(!X(t))return!1;var e=D(t);return e==Y||e==G||e==N||e==F}var V,U=A["__core-js_shared__"],K=(V=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"";var J=Function.prototype.toString;function Q(t){if(null!=t){try{return J.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var Z=/^\[object .+?Constructor\]$/,tt=Function.prototype,et=Object.prototype,it=tt.toString,st=et.hasOwnProperty,rt=RegExp("^"+it.call(st).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ot(t){return!(!X(t)||(e=t,K&&K in e))&&(q(t)?rt:Z).test(Q(t));var e}function nt(t,e){var i=function(t,e){return null==t?void 0:t[e]}(t,e);return ot(i)?i:void 0}var ht=nt(A,"DataView"),lt=nt(A,"Map"),at=nt(A,"Promise"),ct=nt(A,"Set"),dt=nt(A,"WeakMap"),ft=Q(ht),ut=Q(lt),gt=Q(at),pt=Q(ct),wt=Q(dt),bt=D;(ht&&"[object DataView]"!=bt(new ht(new ArrayBuffer(1)))||lt&&"[object Map]"!=bt(new lt)||at&&"[object Promise]"!=bt(at.resolve())||ct&&"[object Set]"!=bt(new ct)||dt&&"[object WeakMap]"!=bt(new dt))&&(bt=function(t){var e=D(t),i="[object Object]"==e?t.constructor:void 0,s=i?Q(i):"";if(s)switch(s){case ft:return"[object DataView]";case ut:return"[object Map]";case gt:return"[object Promise]";case pt:return"[object Set]";case wt:return"[object WeakMap]"}return e});var vt=bt;function yt(t){return null!=t&&"object"==typeof t}var mt="[object Arguments]";function xt(t){return yt(t)&&D(t)==mt}var St=Object.prototype,Ct=St.hasOwnProperty,kt=St.propertyIsEnumerable,zt=xt(function(){return arguments}())?xt:function(t){return yt(t)&&Ct.call(t,"callee")&&!kt.call(t,"callee")},Mt=Array.isArray,jt=9007199254740991;function Et(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=jt}function Ot(t){return null!=t&&Et(t.length)&&!q(t)}var Tt="object"==typeof exports&&exports&&!exports.nodeType&&exports,At=Tt&&"object"==typeof module&&module&&!module.nodeType&&module,Rt=At&&At.exports===Tt?A.Buffer:void 0,Bt=(Rt?Rt.isBuffer:void 0)||function(){return!1},_t={};function Ht(t){return function(e){return t(e)}}_t["[object Float32Array]"]=_t["[object Float64Array]"]=_t["[object Int8Array]"]=_t["[object Int16Array]"]=_t["[object Int32Array]"]=_t["[object Uint8Array]"]=_t["[object Uint8ClampedArray]"]=_t["[object Uint16Array]"]=_t["[object Uint32Array]"]=!0,_t["[object Arguments]"]=_t["[object Array]"]=_t["[object ArrayBuffer]"]=_t["[object Boolean]"]=_t["[object DataView]"]=_t["[object Date]"]=_t["[object Error]"]=_t["[object Function]"]=_t["[object Map]"]=_t["[object Number]"]=_t["[object Object]"]=_t["[object RegExp]"]=_t["[object Set]"]=_t["[object String]"]=_t["[object WeakMap]"]=!1;var Wt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Lt=Wt&&"object"==typeof module&&module&&!module.nodeType&&module,It=Lt&&Lt.exports===Wt&&O.process,Pt=function(){try{var t=Lt&&Lt.require&&Lt.require("util").types;return t||It&&It.binding&&It.binding("util")}catch(t){}}(),$t=Pt&&Pt.isTypedArray,Dt=$t?Ht($t):function(t){return yt(t)&&Et(t.length)&&!!_t[D(t)]},Xt="[object Map]",Nt="[object Set]",Yt=Object.prototype.hasOwnProperty;function Gt(t){if(null==t)return!0;if(Ot(t)&&(Mt(t)||"string"==typeof t||"function"==typeof t.splice||Bt(t)||Dt(t)||zt(t)))return!t.length;var e=vt(t);if(e==Xt||e==Nt)return!t.size;if(k(t))return!E(t).length;for(var i in t)if(Yt.call(t,i))return!1;return!0}var Ft="[object Symbol]";function qt(t){return"symbol"==typeof t||yt(t)&&D(t)==Ft}var Vt=NaN,Ut=/^\s+|\s+$/g,Kt=/^[-+]0x[0-9a-f]+$/i,Jt=/^0b[01]+$/i,Qt=/^0o[0-7]+$/i,Zt=parseInt;function te(t){if("number"==typeof t)return t;if(qt(t))return Vt;if(X(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=X(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Ut,"");var i=Jt.test(t);return i||Qt.test(t)?Zt(t.slice(2),i?2:8):Kt.test(t)?Vt:+t}function ee(t,e,i){return void 0===i&&(i=e,e=void 0),void 0!==i&&(i=(i=te(i))==i?i:0),void 0!==e&&(e=(e=te(e))==e?e:0),function(t,e,i){return t==t&&(void 0!==i&&(t=t<=i?t:i),void 0!==e&&(t=t>=e?t:e)),t}(te(t),e,i)}function ie(t,e){return t===e||t!=t&&e!=e}function se(t,e){for(var i=t.length;i--;)if(ie(t[i][0],e))return i;return-1}var re=Array.prototype.splice;function oe(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}oe.prototype.clear=function(){this.__data__=[],this.size=0},oe.prototype.delete=function(t){var e=this.__data__,i=se(e,t);return!(i<0||(i==e.length-1?e.pop():re.call(e,i,1),--this.size,0))},oe.prototype.get=function(t){var e=this.__data__,i=se(e,t);return i<0?void 0:e[i][1]},oe.prototype.has=function(t){return se(this.__data__,t)>-1},oe.prototype.set=function(t,e){var i=this.__data__,s=se(i,t);return s<0?(++this.size,i.push([t,e])):i[s][1]=e,this};var ne=nt(Object,"create");var he="__lodash_hash_undefined__",le=Object.prototype.hasOwnProperty;var ae=Object.prototype.hasOwnProperty;var ce="__lodash_hash_undefined__";function de(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}function fe(t,e){var i,s,r=t.__data__;return("string"==(s=typeof(i=e))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==i:null===i)?r["string"==typeof e?"string":"hash"]:r.map}function ue(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var s=t[e];this.set(s[0],s[1])}}de.prototype.clear=function(){this.__data__=ne?ne(null):{},this.size=0},de.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},de.prototype.get=function(t){var e=this.__data__;if(ne){var i=e[t];return i===he?void 0:i}return le.call(e,t)?e[t]:void 0},de.prototype.has=function(t){var e=this.__data__;return ne?void 0!==e[t]:ae.call(e,t)},de.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=ne&&void 0===e?ce:e,this},ue.prototype.clear=function(){this.size=0,this.__data__={hash:new de,map:new(lt||oe),string:new de}},ue.prototype.delete=function(t){var e=fe(this,t).delete(t);return this.size-=e?1:0,e},ue.prototype.get=function(t){return fe(this,t).get(t)},ue.prototype.has=function(t){return fe(this,t).has(t)},ue.prototype.set=function(t,e){var i=fe(this,t),s=i.size;return i.set(t,e),this.size+=i.size==s?0:1,this};var ge=200;function pe(t){var e=this.__data__=new oe(t);this.size=e.size}pe.prototype.clear=function(){this.__data__=new oe,this.size=0},pe.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},pe.prototype.get=function(t){return this.__data__.get(t)},pe.prototype.has=function(t){return this.__data__.has(t)},pe.prototype.set=function(t,e){var i=this.__data__;if(i instanceof oe){var s=i.__data__;if(!lt||s.length<ge-1)return s.push([t,e]),this.size=++i.size,this;i=this.__data__=new ue(s)}return i.set(t,e),this.size=i.size,this};var we=function(){try{var t=nt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function be(t,e,i){"__proto__"==e&&we?we(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function ve(t,e,i){(void 0===i||ie(t[e],i))&&(void 0!==i||e in t)||be(t,e,i)}var ye,me=function(t,e,i){for(var s=-1,r=Object(t),o=i(t),n=o.length;n--;){var h=o[ye?n:++s];if(!1===e(r[h],h,r))break}return t},xe="object"==typeof exports&&exports&&!exports.nodeType&&exports,Se=xe&&"object"==typeof module&&module&&!module.nodeType&&module,Ce=Se&&Se.exports===xe?A.Buffer:void 0,ke=Ce?Ce.allocUnsafe:void 0;function ze(t,e){if(e)return t.slice();var i=t.length,s=ke?ke(i):new t.constructor(i);return t.copy(s),s}var Me=A.Uint8Array;function je(t){var e=new t.constructor(t.byteLength);return new Me(e).set(new Me(t)),e}function Ee(t,e){var i=e?je(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function Oe(t,e){var i=-1,s=t.length;for(e||(e=Array(s));++i<s;)e[i]=t[i];return e}var Te=Object.create,Ae=function(){function t(){}return function(e){if(!X(e))return{};if(Te)return Te(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}(),Re=z(Object.getPrototypeOf,Object);function Be(t){return"function"!=typeof t.constructor||k(t)?{}:Ae(Re(t))}var _e="[object Object]",He=Function.prototype,We=Object.prototype,Le=He.toString,Ie=We.hasOwnProperty,Pe=Le.call(Object);function $e(t,e){if("__proto__"!=e)return t[e]}var De=Object.prototype.hasOwnProperty;function Xe(t,e,i){var s=t[e];De.call(t,e)&&ie(s,i)&&(void 0!==i||e in t)||be(t,e,i)}function Ne(t,e,i,s){var r=!i;i||(i={});for(var o=-1,n=e.length;++o<n;){var h=e[o],l=s?s(i[h],t[h],h,i,t):void 0;void 0===l&&(l=t[h]),r?be(i,h,l):Xe(i,h,l)}return i}var Ye=9007199254740991,Ge=/^(?:0|[1-9]\d*)$/;function Fe(t,e){var i=typeof t;return!!(e=null==e?Ye:e)&&("number"==i||"symbol"!=i&&Ge.test(t))&&t>-1&&t%1==0&&t<e}var qe=Object.prototype.hasOwnProperty;function Ve(t,e){var i=Mt(t),s=!i&&zt(t),r=!i&&!s&&Bt(t),o=!i&&!s&&!r&&Dt(t),n=i||s||r||o,h=n?function(t,e){for(var i=-1,s=Array(t);++i<t;)s[i]=e(i);return s}(t.length,String):[],l=h.length;for(var a in t)!e&&!qe.call(t,a)||n&&("length"==a||r&&("offset"==a||"parent"==a)||o&&("buffer"==a||"byteLength"==a||"byteOffset"==a)||Fe(a,l))||h.push(a);return h}var Ue=Object.prototype.hasOwnProperty;function Ke(t){if(!X(t))return function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}(t);var e=k(t),i=[];for(var s in t)("constructor"!=s||!e&&Ue.call(t,s))&&i.push(s);return i}function Je(t){return Ot(t)?Ve(t,!0):Ke(t)}function Qe(t,e,i,s,r,o,n){var h=$e(t,i),l=$e(e,i),a=n.get(l);if(a)ve(t,i,a);else{var c,d=o?o(h,l,i+"",t,e,n):void 0,f=void 0===d;if(f){var u=Mt(l),g=!u&&Bt(l),p=!u&&!g&&Dt(l);d=l,u||g||p?Mt(h)?d=h:yt(c=h)&&Ot(c)?d=Oe(h):g?(f=!1,d=ze(l,!0)):p?(f=!1,d=Ee(l,!0)):d=[]:function(t){if(!yt(t)||D(t)!=_e)return!1;var e=Re(t);if(null===e)return!0;var i=Ie.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&Le.call(i)==Pe}(l)||zt(l)?(d=h,zt(h)?d=function(t){return Ne(t,Je(t))}(h):X(h)&&!q(h)||(d=Be(l))):f=!1}f&&(n.set(l,d),r(d,l,s,o,n),n.delete(l)),ve(t,i,d)}}function Ze(t,e,i,s,r){t!==e&&me(e,function(o,n){if(X(o))r||(r=new pe),Qe(t,e,n,i,Ze,s,r);else{var h=s?s($e(t,n),o,n+"",t,e,r):void 0;void 0===h&&(h=o),ve(t,n,h)}},Je)}function ti(t){return t}var ei=Math.max;var ii=we?function(t,e){return we(t,"toString",{configurable:!0,enumerable:!1,value:(i=e,function(){return i}),writable:!0});var i}:ti,si=800,ri=16,oi=Date.now;var ni,hi,li,ai=(ni=ii,hi=0,li=0,function(){var t=oi(),e=ri-(t-li);if(li=t,e>0){if(++hi>=si)return arguments[0]}else hi=0;return ni.apply(void 0,arguments)});function ci(t,e){return ai(function(t,e,i){return e=ei(void 0===e?t.length-1:e,0),function(){for(var s=arguments,r=-1,o=ei(s.length-e,0),n=Array(o);++r<o;)n[r]=s[e+r];r=-1;for(var h=Array(e+1);++r<e;)h[r]=s[r];return h[e]=i(n),function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}(t,this,h)}}(t,e,ti),t+"")}di=function(t,e,i){Ze(t,e,i)},ci(function(t,e){var i=-1,s=e.length,r=s>1?e[s-1]:void 0,o=s>2?e[2]:void 0;for(r=di.length>3&&"function"==typeof r?(s--,r):void 0,o&&function(t,e,i){if(!X(i))return!1;var s=typeof e;return!!("number"==s?Ot(i)&&Fe(e,i.length):"string"==s&&e in i)&&ie(i[e],t)}(e[0],e[1],o)&&(r=s<3?void 0:r,s=1),t=Object(t);++i<s;){var n=e[i];n&&di(t,n,i,r)}return t});var di,fi="__lodash_hash_undefined__";function ui(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new ue;++e<i;)this.add(t[e])}function gi(t,e){for(var i=-1,s=null==t?0:t.length;++i<s;)if(e(t[i],i,t))return!0;return!1}ui.prototype.add=ui.prototype.push=function(t){return this.__data__.set(t,fi),this},ui.prototype.has=function(t){return this.__data__.has(t)};var pi=1,wi=2;function bi(t,e,i,s,r,o){var n=i&pi,h=t.length,l=e.length;if(h!=l&&!(n&&l>h))return!1;var a=o.get(t);if(a&&o.get(e))return a==e;var c=-1,d=!0,f=i&wi?new ui:void 0;for(o.set(t,e),o.set(e,t);++c<h;){var u=t[c],g=e[c];if(s)var p=n?s(g,u,c,e,t,o):s(u,g,c,t,e,o);if(void 0!==p){if(p)continue;d=!1;break}if(f){if(!gi(e,function(t,e){if(n=e,!f.has(n)&&(u===t||r(u,t,i,s,o)))return f.push(e);var n})){d=!1;break}}else if(u!==g&&!r(u,g,i,s,o)){d=!1;break}}return o.delete(t),o.delete(e),d}function vi(t){var e=-1,i=Array(t.size);return t.forEach(function(t,s){i[++e]=[s,t]}),i}function yi(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i}var mi=1,xi=2,Si="[object Boolean]",Ci="[object Date]",ki="[object Error]",zi="[object Map]",Mi="[object Number]",ji="[object RegExp]",Ei="[object Set]",Oi="[object String]",Ti="[object Symbol]",Ai="[object ArrayBuffer]",Ri="[object DataView]",Bi=R?R.prototype:void 0,_i=Bi?Bi.valueOf:void 0;function Hi(t,e){for(var i=-1,s=e.length,r=t.length;++i<s;)t[r+i]=e[i];return t}function Wi(t,e,i){var s=e(t);return Mt(t)?s:Hi(s,i(t))}function Li(){return[]}var Ii=Object.prototype.propertyIsEnumerable,Pi=Object.getOwnPropertySymbols,$i=Pi?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var i=-1,s=null==t?0:t.length,r=0,o=[];++i<s;){var n=t[i];e(n,i,t)&&(o[r++]=n)}return o}(Pi(t),function(e){return Ii.call(t,e)}))}:Li;function Di(t){return Ot(t)?Ve(t):E(t)}function Xi(t){return Wi(t,Di,$i)}var Ni=1,Yi=Object.prototype.hasOwnProperty;var Gi=1,Fi="[object Arguments]",qi="[object Array]",Vi="[object Object]",Ui=Object.prototype.hasOwnProperty;function Ki(t,e,i,s,r,o){var n=Mt(t),h=Mt(e),l=n?qi:vt(t),a=h?qi:vt(e),c=(l=l==Fi?Vi:l)==Vi,d=(a=a==Fi?Vi:a)==Vi,f=l==a;if(f&&Bt(t)){if(!Bt(e))return!1;n=!0,c=!1}if(f&&!c)return o||(o=new pe),n||Dt(t)?bi(t,e,i,s,r,o):function(t,e,i,s,r,o,n){switch(i){case Ri:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Ai:return!(t.byteLength!=e.byteLength||!o(new Me(t),new Me(e)));case Si:case Ci:case Mi:return ie(+t,+e);case ki:return t.name==e.name&&t.message==e.message;case ji:case Oi:return t==e+"";case zi:var h=vi;case Ei:var l=s&mi;if(h||(h=yi),t.size!=e.size&&!l)return!1;var a=n.get(t);if(a)return a==e;s|=xi,n.set(t,e);var c=bi(h(t),h(e),s,r,o,n);return n.delete(t),c;case Ti:if(_i)return _i.call(t)==_i.call(e)}return!1}(t,e,l,i,s,r,o);if(!(i&Gi)){var u=c&&Ui.call(t,"__wrapped__"),g=d&&Ui.call(e,"__wrapped__");if(u||g){var p=u?t.value():t,w=g?e.value():e;return o||(o=new pe),r(p,w,i,s,o)}}return!!f&&(o||(o=new pe),function(t,e,i,s,r,o){var n=i&Ni,h=Xi(t),l=h.length;if(l!=Xi(e).length&&!n)return!1;for(var a=l;a--;){var c=h[a];if(!(n?c in e:Yi.call(e,c)))return!1}var d=o.get(t);if(d&&o.get(e))return d==e;var f=!0;o.set(t,e),o.set(e,t);for(var u=n;++a<l;){var g=t[c=h[a]],p=e[c];if(s)var w=n?s(p,g,c,e,t,o):s(g,p,c,t,e,o);if(!(void 0===w?g===p||r(g,p,i,s,o):w)){f=!1;break}u||(u="constructor"==c)}if(f&&!u){var b=t.constructor,v=e.constructor;b!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof v&&v instanceof v)&&(f=!1)}return o.delete(t),o.delete(e),f}(t,e,i,s,r,o))}function Ji(t,e,i,s,r){return t===e||(null==t||null==e||!yt(t)&&!yt(e)?t!=t&&e!=e:Ki(t,e,i,s,Ji,r))}var Qi=1,Zi=2;function ts(t){return t==t&&!X(t)}function es(t,e){return function(i){return null!=i&&(i[t]===e&&(void 0!==e||t in Object(i)))}}function is(t){var e=function(t){for(var e=Di(t),i=e.length;i--;){var s=e[i],r=t[s];e[i]=[s,r,ts(r)]}return e}(t);return 1==e.length&&e[0][2]?es(e[0][0],e[0][1]):function(i){return i===t||function(t,e,i,s){var r=i.length,o=r,n=!s;if(null==t)return!o;for(t=Object(t);r--;){var h=i[r];if(n&&h[2]?h[1]!==t[h[0]]:!(h[0]in t))return!1}for(;++r<o;){var l=(h=i[r])[0],a=t[l],c=h[1];if(n&&h[2]){if(void 0===a&&!(l in t))return!1}else{var d=new pe;if(s)var f=s(a,c,l,t,e,d);if(!(void 0===f?Ji(c,a,Qi|Zi,s,d):f))return!1}}return!0}(i,t,e)}}var ss=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rs=/^\w*$/;function os(t,e){if(Mt(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!qt(t))||(rs.test(t)||!ss.test(t)||null!=e&&t in Object(e))}var ns="Expected a function";function hs(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(ns);var i=function(){var s=arguments,r=e?e.apply(this,s):s[0],o=i.cache;if(o.has(r))return o.get(r);var n=t.apply(this,s);return i.cache=o.set(r,n)||o,n};return i.cache=new(hs.Cache||ue),i}hs.Cache=ue;var ls=500;var as=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cs=/\\(\\)?/g,ds=function(t){var e=hs(t,function(t){return i.size===ls&&i.clear(),t}),i=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(as,function(t,i,s,r){e.push(s?r.replace(cs,"$1"):i||t)}),e});var fs=1/0,us=R?R.prototype:void 0,gs=us?us.toString:void 0;function ps(t){if("string"==typeof t)return t;if(Mt(t))return function(t,e){for(var i=-1,s=null==t?0:t.length,r=Array(s);++i<s;)r[i]=e(t[i],i,t);return r}(t,ps)+"";if(qt(t))return gs?gs.call(t):"";var e=t+"";return"0"==e&&1/t==-fs?"-0":e}function ws(t,e){return Mt(t)?t:os(t,e)?[t]:ds(function(t){return null==t?"":ps(t)}(t))}var bs=1/0;function vs(t){if("string"==typeof t||qt(t))return t;var e=t+"";return"0"==e&&1/t==-bs?"-0":e}function ys(t,e){for(var i=0,s=(e=ws(e,t)).length;null!=t&&i<s;)t=t[vs(e[i++])];return i&&i==s?t:void 0}function ms(t,e){return null!=t&&e in Object(t)}function xs(t,e){return null!=t&&function(t,e,i){for(var s=-1,r=(e=ws(e,t)).length,o=!1;++s<r;){var n=vs(e[s]);if(!(o=null!=t&&i(t,n)))break;t=t[n]}return o||++s!=r?o:!!(r=null==t?0:t.length)&&Et(r)&&Fe(n,r)&&(Mt(t)||zt(t))}(t,e,ms)}var Ss=1,Cs=2;function ks(t,e){return os(t)&&ts(e)?es(vs(t),e):function(i){var s=function(t,e,i){var s=null==t?void 0:ys(t,e);return void 0===s?i:s}(i,t);return void 0===s&&s===e?xs(i,t):Ji(e,s,Ss|Cs)}}function zs(t){return os(t)?(e=vs(t),function(t){return null==t?void 0:t[e]}):function(t){return function(e){return ys(e,t)}}(t);var e}function Ms(t){return"function"==typeof t?t:null==t?ti:"object"==typeof t?Mt(t)?ks(t[0],t[1]):is(t):zs(t)}var js=1/0,Es=1.7976931348623157e308;function Os(t){return t?(t=te(t))===js||t===-js?(t<0?-1:1)*Es:t==t?t:0:0===t?t:0}var Ts=Math.max;var As,Rs=(As=function(t,e,i){var s=null==t?0:t.length;if(!s)return-1;var r,o,n=null==i?0:(r=Os(i),o=r%1,r==r?o?r-o:r:0);return n<0&&(n=Ts(s+n,0)),function(t,e,i,s){for(var r=t.length,o=i+(s?1:-1);s?o--:++o<r;)if(e(t[o],o,t))return o;return-1}(t,Ms(e),n)},function(t,e,i){var s=Object(t);if(!Ot(t)){var r=Ms(e);t=Di(t),e=function(t){return r(s[t],t,s)}}var o=As(t,e,i);return o>-1?s[r?t[o]:o]:void 0});function Bs(t,e){return Ji(t,e)}function _s(t,e){return e.length<2?t:ys(t,function(t,e,i){var s=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(i=i>r?r:i)<0&&(i+=r),r=e>i?0:i-e>>>0,e>>>=0;for(var o=Array(r);++s<r;)o[s]=t[s+e];return o}(e,0,-1))}function Hs(t,e){return null==(t=_s(t,e=ws(e,t)))||delete t[vs((i=e,s=null==i?0:i.length,s?i[s-1]:void 0))];var i,s}var Ws=Array.prototype.splice;function Ls(t,e){var i=[];if(!t||!t.length)return i;var s=-1,r=[],o=t.length;for(e=Ms(e);++s<o;){var n=t[s];e(n,s,t)&&(i.push(n),r.push(s))}return function(t,e){for(var i=t?e.length:0,s=i-1;i--;){var r=e[i];if(i==s||r!==o){var o=r;Fe(r)?Ws.call(t,r,1):Hs(t,r)}}}(t,r),i}var Is=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Hi(e,$i(t)),t=Re(t);return e}:Li;function Ps(t){return Wi(t,Je,Is)}var $s=Object.prototype.hasOwnProperty;var Ds=/\w*$/;var Xs=R?R.prototype:void 0,Ns=Xs?Xs.valueOf:void 0;var Ys="[object Boolean]",Gs="[object Date]",Fs="[object Map]",qs="[object Number]",Vs="[object RegExp]",Us="[object Set]",Ks="[object String]",Js="[object Symbol]",Qs="[object ArrayBuffer]",Zs="[object DataView]",tr="[object Float32Array]",er="[object Float64Array]",ir="[object Int8Array]",sr="[object Int16Array]",rr="[object Int32Array]",or="[object Uint8Array]",nr="[object Uint8ClampedArray]",hr="[object Uint16Array]",lr="[object Uint32Array]";function ar(t,e,i){var s,r,o,n=t.constructor;switch(e){case Qs:return je(t);case Ys:case Gs:return new n(+t);case Zs:return function(t,e){var i=e?je(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case tr:case er:case ir:case sr:case rr:case or:case nr:case hr:case lr:return Ee(t,i);case Fs:return new n;case qs:case Ks:return new n(t);case Vs:return(o=new(r=t).constructor(r.source,Ds.exec(r))).lastIndex=r.lastIndex,o;case Us:return new n;case Js:return s=t,Ns?Object(Ns.call(s)):{}}}var cr="[object Map]";var dr=Pt&&Pt.isMap,fr=dr?Ht(dr):function(t){return yt(t)&&vt(t)==cr},ur="[object Set]";var gr=Pt&&Pt.isSet,pr=gr?Ht(gr):function(t){return yt(t)&&vt(t)==ur},wr=1,br=2,vr=4,yr="[object Arguments]",mr="[object Function]",xr="[object GeneratorFunction]",Sr="[object Object]",Cr={};function kr(t,e,i,s,r,o){var n,h=e&wr,l=e&br,a=e&vr;if(i&&(n=r?i(t,s,r,o):i(t)),void 0!==n)return n;if(!X(t))return t;var c=Mt(t);if(c){if(n=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&$s.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(t),!h)return Oe(t,n)}else{var d=vt(t),f=d==mr||d==xr;if(Bt(t))return ze(t,h);if(d==Sr||d==yr||f&&!r){if(n=l||f?{}:Be(t),!h)return l?function(t,e){return Ne(t,Is(t),e)}(t,function(t,e){return t&&Ne(e,Je(e),t)}(n,t)):function(t,e){return Ne(t,$i(t),e)}(t,function(t,e){return t&&Ne(e,Di(e),t)}(n,t))}else{if(!Cr[d])return r?t:{};n=ar(t,d,h)}}o||(o=new pe);var u=o.get(t);if(u)return u;if(o.set(t,n),pr(t))return t.forEach(function(s){n.add(kr(s,e,i,s,t,o))}),n;if(fr(t))return t.forEach(function(s,r){n.set(r,kr(s,e,i,r,t,o))}),n;var g=a?l?Ps:Xi:l?keysIn:Di,p=c?void 0:g(t);return function(t,e){for(var i=-1,s=null==t?0:t.length;++i<s&&!1!==e(t[i],i,t););}(p||t,function(s,r){p&&(s=t[r=s]),Xe(n,r,kr(s,e,i,r,t,o))}),n}Cr[yr]=Cr["[object Array]"]=Cr["[object ArrayBuffer]"]=Cr["[object DataView]"]=Cr["[object Boolean]"]=Cr["[object Date]"]=Cr["[object Float32Array]"]=Cr["[object Float64Array]"]=Cr["[object Int8Array]"]=Cr["[object Int16Array]"]=Cr["[object Int32Array]"]=Cr["[object Map]"]=Cr["[object Number]"]=Cr[Sr]=Cr["[object RegExp]"]=Cr["[object Set]"]=Cr["[object String]"]=Cr["[object Symbol]"]=Cr["[object Uint8Array]"]=Cr["[object Uint8ClampedArray]"]=Cr["[object Uint16Array]"]=Cr["[object Uint32Array]"]=!0,Cr["[object Error]"]=Cr[mr]=Cr["[object WeakMap]"]=!1;var zr=1,Mr=4;for(var jr=function(t,e){return t(e={exports:{}},e.exports),e.exports}(function(t){var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var i=new Uint8Array(16);t.exports=function(){return e(i),i}}else{var s=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),s[e]=t>>>((3&e)<<3)&255;return s}}}),Er=[],Or=0;Or<256;++Or)Er[Or]=(Or+256).toString(16).substr(1);var Tr=function(t,e){var i=e||0,s=Er;return[s[t[i++]],s[t[i++]],s[t[i++]],s[t[i++]],"-",s[t[i++]],s[t[i++]],"-",s[t[i++]],s[t[i++]],"-",s[t[i++]],s[t[i++]],"-",s[t[i++]],s[t[i++]],s[t[i++]],s[t[i++]],s[t[i++]],s[t[i++]]].join("")};var Ar=function(t,e,i){var s=e&&i||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var r=(t=t||{}).random||(t.rng||jr)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e)for(var o=0;o<16;++o)e[s+o]=r[o];return e||Tr(r)},Rr=function(){return A.Date.now()},Br="Expected a function",_r=Math.max,Hr=Math.min;function Wr(t,e,i){var s,r,o,n,h,l,a=0,c=!1,d=!1,f=!0;if("function"!=typeof t)throw new TypeError(Br);function u(e){var i=s,o=r;return s=r=void 0,a=e,n=t.apply(o,i)}function g(t){var i=t-l;return void 0===l||i>=e||i<0||d&&t-a>=o}function p(){var t=Rr();if(g(t))return w(t);h=setTimeout(p,function(t){var i=e-(t-l);return d?Hr(i,o-(t-a)):i}(t))}function w(t){return h=void 0,f&&s?u(t):(s=r=void 0,n)}function b(){var t=Rr(),i=g(t);if(s=arguments,r=this,l=t,i){if(void 0===h)return function(t){return a=t,h=setTimeout(p,e),c?u(t):n}(l);if(d)return h=setTimeout(p,e),u(l)}return void 0===h&&(h=setTimeout(p,e)),n}return e=te(e)||0,X(i)&&(c=!!i.leading,o=(d="maxWait"in i)?_r(te(i.maxWait)||0,e):o,f="trailing"in i?!!i.trailing:f),b.cancel=function(){void 0!==h&&clearTimeout(h),a=0,s=l=r=h=void 0},b.flush=function(){return void 0===h?n:w(Rr())},b}var Lr=Math.max,Ir=Math.min;function Pr(t,e,i){return e=Os(e),void 0===i?(i=e,e=0):i=Os(i),function(t,e,i){return t>=Ir(e,i)&&t<Lr(e,i)}(t=te(t),e,i)}var $r="[object Number]";function Dr(t){return"number"==typeof t||yt(t)&&D(t)==$r}function Xr(t){return null==t}function Nr(t,e){return!(e[0][1]>t[1][1]||e[1][1]<t[0][1]||e[0][0]>t[1][0]||e[1][0]<t[0][0])}const Yr=()=>{};function Gr(t=0,e=0){return Array.from(new Array(e-t),(e,i)=>i+t)}function Fr(t){return parseInt(`${t}`,10).toString(26).split("").reduce((t,e)=>t+String.fromCharCode(parseInt(parseInt(e,26).toString(10),10)+65),"")}function qr(t,e){return Nr(t,e)?[[Math.min(t[0][0],e[0][0]),Math.min(t[0][1],e[0][1])],[Math.max(t[1][0],e[1][0]),Math.max(t[1][1],e[1][1])]]:t}function Vr(t,e){const i=[],s=e.map((i,s)=>t.substring(0===s?0:e[s-1],i));return s.push(t.substring(e[e.length-1])),s.forEach(t=>{t.split("/n").forEach(t=>{i.push(t)})}),i}function Ur(t,e,i){return t>=e&&t<=i||t>=i&&t<=e}function Kr(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y<=e.y+e.height&&t.y>=e.y}function Jr(t,e,i,s,r,o){return(r-t)*(s-e)==(i-t)*(o-e)&&Math.min(t,i)<=r&&r<=Math.max(t,i)&&Math.min(e,s)<=o&&o<=Math.max(e,s)}function Qr(t,e,i){t.addEventListener(e,i)}function Zr(t,e,i){t.removeEventListener(e,i)}function to(t){t.xclickoutside&&(Zr(window.document.body,"mousedown",t.xclickoutside),delete t.xclickoutside)}function eo(t,e=(t=>{t.hide()}),i=!0){t.xclickoutside=(s=>{2===s.detail||t.contains(s.target)||(e(t),i&&to(t))}),Qr(window.document.body,"mousedown",t.xclickoutside)}var io,so={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},ro=(io=Object.freeze({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",default:so}))&&io.default||io;const oo=function(t){return(e={exact:!0},(e=e||{}).exact?/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/:/rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)/gi).test(t);var e},no=function(t){return(e={exact:!0},(e=e||{}).exact?/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)$/:/rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)/gi).test(t);var e},ho=function(t){return(e={exact:!0},(e=e||{}).exact?/^hsl\(\s*(\d+)\s*,\s*(\d*(?:\.\d+)?%)\s*,\s*(\d*(?:\.\d+)?%)\)$/:/hsl\(\s*(\d+)\s*,\s*(\d*(?:\.\d+)?%)\s*,\s*(\d*(?:\.\d+)?%)\)/gi).test(t);var e},lo=function(t){return(e={exact:!0},(e=e||{}).exact?/^hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)$/:/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)/gi).test(t);var e},ao=function(t){return(e={exact:!0},(e=e&&"object"==typeof e?e:{}).strict?/^#([a-f0-9]{3,4}|[a-f0-9]{4}(?:[a-f0-9]{2}){1,2})\b$/i:/#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})\b/gi).test(t);var e},co=function(t){return ro.hasOwnProperty(t)},fo=function(t){return"inherit"===t},uo=function(t){return"currentColor"===t||"currentcolor"===t},go=function(t){return"transparent"===t};var po=function(t){return oo(t)||no(t)||ho(t)||lo(t)||ao(t)||co(t)||fo(t)||uo(t)||go(t)},wo=oo,bo=no,vo=ho,yo=lo,mo=ao,xo=co,So=fo,Co=uo,ko=go;po.isRgb=wo,po.isRgba=bo,po.isHsl=vo,po.isHsla=yo,po.isHex=mo,po.isKeyword=xo,po.isInherit=So,po.isCurrentColor=Co,po.isTransparent=ko;var zo=function(t){return/^(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset)$/i.test(t)};function Mo(t){const e={style:"none",color:"#000000",width:0};return t.split(" ").forEach(t=>{po(t)&&(e.color=t),function(t){return/^(\+|-)?([0-9]*\.)?[0-9]+(em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)$/i.test(t)||/^(\+|-)?(0*\.)?0+$/.test(t)}(t)&&(e.width=parseFloat(t)),zo(t)&&(e.style=t)}),e}const jo=new Map,Eo=new Map;function Oo(t){const e=jo.get(t);if(e)return new Promise(t=>{t(e)});const i=Eo.get(t)||new Promise((e,i)=>{const s=new Image;s.src=t,s.onload=(()=>{jo.set(t,s),e(s)}),s.onerror=(t=>{i(t)})});return Eo.set(t,i),i}function To(t){return jo.get(t)}var Ao=function(t,e,i,s){var r,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(r=t[h])&&(n=(o<3?r(n):o>3?r(e,i,n):r(e,i))||n);return o>3&&n&&Object.defineProperty(e,i,n),n};let Ro=(()=>{let t=class{constructor(t){this.mouseDownHandler=((t,e,i,s)=>{this.props.listeners&&this.props.listeners.forEach(r=>{var o;"CELL_MOUSE_DOWN"===r.eventName&&(null===(o=r.action)||void 0===o||o.call(this,t,e,i,s))})}),this.mouseLeaveHandler=((t,e,i,s)=>{this.props.listeners&&this.props.listeners.forEach(r=>{var o;"CELL_MOUSE_LEAVE"===r.eventName&&(null===(o=r.action)||void 0===o||o.call(this,t,e,i,s))})}),this.clickHandler=((t,e,i,s)=>{let r=!1;return this.props.listeners&&this.props.listeners.forEach(o=>{var n;"CELL_CLICK"===o.eventName&&(r=null===(n=o.action)||void 0===n?void 0:n.call(this,t,e,i,s))}),r}),this.hoverHandler=((t,e,i,s)=>{this.props.listeners&&this.props.listeners.forEach(r=>{var o;"CELL_HOVER"===r.eventName&&(null===(o=r.action)||void 0===o||o.call(this,t,e,i,s))})}),this.dbClickHandler=((t,e,i,s)=>{this.props.listeners&&this.props.listeners.forEach(r=>{var o;"CELL_DOUBLE_CLICK"===r.eventName&&(null===(o=r.action)||void 0===o||o.call(this,t,e,i,s))})}),this.props=t;const{x:e=0,y:i=0,width:s,height:r,top:o,left:n}=t;this.width=s,this.height=r,this.top=o||i,this.left=n||e,this.style=function(t){const{x:e=0,y:i=0,top:s,left:r,width:o,height:n,style:h={},autoWrapInfo:l}=t,{backgroundSize:a,backgroundImage:c,backgroundColor:d="",color:f="",textAlign:u,fontWeight:g="normal",fontFamily:p="SimSun",fontSize:b="9pt",fontStyle:v="normal",verticalAlign:y,border:m="",borderTop:x="",borderBottom:S="",borderLeft:C="",borderRight:k="",rotate:z,textShadow:M,underline:j,strikeThrough:E,lineHeight:O,subscript:T,supscript:A,newLine:R,verticalText:B,verTextDirection:_,cellJust:H}=h,W={};if(W.top=s||i,W.left=r||e,W.width=o,W.height=n,W.color=new w(f),W.textAlign=u,W.verticalAlign=y,W.fontWeight=g,W.fontSize=b,W.fontFamily=p,W.fontStyle=v,W.textShadow=M,W.underline=j,W.strikeThrough=E,W.lineHeight=O,W.subscript=T,W.supscript=A,W.backgroundColor=new w(d),W.backgroundImage=c,W.backgroundSize=a,m){const{width:t,style:e,color:i}=Mo(m);W.borderLeftWidth=W.borderTopWidth=W.borderBottomWidth=W.borderRightWidth=t,W.borderLeftStyle=W.borderTopStyle=W.borderBottomStyle=W.borderRightStyle=e,W.borderLeftColor=W.borderTopColor=W.borderBottomColor=W.borderRightColor=new w(i)}if(x){const{width:t,color:e,style:i}=Mo(x);W.borderTopWidth=t,W.borderTopStyle=i,W.borderTopColor=new w(e)}if(S){const{width:t,color:e,style:i}=Mo(S);W.borderBottomWidth=t,W.borderBottomStyle=i,W.borderBottomColor=new w(e)}if(C){const{width:t,color:e,style:i}=Mo(C);W.borderLeftWidth=t,W.borderLeftStyle=i,W.borderLeftColor=new w(e)}if(k){const{width:t,color:e,style:i}=Mo(k);W.borderRightWidth=t,W.borderRightStyle=i,W.borderRightColor=new w(e)}return W.rotate=z,W.newLine=R,W.verticalText=B,W.verTextDirection=_,W.cellJust=H,W.autoWrapInfo=l&&JSON.parse(`${l}`),W}(t)}getBounds(){return{left:this.left,top:this.top,right:this.left+this.width,bottom:this.top+this.height,width:this.width,height:this.height}}getChildren(){}getStyle(){return this.style}getText(){}getRealWidth(){return this.width}};return t=Ao([s("bi.widget")],t)})();var Bo=function(t,e,i,s){var r,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(r=t[h])&&(n=(o<3?r(n):o>3?r(e,i,n):r(e,i))||n);return o>3&&n&&Object.defineProperty(e,i,n),n};(()=>{let t=class extends Ro{constructor(t){super(t);const{text:e}=t;this.text=e}getText(){return this.text}getRealWidth(){return function(t,e){const i=document.createElement("canvas").getContext("2d",{alpha:!1});return y(i,e),i.measureText(t)}(this.getText()||"",this.style).width}};t=Bo([s("bi.label")],t)})();var _o=function(t,e,i,s){var r,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(r=t[h])&&(n=(o<3?r(n):o>3?r(e,i,n):r(e,i))||n);return o>3&&n&&Object.defineProperty(e,i,n),n};(()=>{let t=class extends Ro{constructor(t){super(t)}getChildren(){return[r({type:"bi.widget",width:5,height:8,left:this.left,top:this.top,style:{rotate:"45",borderBottom:"2px solid #000",borderRight:"2px solid #000"}})]}};t=_o([s("bi.checkbox")],t)})();class Ho extends Ro{getChildren(){return this.children}getRealWidth(){return this.getChildren().reduce((t,e)=>e.getRealWidth()+t,0)}}var Wo=function(t,e,i,s){var r,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(r=t[h])&&(n=(o<3?r(n):o>3?r(e,i,n):r(e,i))||n);return o>3&&n&&Object.defineProperty(e,i,n),n};(()=>{let t=class extends Ho{constructor(t){super(t),this.clickHandler=((t,e,i,s)=>{for(let r=0;r<this.children.length;r++){const o=this.children[r].getBounds();if(o.left<=e&&o.right>e)return this.children[r].clickHandler.call(null,t,e,i,s)}return!0}),this.items=t.items||[],this.children=[],this.digest()}digest(){const t=this.getBounds();let e=0;const i=t.width-this.items.reduce((t,e)=>t+(parseFloat(e.width)||0),0);this.children=this.items.map(s=>{const o=s.el;return o.top=t.top,o.left=t.left+e,s.width?o.width=s.width:o.width=i,o.height=t.height,e+=o.width,r(o)})}};t=Wo([s("bi.htape")],t)})();var Lo=function(t,e,i,s){var r,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(r=t[h])&&(n=(o<3?r(n):o>3?r(e,i,n):r(e,i))||n);return o>3&&n&&Object.defineProperty(e,i,n),n};let Io=(()=>{let t=class extends Ho{constructor(t){super(t),this.clickHandler=((t,e,i,s,r)=>{let o=!1;for(let o=0;o<this.children.length;o++){const n=this.children[o].getBounds(),{x:h}=r||{x:e};if(n.left<=h&&n.right>h)return this.children[o].clickHandler.call(null,t,e,i,s)}return this.props.listeners&&this.props.listeners.forEach(r=>{"CELL_CLICK"===r.eventName&&(o=r.action.call(this,t,e,i,s))}),o}),this.items=t.items||[],this.children=[],this.digest()}digest(){const t=this.getBounds();this.children=this.items.map(e=>{const i=e.el;return i.top=t.top+(e.top||0),i.left=t.left+(e.left||0),i.right=t.right-(e.right||0),i.bottom=t.bottom-(e.bottom||0),"bi.label"===i.type?(i.width=i.right-i.left,i.height=i.bottom-i.top):(i.width=t.width,i.height=t.height),r(i)})}};return t=Lo([s("bi.absolute")],t)})();var Po=function(t,e,i,s){var r,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(r=t[h])&&(n=(o<3?r(n):o>3?r(e,i,n):r(e,i))||n);return o>3&&n&&Object.defineProperty(e,i,n),n},$o=function(t,e){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(i[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(i[s[r]]=t[s[r]])}return i};(()=>{let t=class extends Ro{constructor(t){super(t);const e=t.icon||{},{width:i,height:s,size:r=16,backgroundColor:o,top:n,left:h}=e,l=$o(e,["width","height","size","backgroundColor","top","left"]);this.iconStyle=Object.assign({width:i||r,height:s||r,size:r,backgroundColor:o||"",top:n,left:h},l)}getChildren(){if(this.children)return this.children;const t=this.iconStyle,{width:e,height:i,text:s,size:o,backgroundColor:n,top:h=0,left:l=0}=t,a=$o(t,["width","height","text","size","backgroundColor","top","left"]),{left:c,right:d,height:f,top:u,bottom:g}=this.getBounds();return this.children=[r({type:"bi.absolute",left:c,top:u+(f-i)/2,bottom:g-(f-i)/2,right:d,style:{backgroundColor:n},width:e,height:i,items:[{el:{type:"bi.label",style:Object.assign(Object.assign({},a),{lineHeight:i-1,fontSize:`${o}px`,verticalAlign:"middle"}),width:e,height:i,text:s},left:l,top:h,bottom:-h,right:-l,width:e,height:i}]})],this.children}getRealWidth(){return this.getChildren().reduce((t,e)=>e.getRealWidth()+t,0)}};t=Po([s("bi.icon")],t)})();var Do=function(t,e,i,s){var r,o=arguments.length,n=o<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(r=t[h])&&(n=(o<3?r(n):o>3?r(e,i,n):r(e,i))||n);return o>3&&n&&Object.defineProperty(e,i,n),n};class Xo extends Io{adjustAndGenerate(t){let e=t;const i=this.getBounds();this.children=this.items.map((t,s)=>{const o=t.el;o.top=i.top+(t.top||0),o.left=e+(t.left||0);const n=this.children[s].getRealWidth();return o.width=0===s?n:Math.min(i.width-(e-i.left)-(t.left||0),n),o.height=this.children[s].height,e+=o.width+(t.left||0),r(o)})}}(()=>{let t=class extends Xo{digest(){super.digest();const t=this.getBounds().left;this.adjustAndGenerate(t)}};t=Do([s("bi.flow_left")],t)})(),(()=>{let t=class extends Xo{digest(){super.digest();const t=this.getBounds(),e=this.children.reduce((t,e,i)=>e.getRealWidth()+this.items[i].left+t,0),i=Math.max((t.width-e)/2,0)+t.left;this.adjustAndGenerate(i)}};t=Do([s("bi.flow_center")],t)})(),(()=>{let t=class extends Xo{digest(){super.digest();const t=this.getBounds(),e=this.children.reduce((t,e,i)=>e.getRealWidth()+this.items[i].left+t,0),i=Math.max(t.width-e,0)+t.left;this.adjustAndGenerate(i)}};t=Do([s("bi.flow_right")],t)})();const No=30,Yo=80,Go=.5;class Fo{constructor(t){this.hoverCellX=-1,this.hoverCellY=-1,this.loadData(t),this.digest()}doMouseDown(t,e,i){const s=this.getMergeCell(e.ri,e.ci),o=r(s);window.setTimeout(()=>{o.mouseDownHandler.call(null,t,e.x,e.y,s,i)},0)}doMouseLeave(t,e,i){const s=this.getMergeCell(e.ri,e.ci),o=r(s);window.setTimeout(()=>{o.mouseLeaveHandler.call(null,t,e.x,e.y,s,i)},0)}doClick(t,e,i){const s=this.getMergeCell(e.ri,e.ci),o=r(s);window.setTimeout(()=>{o.clickHandler.call(null,t,e.x,e.y,s,i)},0)}doDbClick(t,e,i){const s=this.getMergeCell(e.ri,e.ci),o=r(s);window.setTimeout(()=>{o.dbClickHandler&&o.dbClickHandler.call(null,t,e.x,e.y,s,i)},0)}doHover(t,e,i){const s=this.getMergeCell(e.ri,e.ci);if(this.hoverCellX===e.ri&&this.hoverCellY===e.ci)return;this.hoverCellX=e.ri,this.hoverCellY=e.ci;const o=r(s);window.setTimeout(()=>{o.hoverHandler&&o.hoverHandler.call(null,t,e.x,e.y,s,i)},0)}disHover(){if(-1===this.hoverCellX&&-1===this.hoverCellY)return;const t=r(this.getMergeCell(this.hoverCellX,this.hoverCellY));this.hoverCellX=-1,this.hoverCellY=-1,window.setTimeout(()=>{t.hoverHandler&&t.hoverHandler.call(null)},0)}getSumHeight(t=0,e=this.rowc){let i=0;t=Math.max(0,t),e=Math.min(e,this.rowc);for(let s=t;s<e;s++)i+=this.getRowHeight(s);return i}getSumWidth(t=0,e=this.colc){let i=0;t=Math.max(0,t),e=Math.min(e,this.colc);for(let s=t;s<e;s++)i+=this.getColWidth(s);return i}getRowHeight(t){return Xr(this.rows[t])?No:this.rows[t]}getColWidth(t){return Xr(this.cols[t])?Yo:this.cols[t]}getCellsInRange(t){const e=[],[i,s]=t;for(let t=i[1];t<=s[1];t++)for(let r=s[0];r>=i[0];r--){const i=this.getMergeCell(t,r);e.push(Object.assign(Object.assign({},i),{x:i.x+Go,y:i.y+Go}))}return e}getCellSquareInRange(t){const e=[],[i,s]=t;for(let t=i[1];t<=s[1];t++){const r=[];for(let e=i[0];e<=s[0];e++){const i=this.getMergeCell(t,e);r.push(Object.assign(Object.assign({},i),{x:i.x+Go,y:i.y+Go}))}e.push(r)}return e}getRangeBounds(t){let e=0,i=0,s=0,r=0;const[o,n]=t;for(let t=0;t<=n[1];t++)t===o[1]&&(r=e),e+=this.getRowHeight(t);for(let t=0;t<=n[0];t++)t===o[0]&&(s=i),i+=this.getColWidth(t);return{x:s,y:r,width:i-s,height:e-r}}getCellIndexs(t,e){let i=0,s=0,r=0,o=0;for(let t=0;t<this.rowc;t++){if(e<=(s+=this.getRowHeight(t))){r=t;break}r=t}for(let e=0;e<this.colc;e++){if(t<=(i+=this.getColWidth(e))){o=e;break}o=e}return[o,r]}getCellPoistion(t,e){return{x:this.getSumWidth(0,e),y:this.getSumHeight(0,t)}}getCellBounds(t,e){return{x:this.getSumWidth(0,e),y:this.getSumHeight(0,t),width:this.getColWidth(e),height:this.getRowHeight(t)}}findMergeRange(t,e){return Rs(this.merges,i=>{const[s,r]=i;return t>=s[1]&&t<=r[1]&&e>=s[0]&&e<=r[0]})||[[e,t],[e,t]]}getCellArea(t,e,i,s){return[this.getMergeCell(t,e),this.getMergeCell(i,s)]}getCell(t,e){const i=this.data[t]&&this.data[t][e]||null;return Object.assign(Object.assign(Object.assign({valid:null!==i,x:0,y:0},i),this.getCellBounds(t,e)),{ri:t,ci:e})}getViewData(){return this.data}isHoverText(t,e,i){return(t.textArea||[]).some(s=>t.x+s.x<=e&&t.y+s.y<=i&&t.x+s.x+s.width>=e&&t.y+s.y+s.height>=i)}getMergeCell(t,e){const[i,s]=this.findMergeRange(t,e);return Object.assign(Object.assign({},this.getCell(i[1],i[0])),{ri:i[1],ci:i[0],width:this.getSumWidth(i[0],s[0]+1),height:this.getSumHeight(i[1],s[1]+1),rp:s[1]-i[1],cp:s[0]-i[0]})}updateCell(t,e,i){this.data[t]&&(this.data[t][e]=i)}getStickers(){return this.stickers}setRowHeight(t,e){this.rows[t]=e,this.digest()}setColWidth(t,e){this.cols[t]=e,this.digest()}insertRows(t,e,i){const{rows:s}=i;this.rowc+=e.length,this.rows.splice(t,0,...s),this.data.splice(t,0,...e),t<this.freeze[1]&&(this.freeze[1]+=e.length),this.updateMerges(t,e.length,0,0),this.updateStickers(t,e.length,0,0),this.digest()}deleteRows(t,e){this.rowc=Math.max(t,this.rowc-e),this.rows.splice(t,e),this.data.splice(t,e),this.updateMerges(t,-e,0,0),this.updateStickers(t,-e,0,0),this.digest()}inserCols(t,e,i){const{cols:s}=i;this.colc+=e.length,this.cols.splice(t,0,...s),this.data.forEach((i,s)=>{i.splice(t,0,...e[s])}),t<this.freeze[0]&&(this.freeze[0]+=e.length),this.updateMerges(0,0,t,e.length),this.updateStickers(0,0,t,e.length),this.digest()}deleteCols(t,e){this.colc=Math.max(t,this.colc-e),this.cols.splice(t,e),this.data.forEach(i=>{i.splice(t,e)}),this.updateMerges(0,0,t,e),this.updateStickers(0,0,t,e),this.digest()}digest(){this.totalWidth=this.getSumWidth(),this.totalHeight=this.getSumHeight(),this.freezeWidth=this.getSumWidth(0,this.freeze[0]),this.freezeHeight=this.getSumHeight(0,this.freeze[1])}loadData(t){const{colc:e,rowc:i,cols:s,rows:r,data:o,freeze:n,merges:h,styles:l,stickers:a}=t;this.colc=e,this.rowc=i,this.cols=s||[],this.rows=r||[],this.cols.length=e,this.rows.length=i,this.freeze=n||[0,0],this.data=o||[],this.merges=h||[],this.styles=l||[],this.stickers=(a||[]).map(t=>(t.id=t.id||Ar(),t)),this.digest()}updateMerges(t,e,i,s){this.merges.forEach(r=>{const[o,n]=r;o[0]>=i&&(o[0]+=s),o[1]>=t&&(o[1]+=e),n[0]>=i&&(n[0]+=s),n[1]>=t&&(n[1]+=e)})}updateStickers(t,e,i,s){this.stickers.forEach(r=>{const{position:o}=r;"row"in o&&"col"in o&&(o.row>t&&o.row<=t-e||o.col>i&&o.col<=i-s?r.tag="delete":r.tag="normal",o.col>=i&&(o.col+=s),o.row>=t&&(o.row+=e)),"x"in o&&"y"in o&&(o.x>=i&&(o.x+=s),o.y>=t&&(o.y+=e))})}getSelctionRange(t,e,i,s){if(!this.data[0])return[];const r=this.data[0].length,o=[];let n=e,h=t;for(;n<=s&&!(n===s&&h>i);){const t=this.getCell(n,h);t&&o.push(t),h===r?(n++,h=0):h++}return o}reset(){this.getViewData().forEach(t=>{t.forEach(t=>{(t||t.textArea)&&(t.textArea=[])})})}}const qo={sheet:{colc:0,rowc:0},scroll:{x:0,y:0,sr:0,sc:0,er:0,ec:0},selection:{},selectable:!1,width:0,height:0,topSequnce:{enable:!1,size:30},leftSequnce:{enable:!1,size:80},offsetX:0,offsetY:0,align:!1},Vo=[-1,-1];class Uo{constructor(){this.start={x:0,y:0},this.end={x:0,y:0},this.selectedTexts=[],this.reset()}selectCell(t,e,i){this.cell=[e,t],this.range=[Vo,Vo],this.start=i}selectRange(t,e,i,s,r){this.cell===Vo&&(this.cell=[0,0]),this.range=[[e,t],[s,i]],this.end=r}getCell(){return this.cell}getRange(){return[this.range[0]===Vo?this.cell:this.range[0],this.range[1]===Vo?this.cell:this.range[1]]}getPosition(){return this.start.y>this.end.y?{start:this.end,end:this.start}:this.start.y===this.end.y&&this.start.x>this.end.x?{start:this.end,end:this.start}:{start:this.start,end:this.end}}reset(){this.cell=Vo,this.range=[Vo,Vo],this.start={x:0,y:0},this.end={x:0,y:0},this.setSelectedTexts([])}setSelectedTexts(t){this.selectedTexts=t}getSelectedTexts(){return this.selectedTexts}}class Ko{constructor(t="sheet",e){this.name=t,this.selection=new Uo,this.options=Object.assign(Object.assign({},kr(qo,zr|Mr)),e),this.view=new Fo(this.options.sheet),this.scroll=this.options.scroll,this.scroll.x=isNaN(this.scroll.x)?0:this.scroll.x,this.scroll.y=isNaN(this.scroll.y)?0:this.scroll.y,this.update()}getRenderBounds(t){const e=this.view.freezeWidth,i=this.view.freezeHeight;return"horizontal"===t?{x:e,y:0,width:this.width-e,height:this.options.height}:{x:0,y:i,width:this.width,height:this.options.height-i}}select(t,e,i,s,r){if(void 0!==i&&void 0!==s){const[[o,n],[h,l]]=this.correctSelectRange(t,e,i,s);this.selection.selectRange(n,o,l,h,r)}else this.selection.selectCell(t,e,r)}scrollTo(t,e,i){this.sc(t,e,i)}scrollX(t,e){t=ee(t,0,this.maxScrollX),this.sc(t,this.scroll.y,e)}scrollY(t,e){t=ee(t,0,this.maxScrollY),this.sc(this.scroll.x,t,e)}getViewRange(){return[this.view.getCellIndexs(this.scroll.x,this.scroll.y),this.view.getCellIndexs(this.scroll.x+this.width,this.scroll.y+this.height)]}getScrollRange(){return[this.view.getCellIndexs(this.scroll.x+this.view.freezeWidth,this.scroll.y+this.view.freezeHeight),this.view.getCellIndexs(this.scroll.x+this.width,this.scroll.y+this.height)]}getViewBounds(){return{width:this.width,height:this.height}}getScroll(){return this.scroll}getCellIndexs(t,e){const i=this.view.freezeWidth,s=this.view.freezeHeight;t>i&&(t+=this.scroll.x),e>s&&(e+=this.scroll.y);const r=this.view.getCellIndexs(t,e),o=this.view.getMergeCell(r[1],r[0]);return[o.ci,o.ri]}getCellByOffset(t,e){if(t<this.offset.offsetX||e<this.offset.offsetY)return null;{const{x:i,y:s}=this.getPositionByOffset(t,e),r=this.view.getCellIndexs(i,s);return this.view.getMergeCell(r[1],r[0])}}getPositionByOffset(t,e){const i=this.view.freezeWidth,s=this.view.freezeHeight;return t-=this.offset.offsetX,e-=this.offset.offsetY,t>i&&(t+=this.scroll.x),e>s&&(e+=this.scroll.y),{x:t,y:e}}updateCell(t,e,i){this.view.updateCell(t,e,i)}getCellIndexsByOffset(t,e){const{offsetX:i,offsetY:s}=this.offset;if(t>=i&&e>=s&&(e-=s,(t-=i)<=this.view.totalWidth&&e<=this.view.totalHeight)){const[i,s]=this.getCellIndexs(t,e);return!1===this.view.getCell(s,i).valid?null:[i,s]}}getFreezeBounds(){return[{x:this.view.freezeWidth,y:0,width:this.width-this.view.freezeWidth,height:this.view.freezeHeight},{x:0,y:this.view.freezeHeight,width:this.view.freezeWidth,height:this.height-this.view.freezeHeight},{x:0,y:0,width:this.view.freezeWidth,height:this.view.freezeHeight}]}cellIsFreezed(t){return{horizontalFreezed:t.y+t.height<=this.view.freezeHeight,verticalFreezed:t.x+t.width<=this.view.freezeWidth}}getCellsInBounds(t,e,i,s){let r=[],o=[];if(t=Math.max(t,0),e=Math.max(e,0),i=Math.min(i,this.width-t),s=Math.min(s,this.height-e),t<this.view.freezeWidth&&e<this.view.freezeHeight){r=this.view.getCellsInRange([this.view.getCellIndexs(t,e),this.view.getCellIndexs(this.view.freezeWidth,this.view.freezeHeight)])}else t<this.view.freezeWidth?r=this.view.getCellsInRange([this.view.getCellIndexs(t,e+this.scroll.y),this.view.getCellIndexs(this.view.freezeWidth,e+this.scroll.y+s)]):e<this.view.freezeHeight?r=this.view.getCellsInRange([this.view.getCellIndexs(t+this.scroll.x,e),this.view.getCellIndexs(t+this.scroll.x+i,this.view.freezeHeight)]):o=this.view.getCellsInRange([this.view.getCellIndexs(t+this.scroll.x,e+this.scroll.y),this.view.getCellIndexs(t+this.scroll.x+i,s+e+this.scroll.y)]);const n=new Set,h=[];return Array.prototype.concat(o,r).reduce((t,e)=>{const i=`${e.ci}-${e.ri}`;return n.has(i)?t:(n.add(i),t.push(this.correctBounds(e)),t)},h),h}getCellBounds(t,e){const i=this.view.freeze,s=this.view.getCellBounds(t,e);return t>i[1]&&(s.y-=this.scroll.y),e>i[0]&&(s.x-=this.scroll.x),s}getCell(t,e){return Object.assign(Object.assign({},this.getCellBounds(t,e)),{ri:t,ci:e})}getMergeCells(){return this.view.merges.map(t=>{const[e]=t,i=this.view.getRangeBounds(t);return this.correctBounds(Object.assign(Object.assign(Object.assign({},this.view.getCell(e[1],e[0])),i),{x:i.x+.5,y:i.y+.5}))})}getRangeBounds(t){return this.view.getRangeBounds(t)}correctDeltaY(t){if(!t)return t;const e=this.scroll.y+t;if(e<=0)return-this.scroll.y;if(e>=this.maxScrollY)return this.maxScrollY-this.scroll.y;if(!this.options.align)return t;const i=e+this.view.freezeHeight;let s=this.view.freezeHeight,r=e;for(let t=this.view.freeze[1];t<this.view.rowc;t++){const e=this.view.getRowHeight(t);if(i>=s&&i<s+e){r=i>s+e/2?s+e:s;break}s+=e}return r-this.scroll.y-this.view.freezeHeight}correctDeltaX(t){if(!t)return t;const e=this.scroll.x+t;if(e<=0)return-this.scroll.x;if(e>=this.maxScrollX)return this.maxScrollX-this.scroll.x;if(!this.options.align)return t;const i=e+this.view.freezeWidth;let s=this.view.freezeWidth,r=e;for(let t=this.view.freeze[0];t<this.view.colc;t++){const e=this.view.getColWidth(t);if(i>=s&&i<s+e){r=i>s+e/2?s+e:s;break}s+=e}return r-this.scroll.x-this.view.freezeWidth}getSequnceCells(){const[[t,e],[i,s]]=this.selection.getRange();let r=[],o=[];const[n,h]=this.view.getCellArea(e,t,s,i),l=Math.min(n.ci,h.ci),a=Math.max(n.ci+n.cp,h.ci+h.cp),c=Math.min(n.ri,h.ri),d=Math.max(n.ri+n.rp,h.ri+h.rp);return this.options.topSequnce.enable&&(r=Array.prototype.concat(Gr(this.scroll.sc,this.scroll.ec+1),Gr(0,this.view.freeze[0])).map(t=>{const e=this.getCellBounds(0,t);return Object.assign(Object.assign({},e),{x:e.x+.5,y:e.y-this.offset.offsetY+.5,width:this.view.getColWidth(t),height:this.offset.offsetY,type:"bi.label",text:Fr(t),ri:-1,ci:t,style:{color:"#5f6368",backgroundColor:Ur(t,l,a)?"#e8eaed":"#f8f9fa"}})})),this.options.leftSequnce.enable&&(o=Array.prototype.concat(Gr(this.scroll.sr,this.scroll.er+1),Gr(0,this.view.freeze[1])).map(t=>{const e=this.getCellBounds(t,0);return Object.assign(Object.assign({},e),{x:e.x-this.offset.offsetX+.5,y:e.y+.5,width:this.offset.offsetX-.5,height:this.view.getRowHeight(t)-.5,type:"bi.label",text:t+1,ci:-1,ri:t,style:{color:"#5f6368",backgroundColor:Ur(t,c,d)?"#e8eaed":"#f8f9fa"}})})),Array.prototype.concat(r,o)}isInSticker(t,e){return this.getStickers().some(i=>i.left<=t&&i.left+i.width>=t&&i.top<=e&&i.top+i.height>=e)}getStickers(){return this.view.getStickers().map(t=>{const{el:e,position:i,id:s,tag:r,init:o,lazy:n}=t;let h=0,l=0,a=0,c=0;if("x"in i&&(l=i.x,h=i.y,a=i.width,c=i.height),"col"in i&&"row"in i){const[t,e]=this.view.findMergeRange(i.row,i.col),s=this.getStickerBounds(i.row,i.col);l=s.x,h=s.y,a=this.view.getSumWidth(t[0],e[0]+1),c=this.view.getSumHeight(t[1],e[1]+1)}return{id:s,top:h,left:l,width:a,height:c,el:e,tag:r,init:o,lazy:n}})}getStickerBounds(t,e){return this.view.getCellBounds(t,e)}getResizerCell(t,e){const i=t>this.offset.offsetX,s=i?t-this.offset.offsetX:t,r=i?e:e-this.offset.offsetY,o=this.getCellIndexs(s,r),n=this.getCellBounds(o[1],o[0]);let h,l;return i?s-n.x<n.x+n.width-s?(h=[o[0],Math.max(o[1]-1,0)],l=this.getCellBounds(h[1],h[0])):(h=o,l=n):r-n.y<n.y+n.height-r?(h=[Math.max(o[0]-1,0),o[1]],l=this.getCellBounds(h[1],h[0])):(h=o,l=n),Object.assign(Object.assign({},l),{ri:h[1],ci:h[0],left:i?l.x+this.offset.offsetX:l.x,top:i?l.y:l.y+this.offset.offsetY,width:i?l.width:this.offset.offsetX,height:i?this.offset.offsetY:l.height})}getSelectCell(){const[t,e]=this.selection.getCell();return this.view.getMergeCell(e,t)}getSelectRangeCells(){return this.view.getCellSquareInRange(this.getSelectRange())}getSelectRange(){const[[t,e],[i,s]]=this.selection.getRange(),r=this.view.getMergeCell(e,t),o=this.view.getMergeCell(s,i),n=Math.min(r.ci,o.ci),h=Math.max(r.ci+r.cp,o.ci+o.cp);return[[n,Math.min(r.ri,o.ri)],[h,Math.max(r.ri+r.rp,o.ri+o.rp)]]}transformPosition(t,e,i){const[[s,r],[o,n]]=this.selection.getRange(),h=i.ci===s&&i.ri===r,l=i.ci===o&&i.ri===n,a=this.getCellPosition({row:i.ri,col:i.ci},this.view.merges);if(h&&l){return(i.textArea||[]).some(s=>i.y+s.y<=t.y&&i.y+s.y+s.height>=t.y&&i.y+s.y<=e.y&&i.y+s.y+s.height>=e.y)&&t.x>e.x?[e,t]:[t,e]}return h?(!Kr(t,{x:i.x,y:i.y,width:a.width,height:a.height})&&([t,e]=[e,t]),[t,{x:i.x+a.width,y:i.y+i.height}]):l?(!Kr(e,{x:i.x,y:i.y,width:a.width,height:a.height})&&([t,e]=[e,t]),[{x:i.x,y:i.y},e]):[{x:i.x,y:i.y},{x:i.x+a.width,y:i.y+a.height}]}getSelectBounds(){const[[t,e],[i,s]]=this.selection.getRange(),{start:r,end:o}=this.selection.getPosition(),n=this.view.getSelctionRange(t,e,i,s),h=[],l=new Map;return n.forEach(n=>{const a=n.ci===t&&n.ri===e,c=n.ci===i&&n.ri===s,d=a||c,f=this.offset2Absolute(r,n),u=this.offset2Absolute(o,n),[g,p]=this.transformPosition(f,u,n);let w="";(n.textArea||[]).forEach(({x:t,y:e,width:i,height:s,text:r})=>{r&&(!d||(n.y+e<g.y?n.y+e+s>g.y:n.y+e<p.y)&&(!(n.y+e<g.y)||n.x+t+i>g.x)&&(!(n.y+e+s>p.y)||n.x+t<p.x))&&(h.push(this.spliteBounds(t+n.x,e+n.y,t+n.x+i,e+n.y+s)),w+=r)}),w&&l.set(n.y,(l.get(n.y)||[]).concat([w]))}),this.selection.setSelectedTexts(Array.from(l.values())),h}offset2Absolute({x:t,y:e},i){let[s,r]=[t,e];const{x:o,y:n}=this.getScroll(),{verticalFreezed:h,horizontalFreezed:l}=this.cellIsFreezed(i);return!l&&(r+=n),!h&&(s+=o),{x:s,y:r}}getQuadrantBounds(t,e){const i=this.view.freezeWidth+1,s=this.view.freezeHeight+1,r=e<s,o=t<i;return{x:o?0:i,y:r?0:s,width:o?i:this.width-i,height:r?s:this.height-s}}spliteBounds(t,e,i,s){const r=[],o=this.view.freezeWidth,n=this.view.freezeHeight;return r.push({x:t,y:e,width:Math.min(o-t,i-t),height:Math.min(n-e,s-t)}),r.push({x:Math.max(o,t),y:e,width:i-Math.max(o,t),height:Math.min(n-e,s-e)}),r.push({x:t,y:Math.max(n,e),width:Math.min(o-t,i-t),height:s-Math.max(n,e)}),r.push({x:Math.max(o,t),y:Math.max(n,e),width:i-Math.max(o,t),height:s-Math.max(n,e)}),r}setOffset(t){const{offsetX:e,offsetY:i}=t;this.offset=t,this.width=this.width-e,this.height=this.height-i,this.update()}resizeRow(t,e){this.view.setRowHeight(t,e),this.updateMaxScroll(),this.updateScrollRange()}resizeCol(t,e){this.view.setColWidth(t,e),this.updateMaxScroll(),this.updateScrollRange()}insertRows(t,e,i){this.view.insertRows(t,e,i),this.update()}insertCols(t,e,i){this.view.inserCols(t,e,i),this.update()}deleteRows(t,e){this.view.deleteRows(t,e),this.update()}deleteCols(t,e){this.view.deleteCols(t,e),this.update()}setData(t){this.options=Object.assign(Object.assign(Object.assign({},qo),this.options),t),this.view.loadData(this.options.sheet),this.scroll=this.options.scroll,this.update()}resize(t,e){this.options.width=t||this.options.width,this.options.height=e||this.options.height,this.view.reset(),this.update()}reset(){this.clearSelection()}update(){this.updateOffset(),this.updateMaxScroll(),this.updateScrollRange()}correctBounds(t){const{x:e,y:i}=t,s=this.view.freezeWidth,r=this.view.freezeHeight;return Object.assign(Object.assign({},t),{x:e>=s?e-this.scroll.x:e,y:i>=r?i-this.scroll.y:i,ox:e,oy:i})}clearSelection(){this.selection.reset()}sc(t,e,i){const s=Object.assign({},this.scroll);this.scroll.x=t,this.scroll.y=e,this.updateScrollRange(),i&&i(this.scroll,s)}updateScrollRange(){this.scroll.x=Math.ceil(Math.min(this.scroll.x,this.maxScrollX)),this.scroll.y=Math.ceil(Math.min(this.scroll.y,this.maxScrollY));const[t,e]=this.getScrollRange();this.scroll.sr=t[1],this.scroll.sc=t[0],this.scroll.er=e[1],this.scroll.ec=e[0]}updateOffset(){this.offset={offsetX:(this.options.leftSequnce.enable?this.options.leftSequnce.size:0)+this.options.offsetX,offsetY:(this.options.topSequnce.enable?this.options.topSequnce.size:0)+this.options.offsetY},this.width=this.options.width-this.offset.offsetX,this.height=this.options.height-this.offset.offsetY}updateMaxScroll(){const{width:t,height:e}=this.getMaxScrollBounds();this.maxScrollX=Math.ceil(t),this.maxScrollY=Math.ceil(e)}getMaxScrollBounds(){let t=0,e=0;if(!this.options.align)return{width:Math.max(this.view.totalWidth-this.width,0),height:Math.max(this.view.totalHeight-this.height,0)};for(let e=this.view.rowc-1;e>=0;e--){const i=this.view.getRowHeight(e);if(t+i>this.height-this.view.freezeHeight)break;t+=i}for(let t=this.view.colc-1;t>=0;t--){const i=this.view.getColWidth(t);if(e+i>this.width-this.view.freezeWidth)break;e+=i}return{width:Math.max(this.view.totalWidth-this.view.freezeWidth-e,0),height:Math.max(this.view.totalHeight-this.view.freezeHeight-t,0)}}correctSelectRange(t,e,i,s){t>i&&([t,i]=[i,t],[e,s]=[s,e]),t===i&&e>s&&([e,s]=[s,e]);let r=[[e,t],[s,i]],o=[[e,t],[s,i]];for(;!Bs(r,o);){r=o;let t=o;this.view.merges.forEach(e=>{t=qr(t,e)}),o=t}return o}getCellPosition(t,e){const i=e.find(e=>e.findIndex(e=>2===e.length&&e[0]===t.col&&e[1]===t.row)>=0);return i?this.view.getRangeBounds(i):this.view.getCellBounds(t.row,t.col)}}function Jo(t,i,s){const r=b();return t.width=Math.round(i*r),t.height=Math.round(s*r),e(t).offset({width:t.width/r,height:t.height/r}),t.getContext("2d").setTransform(r,0,0,r,0,0),t}class Qo{constructor(t,e){const i=b();this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.ctx.setTransform(i,0,0,i,0,0)}drawText(t,e,i,s,r,o){this.text(t,e,i,s,r,o)}wrapText({text:t,x:e,y:i,width:s,height:r,lineHeight:o,options:n},h){this.ctx.save();const{verticalAlign:l,clip:a,fontStyle:c,fontWeight:d,fontFamily:f,verticalText:u,textAlign:g}=n;let{fontSize:p}=n;a&&(this.ctx.beginPath(),this.ctx.rect(e,i,s,r),this.ctx.clip(),this.ctx.beginPath()),y(this.ctx,{fontFamily:f,fontSize:p,fontStyle:c,fontWeight:d}),o=o||1.2*parseFloat(p);let w=[];const b=this.makeLineTextOpts(p,t,e,i,s,r,o,n);if(w=b.textOpts,p=b.fontSize,o=b.lineHeight,"VERTICAL_TEXT"===u){const t=o*w.length;w.forEach((e,i)=>{const{text:r,width:n,height:a,options:u}=e;let{x:b,y:v}=e;switch(g){case"left":break;case"center":b+=(s-t)/2;break;case"right":b+=s-t;break;case"distributed":b+=(s-t)/(w.length-1)*i}const y=Math.floor(a/o);switch(l){case"middle":v+=Math.floor((y-r.length)/2)*o;break;case"bottom":v+=(y-r.length)*o}if(this.textVertical(r,b,v,n,a,Object.assign(Object.assign({},u),{verticalAlign:l,fontFamily:f,fontSize:p,fontWeight:d,fontStyle:c,lineHeight:o,clip:!1}),h),0===i){const t=w.reduce((t,e)=>Math.max(t,e.text.length),0),i=w.length,{baseline:s}=x({fontFamily:f,fontSize:p});v=1===i?v:e.y;for(let e=0;e<t;e++)v+=o,this.drawUnderline(b,v-o/4+parseFloat(s),b+n*i,v-o/4+parseFloat(s),u),this.drawStrikeThrough(b,v-o/4+parseFloat(p)/10,b+n*i,v-o/4+parseFloat(p)/10,u)}})}else{const t=o*w.length;w.forEach(e=>{const{text:i,x:s,width:n,height:a,options:u}=e;let{y:g}=e;switch(l){case"top":break;case"middle":g+=r-t>0?(r-t)/2:2;break;case"bottom":g+=r-t>0?r-t:2}this.text(i,s,g,n,a,Object.assign(Object.assign({},u),{verticalAlign:"middle",fontFamily:f,fontSize:p,fontWeight:d,fontStyle:c,lineHeight:o,clip:!1}),h)})}this.ctx.restore()}drawLine(t,e,i,s,r){const{color:o,lineWidth:n,lineStyle:h,lineDash:l}=r;if(0!==n&&"none"!==h){switch(this.ctx.save(),o&&(this.ctx.strokeStyle=o),n&&(this.ctx.lineWidth=n),h){case"solid":break;case"dashed":this.ctx.setLineDash(l);break;case"dotted":this.ctx.setLineDash([1,1]);break;case"double":return this.ctx.lineWidth=n/2,this.drawDoubleLine({x:t,y:e,x1:i,y1:s}),void this.ctx.restore()}this.ctx.beginPath(),this.linePath([[t,e],[i,s]]),this.ctx.restore()}}drawDoubleLine({x:t,y:e,x1:i,y1:s}){const r=i-t,o=s-e,n=Math.sqrt(r*r+o*o),h=1*-o/n,l=1*r/n;this.ctx.beginPath(),this.linePath([[t+h,e+l],[i+h,s+l]]),this.linePath([[t-h,e-l],[i-h,s-l]])}drawRect(t,e,i,s,r){this.ctx.save();const{color:o="#fff",fillColor:n,lineWidth:h=0,linearGradient:l,radiusConfig:a}=r,c=n;if(this.ctx.beginPath(),a?this.drawRadiusRect(t,e,i,s,a):this.ctx.rect(t,e,i,s),this.ctx.closePath(),l){const{degree:r,stops:o}=l,[[n,h],[a,c]]=function(t,e,i){t=t*Math.PI/180;const s=Math.sqrt(e*e+i*i),r=Math.atan(e/i),o=Math.cos(r-t)*s/2,n=Math.sin(t)*o,h=Math.cos(t)*o;return[[e/2-n,i/2-h],[e/2+n,i/2+h]]}(r,i,s),d=this.ctx.createLinearGradient(t+n,e+h,t+a,e+c);return o.forEach(t=>{d.addColorStop(t.per,t.color)}),this.ctx.fillStyle=d,this.ctx.fill(),this.ctx.restore()}c&&(this.ctx.fillStyle=c,this.ctx.fill()),h&&(this.ctx.strokeStyle=o,this.ctx.lineWidth=h,this.ctx.stroke()),this.ctx.restore()}drawRadiusRect(t,e,i,s,r){const{radius:o,tlRadius:n,trRadius:h,blRadius:l,brRadius:a}=r,c=Math.floor(Math.min(s/2,o)),d=Math.floor(Math.min(i/2,o));this.ctx.moveTo(t,e+c),n?this.ctx.quadraticCurveTo(t,e,t+d,e):this.ctx.lineTo(t,e),this.ctx.lineTo(t+i-d,e),h?this.ctx.quadraticCurveTo(t+i,e,t+i,e+c):this.ctx.lineTo(t+i,e),this.ctx.lineTo(t+i,e+s-c),a?this.ctx.quadraticCurveTo(t+i,e+s,t+i-d,e+s):this.ctx.lineTo(t+i,e+s),this.ctx.lineTo(t+d,e+s),l?this.ctx.quadraticCurveTo(t,e+s,t,e+s-c):this.ctx.lineTo(t,e+s),this.ctx.lineTo(t,e+c)}drawBias(t,e,i,s,r,o,n){this.ctx.save();const{fontSize:h="9px",color:l="#000000",fontWeight:a=400,fontFamily:c="sans-serif",fontStyle:d="normal"}=n,f={fontSize:h,color:l,fontWeight:a,fontFamily:c},u=1.3*parseFloat(h),g=function(t,e,i,s,r=!1,o){const n=[];if(!1===r){if(1===o&&n.push([[t,e],[t+i,e+s]]),2===o)n.push([[t,e],[t+i,e+2*s/3]]),n.push([[t,e],[t+2*i/3,e+s]]);else if(o>1){const r=Math.atan(s/i),h=Math.PI/2/(o+1);let l=0;for(let a=0;a<o;a++)(l+=h)<r?n.push([[t,e],[t+i,e+Math.ceil(Math.tan(l)*i)]]):n.push([[t,e],[t+Math.ceil(s*Math.tan(Math.PI/2-l)),e+s]])}}else if(1===o&&n.push([[t,e+s],[t+i,e]]),2===o)n.push([[t,e+s],[t+2*i/3,e]]),n.push([[t,e+s],[t+i,e+s/3]]);else if(o>1){const r=Math.atan(i/s),h=Math.PI/2/(o+1);let l=0;for(let a=0;a<o;a++)(l+=h)<r?n.push([[t,e+s],[t+Math.ceil(Math.tan(l)*s),e]]):n.push([[t,e+s],[t+i,e+s-Math.ceil(Math.tan(Math.PI/2-l)*i)]])}return n}(t,e,i,s,r,o.length-1);this.ctx.beginPath(),this.ctx.rect(t,e,i,s),this.ctx.clip(),y(this.ctx,{fontFamily:c,fontSize:h,fontStyle:d,fontWeight:a}),g.forEach((h,a)=>{const[c,d]=h;if(this.drawLine(c[0],c[1],d[0],d[1],{color:l,lineWidth:1}),0===a){let h=u;const l=[];if(h>s)return;for(;h<=s;){let o=null;if(r){const i=Math.abs((d[0]-c[0])/(d[1]-c[1]))*(s-h);o={x:t,y:e+h-u,width:i,height:u}}else{const s=Math.abs((d[0]-c[0])/(d[1]-c[1]))*h;o={x:t+s,y:e+h-u,width:i-s,height:u}}l.push(o),h+=u}const a=`${o[0]}`.split("");let g="",p=0;const w=[];for(let t=0;t<a.length;t++){const e=g+a[t],i=this.ctx.measureText(e).width;if(this.ctx.measureText(g).width>l[p].width)break;if(i>l[p].width){if(this.text(g,l[p].x,l[p].y,l[p].width,l[p].height,Object.assign(Object.assign({},f),{textAlign:"left",verticalAlign:"middle"})),w.push(Object.assign(Object.assign({x:l[p].x,y:l[p].y+l[p].height/2},l[p]),{text:g,options:n})),g=a[t],!l[++p])break}else g=e}g&&l[p]&&this.ctx.measureText(g).width<=l[p].width&&this.text(g,l[p].x,l[p].y,l[p].width,l[p].height,Object.assign(Object.assign({},f),{textAlign:"left",verticalAlign:"middle"}))}if(a===g.length-1){let n=s-u;const h=[];for(;n>=0;){let s=null;if(r){const r=Math.abs((d[0]-c[0])/(d[1]-c[1]))*(n+e-d[1]);s={x:t+i-r,y:e+n,width:r,height:u}}else{const i=Math.abs((d[0]-c[0])/(d[1]-c[1]))*n;s={x:t,y:e+n,width:i,height:u}}h.push(s),n-=u}const l=this.ctx.measureText(`${o[o.length-1]}`).width;let a=Math.floor(h.length/2),g=h.length%2==1?h[a].width:h[a].width+h[h.length-a-1].width;for(;g<l&&a<h.length-1;)g+=h[++a].width+h[h.length-a-1].width;let p=[],w=!0;for(h.reverse();w;){const t=`${o[o.length-1]}`.split("");let e="",i=h.length-a-1;p=[];for(let s=0;s<t.length;s++){const r=e+t[s];if(this.ctx.measureText(r).width>h[i].width){if(p.push({text:e,x:h[i].x,y:h[i].y,width:h[i].width,height:h[i].height,options:Object.assign(Object.assign({},f),{textAlign:"left",verticalAlign:"middle"})}),e=t[s],!h[++i])break}else e=r}e&&i<h.length&&p.push({text:e,x:h[i].x,y:h[i].y,width:h[i].width,height:h[i].height,options:Object.assign(Object.assign({},f),{textAlign:"left",verticalAlign:"middle"})}),e&&i>=h.length||e&&this.ctx.measureText(e).width>h[i].width?a++:w=!1,a>=h.length&&(w=!1)}p.forEach(t=>{const{text:e,x:i,y:s,width:r,height:o,options:n}=t;this.text(e,i,s,r,o,n)})}if(0!==a&&o.length>2){const i=g[a-1];if(r){const r=Math.atan(Math.abs((i[1][1]-i[0][1])/(i[1][0]-i[0][0]))),n=Math.atan(Math.abs((h[1][1]-h[0][1])/(h[1][0]-h[0][0]))),l=Math.abs(u/2/Math.sin((n-r)/2));this.ctx.save(),this.ctx.translate(t+Math.cos(r)*l,e+s-Math.sin(r)*l),this.ctx.rotate(-(r+(n-r)/2)),this.text(`${o[a]}`,0,0,this.ctx.measureText(`${o[a]}`).width,u,Object.assign(Object.assign({},f),{textAlign:"left",verticalAlign:"middle"})),this.ctx.restore()}else{const s=Math.atan((i[1][1]-i[0][1])/(i[1][0]-i[0][0])),r=Math.atan((h[1][1]-h[0][1])/(h[1][0]-h[0][0])),n=u/2/Math.sin((r-s)/2);this.ctx.save(),this.ctx.translate(t+Math.cos(s)*n,e+Math.sin(s)*n),this.ctx.rotate(s+(r-s)/2),this.text(`${o[a]}`,0,0,this.ctx.measureText(`${o[a]}`).width,u,Object.assign(Object.assign({},f),{textAlign:"left",verticalAlign:"middle"})),this.ctx.restore()}}}),this.ctx.restore()}drawCurrencyLine(t,e,i,s,r,o,n){const{intPart:h,deciPart:l}=r,a=h+l,c=i/a,d="#8e877e",f="#2df713",u="#fe1713",g=(t,i)=>{this.drawLine(i+c,e,i+c,e+s,{color:t,lineWidth:1})},p=o.split(".")[0];o=o.replace(".","");const w=p.length<h?h-p.length:0;for(let i=0;i<a;i++){const r=i-w;if(r>=0&&o.length>r){const i=o.substring(r,r+1);n.textAlign="center",this.text(i,t,e,c,s,n)}i+1!==a&&g(i+1===h?u:(i+1)%3==0?f:d,t),t+=c}}drawSelf(t,e,i,s,r,o){if(0===r||0===o)return;const n=b();t*=n,e*=n,i*=n,s*=n,r*=n,o*=n,r=Math.min(r,this.canvas.width-i,this.canvas.width-t),o=Math.min(o,this.canvas.height-s,this.canvas.height-e),this.ctx.save();const h=this.getCacheCanvas(),l=this.getCacheContext();l.save(),l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,h.width,h.height),l.drawImage(this.canvas,t,e,r,o,i,s,r,o),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(i,s,r,o),this.ctx.drawImage(h,i,s,r,o,i,s,r,o),l.restore(),this.ctx.restore()}drawImage(t,e,i,s,r,o="center",n={}){switch(this.ctx.save(),this.ctx.beginPath(),n.radiusConfig?this.drawRadiusRect(e,i,s,r,n.radiusConfig):this.ctx.rect(e,i,s,r),this.ctx.clip(),"default"===o&&(o=t.width>s||t.height>r?"repeat":"center"),t.width===s&&t.height===r&&(this.ctx.imageSmoothingEnabled=!1),o){case"center":this.ctx.drawImage(t,0,0,t.width,t.height,e+(s-t.width||1)/2,i+(r-t.height||1)/2,t.width,t.height);break;case"stretch":this.ctx.drawImage(t,0,0,t.width,t.height,e,i,s,r);break;case"adapt":const h=r*(t.width/t.height),l=s*(t.height/t.width);h<=s?this.ctx.drawImage(t,e+(s-h)/2,i,h,r):l<=r&&this.ctx.drawImage(t,e,i+(r-l)/2,s,l);break;case"repeat":const a=this.ctx.createPattern(t,"repeat");this.ctx.fillStyle=a,this.ctx.translate(e,i),this.ctx.fillRect(0,0,s,r)}this.ctx.restore()}draw(t,e){const{type:i,x:s,y:r,x1:o,y1:n,text:h,width:l,height:a,image:c,imageLayout:d,options:f}=t;switch(i){case"text":const{wrap:t,lineHeight:u}=f;"wrap"===t?this.wrapText({text:h,x:s,y:r,width:l,height:a,lineHeight:parseFloat(u),options:f},e):this.drawText(h,s,r,l,a,f);break;case"rect":this.drawRect(s,r,l,a,f);break;case"line":this.drawLine(s,r,o,n,f);break;case"image":this.drawImage(c,s,r,l,a,d)}}clear(t=0,e=0,i=this.canvas.clientWidth,s=this.canvas.clientHeight){this.ctx.clearRect(t,e,i,s)}clip(t,e,i,s,r){if(0===i||0===s)return r&&r();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(t,e,i,s),this.ctx.clip(),r&&r(),this.ctx.restore()}getDefaultFont(){const t=window.getComputedStyle(this.canvas);return`${t.fontStyle} ${t.fontWeight} ${t.fontSize} ${t.fontFamily}`}resize(t,e){Jo(this.canvas,t,e),this.cacheCanvas&&Jo(this.cacheCanvas,t,e)}linePath(t){if(t.length>1){const[e,i]=t[0];this.ctx.moveTo(e,i);for(let e=1;e<t.length;e++)this.ctx.lineTo(t[e][0],t[e][1]);this.ctx.stroke()}}text(t,e,i,s,r,o,n){this.ctx.save();const h=i,{clip:l,color:a="",verticalAlign:c,textAlign:d,fontWeight:f=400,fontSize:u="12px",fontFamily:g="sans-serif",fontStyle:p="normal",textShadow:w,subscript:b,supscript:v,lineHeight:m,rotate:S}=o;a&&(this.ctx.fillStyle=a),y(this.ctx,{fontFamily:g,fontSize:u,fontStyle:p,fontWeight:f}),l&&(this.ctx.beginPath(),this.ctx.rect(e,i,s,r),this.ctx.clip()),w&&(this.ctx.shadowColor=w.shadowColor,this.ctx.shadowOffsetX=w.shadowOffsetX,this.ctx.shadowOffsetY=w.shadowOffsetY,this.ctx.shadowBlur=w.shadowBlur);const C=this.ctx.measureText(t),{baseline:k}=x({fontFamily:g,fontSize:u});let z=C.width;if(S){const{baseX:o,baseY:n,textBaseline:h,textAlign:l}=function({rotate:t,x:e,y:i,width:s,height:r,textAlign:o,boundsWidth:n,baseline:h}){const l=i+r/2-n/2,a=i+r/2+n/2;return Math.abs(t)<80||"center"===o?{baseX:e+s/2-h,baseY:i+r/2,textBaseline:t>0?"top":"bottom",textAlign:"center"}:"left"===o?{baseX:e,baseY:t<0?l:a,textBaseline:t>0?"top":"bottom",textAlign:o}:"right"===o?{baseX:e+s,baseY:t<0?a:l,textBaseline:t>0?"bottom":"top",textAlign:o}:{baseX:e,baseY:i,textBaseline:"bottom",textAlign:"left"}}({x:e,y:i,width:s,height:r,rotate:S,textAlign:d,boundsWidth:C.width,baseline:k});this.ctx.textAlign=l,this.ctx.translate(o,n),this.ctx.textBaseline=h,this.ctx.rotate(-S*Math.PI/180),this.ctx.fillText(t,0,0)}else{if(v)this.ctx.textBaseline="top",i-=r/2-k;else if(b)this.ctx.textBaseline="bottom",i=i+r+(r/2-k);else switch(c){case"top":this.ctx.textBaseline="top";break;case"middle":this.ctx.textBaseline="middle",i+=r/2;break;case"bottom":this.ctx.textBaseline="bottom",i+=r}switch(d){case"center":e=e+s/2-C.width/2;break;case"left":e=e;break;case"right":e=e+s-C.width}if("distributed"===d&&t.length>1){const r=(s-C.width)/(t.length-1);let o=e;t.split("").forEach(t=>{this.ctx.fillText(t,o,i),n&&n({text:t,x:o,y:h,width:this.ctx.measureText(t).width,height:m}),o=o+this.ctx.measureText(t).width+r}),z=s}else{let s=e;`${t}`.split("").forEach(t=>{n&&n({text:t,x:s,y:h,width:this.ctx.measureText(t).width,height:m}),s+=this.ctx.measureText(t).width}),this.ctx.fillText(t,e,i)}}this.drawUnderline(e,i+parseFloat(k),e+z,i+parseFloat(k),o),this.drawStrikeThrough(e,i+parseFloat(u)/20,e+z,i+parseFloat(u)/20,o),this.ctx.restore()}getVisualRangeText(t,e,i){if(this.ctx.measureText(t).width<e)return t;const s=this;return function r(o,n){const h=Math.floor((o+n)/2),l=t.substring(0,h)+i,a=t.substring(0,h+1)+i;return s.ctx.measureText(l).width>=e?r(o,n=h-1):s.ctx.measureText(a).width>=e?l:r(o=h+1,n)}(0,t.length)}textVertical(t,e,i,s,r,o,n){this.ctx.save();const{lineHeight:h,color:l,textShadow:a}=o;l&&(this.ctx.fillStyle=l),a&&(this.ctx.shadowColor=a.shadowColor,this.ctx.shadowOffsetX=a.shadowOffsetX,this.ctx.shadowOffsetY=a.shadowOffsetY,this.ctx.shadowBlur=a.shadowBlur),t.split("").forEach(t=>{const r=this.ctx.measureText(t);i+=h,this.ctx.fillText(t,e+s/2-r.width/2,i),n&&n({word:t,x:e+s/2-r.width/2,y:i-2*h/3,width:r.width,height:h})}),this.ctx.restore()}drawUnderline(t,e,i,s,r){const{underline:o}=r;o&&o.width>0&&this.drawLine(t,e,i,s,{lineWidth:o.width,color:o.color,lineDash:o.dash,lineStyle:o.style})}drawStrikeThrough(t,e,i,s,r){const{strikeThrough:o,fontSize:n,color:h}=r;"solid"===o&&this.drawLine(t,e,i,s,{lineWidth:parseFloat(n)/10,color:h})}getCacheCanvas(){if(!this.cacheCanvas){const t=b();this.cacheCanvas=document.createElement("canvas"),this.cacheCanvas.width=this.canvas.width,this.cacheCanvas.height=this.canvas.height,this.cacheCanvas.getContext("2d").setTransform(t,0,0,t,0,0)}return this.cacheCanvas}getCacheContext(){return this.getCacheCanvas().getContext("2d")}makeLineTextOpts(t,e,i,s,r,o,n,h){const{newLine:l}=h;let a=[],c=0;switch(l){case"SINGLE_LINE_ADJUST_FONT":1.2*(c=r/this.ctx.measureText(e).width*parseFloat(t))+10>o&&(c=(o-10)/1.2),t=`${c}px`,a=[{text:e,x:i,y:s,width:r,height:n=1.2*c,options:h}];break;case"MULTI_LINE_ADJUST_FONT":const d=128/72;c=parseFloat(t)/d;const f=r*d;n=o/(a=this.makeTextOpts(e,i,s,f,o,n,h)).length,(a=this.makeTextOpts(e,i,s,f,o,n,h)).forEach(t=>{t.width=r}),t=`${c}px`;break;default:a=this.makeTextOpts(e,i,s,r,o,n,h)}return{textOpts:a,fontSize:t,lineHeight:n}}makeVerticalWrap(t,e,i,s,r,o,n){const{newLine:h,verTextDirection:l,autoWrapInfo:a}=n,c=o,d=[];if("SINGLE_LINE"===h)return[{text:t.substring(0,a[0]),x:e,y:i,width:c,height:r,options:n}];let f=Vr(t,a);return"RIGHT_TO_LEFT"===l&&(f=f.reverse()),f.forEach(t=>{d.push({text:t,x:e,y:i,width:c,height:r,options:n}),e+=o}),d}makeVerticalOpts(t,e,i,s,r,o,n){const{newLine:h,verTextDirection:l}=n,a=Math.floor(r/o),c=[],d=o;if("SINGLE_LINE"===h)return[{text:t.substring(a),x:e,y:i,width:d,height:r,options:n}];let f=[];return t.split("\n").forEach(t=>{let e=t;for(;""!==e;)e.length>a?(f.push(e.substring(0,a)),e=e.substring(a)):(f.push(e),e="")}),"RIGHT_TO_LEFT"===l&&(f=f.reverse()),f.forEach(t=>{c.push({text:t,x:e,y:i,width:d,height:r,options:n}),e+=o}),c}makeSingleLineOpts(t,e,i,s,r,o,n){const{overflowHide:h,hideType:l,appendTailStr:a,hideStrLength:c}=n;let d=t.split("\\n")[0];if(h)switch(l){case"CHAR_LENGTH":d=d.length<=c?d:d.substring(0,c)+a;break;case"CELL_WIDTH":d=this.getVisualRangeText(d,s,a)}else d=this.getVisualRangeText(d,s,"");return[this.newLine(d,e,i,s,r,o,n)]}newLine(t,e,i,s,r,o,n){return{text:t,x:e,y:i,width:s,height:o,options:n}}makeTextOpts(t,e,i,s,r,o,n){const{autoWrapInfo:h}=n;return h?this.makeTextOptsByWrapInfo(t,e,i,s,r,o,n):this.makeTextOptsByWrapAuto(t,e,i,s,r,o,n)}makeTextOptsByWrapInfo(t,e,i,s,r,o,n){const{newLine:h,verticalText:l,cellJust:a,rotate:c,autoWrapInfo:d}=n;if(0!==c)return[this.newLine(t,e,i,s,r,o,n)];if("SINGLE_LINE"===h||"NONE"===a)return[this.newLine(t.substring(0,d[0]),e,i,s,r,o,n)];if("VERTICAL_TEXT"===l)return this.makeVerticalWrap(t,e,i,s,r,o,n);const f=Vr(t,d),u=[];return f.forEach(t=>{u.push(this.newLine(t,e,i,s,r,o,n)),i+=o}),u}makeTextOptsByWrapAuto(t,e,i,s,r,o,n){const{newLine:h,verticalText:l,cellJust:a,rotate:c}=n;if(0!==c)return[this.newLine(t,e,i,s,r,o,n)];if("SINGLE_LINE"===h||"NONE"===a)return this.makeSingleLineOpts(t,e,i,s,r,o,n);if("VERTICAL_TEXT"===l)return this.makeVerticalOpts(t,e,i,s,r,o,n);const d=function(t){if(t.length<=1)return[t];const e=t.replace(new RegExp(/(\r\n|\\n)/g),"\n").split("\n"),i=[];return e.forEach(t=>{for(;t.length>0;){const e=t.substring(0,1);if(/[\d|A-Za-z|_]/.test(e)){const e=t.replace(/^([\d|A-Za-z|_]+).*$/,"$1");t=t.replace(e,""),i.push(e)}else i.push(e),t=t.length>0?t.substring(1,t.length):""}i.push("\n")}),i.pop(),i}(t);let f="";const u=[];return d.forEach(t=>{const h=f+t,l=this.ctx.measureText(h).width;if("\n"===t)u.push(this.newLine(f,e,i,s,r,o,n)),f="",i+=o;else if(l<=s)f=h;else if(""!==f&&(u.push(this.newLine(f,e,i,s,r,o,n)),f="",i+=o),this.ctx.measureText(t).width/s>1){const h=`${t}`.split("");for(let t=0;t<h.length;t++){const l=f+h[t];this.ctx.measureText(l).width>=s?(""!==f&&(u.push(this.newLine(f,e,i,s,r,o,n)),i+=o),f=h[t]):f=l}}else f=t}),u.push(this.newLine(f,e,i,s,r,o,n)),u}}function Zo(t,i={}){return function(t,i){const s=e("canvas","sheet-table-canvas"),r=t.offset(),{width:o=r.width,height:n=r.height}=i,h=s.el;t.children(h);const l=b();return h.width=o*l,h.height=n*l,s.offset({width:o,height:n}),new Qo(h,i)}(t,i)}function tn(t,e,i,s,r){function o(t,e,i,s,r=0){r=r*Math.PI/180;const o=Math.cos,n=Math.sin;return[(t-i)*o(r)-(e-s)*n(r)+i,(t-i)*n(r)+(e-s)*o(r)+s]}if(r.rotate){const[n,h]=r.center,l=o(t,e,n,h,r.rotate),a=o(i,s,n,h,r.rotate);t=l[0],e=l[1],i=a[0],s=a[1]}return{type:"line",x:t,y:e,x1:i,y1:s,options:r}}function en(t,e,i){const s=t.getStyle();!function(t,e,i){const s=t.backgroundColor&&!t.backgroundColor.isTransparent(),r=t.backgroundImage&&t.backgroundSize;let o={};if(s&&(o={type:"rect",x:t.left,y:t.top,width:t.width,height:t.height,options:{fillColor:t.backgroundColor.toString()}}),r){const e=To(t.backgroundImage);e?o={type:"image",x:t.left,y:t.top,width:t.width,height:t.height,image:e,imageLayout:t.backgroundSize}:Oo(t.backgroundImage).then(Wr(()=>{i()}))}e.draw(o)}(s,e,i),function(t,e){const{top:i,left:s,width:r,height:o}=t,n=[s+r/2,i+o/2],h=[];t.borderTopStyle&&!t.borderTopColor.isTransparent()&&h.push(tn(s,i,s+r,i,{color:t.borderTopColor.toString(),lineWidth:t.borderTopWidth,lineStyle:t.borderTopStyle,rotate:t.rotate,center:n})),t.borderBottomStyle&&!t.borderBottomColor.isTransparent()&&h.push(tn(s,i+o,s+r,i+o,{color:t.borderBottomColor.toString(),lineWidth:t.borderBottomWidth,lineStyle:t.borderBottomStyle,rotate:t.rotate,center:n})),t.borderLeftStyle&&!t.borderLeftColor.isTransparent()&&h.push(tn(s,i,s,i+o,{color:t.borderLeftColor.toString(),lineWidth:t.borderLeftWidth,lineStyle:t.borderLeftStyle,rotate:t.rotate,center:n})),t.borderRightStyle&&!t.borderRightColor.isTransparent()&&h.push(tn(s+r,i,s+r,i+o,{color:t.borderRightColor.toString(),lineWidth:t.borderRightWidth,lineStyle:t.borderRightStyle,rotate:t.rotate,center:n})),h.forEach(t=>{t&&e.draw(t)})}(s,e)}function sn(t){return t.props?t.props.overflowConfig:{}}function rn(t,e,i){const s=t.getText();if(null==s||""===s)return;const r=t.getStyle(),{top:o,left:n,width:h,height:l,textAlign:a,verticalAlign:c,color:d}=r;e.draw({type:"text",text:`${s}`,x:n,y:o,width:h,height:l,options:Object.assign(Object.assign(Object.assign({},r),{wrap:"wrap",textAlign:a||"center",verticalAlign:c||"middle",color:`${d}`,clip:!0}),sn(t))},i)}class on{constructor(t,i){this.reRender=(()=>{this.renderGrid(),this.renderSequnce(),this.renderFreeze()}),this.render=(()=>{this.renderStickers(),this.reRender()}),this.refresh=(()=>{this.clear(),this.renderGrid()}),this.resize=(()=>{this.renderer.resize(this.data.width+this.data.offset.offsetX,this.data.height+this.data.offset.offsetY)}),this.debounceRender=Wr(()=>{this.render()},50),this.el=e("div","sheet-table"),this.data=t,this.container=i,this.renderer=Zo(this.el,{width:t.width+t.offset.offsetX,height:t.height+t.offset.offsetY})}renderSequnce(){const t=this.data.offset.offsetX,e=this.data.offset.offsetY;this.renderer.clear(0,0,this.data.width+t,e),this.renderer.clear(0,0,t,this.data.height+e);const i=this.data.getSequnceCells();this.clearBorderSet(),i.forEach(t=>{this.renderContent(t),this.renderBorder(t)}),this.clearBorderSet()}scroll(t,e){const i=Math.ceil(isNaN(e)?0:e),s=Math.ceil(isNaN(t)?0:t);if(s||i)if(s!==i&&(s===(i||s)||i===(s||i))){const t=this.data.getRenderBounds(i?"vertical":"horizontal"),e={x:Math.ceil(t.x),y:Math.ceil(t.y),width:Math.ceil(t.width),height:Math.ceil(t.height)},{cacheBounds:r,canvasBounds:o,renderBounds:n}=this.getReRenderBounds(s,i,e);this.clip(e.x,e.y,e.width,e.height,()=>{this.drawSelf(r.x,r.y,o.x,o.y,o.width,o.height),this.clip(n.x,n.y,n.width,n.height,()=>{this.clear(),this.rerenderBounds(n.x,n.y,n.width,n.height)})}),this.renderSequnce(),this.renderFreeze()}else this.reRender()}getReRenderBounds(t,e,i){let s,r,o;if(e<0&&(s={x:i.x,y:i.y,width:i.width,height:i.height+e},r={x:i.x,y:i.y-e,width:i.width,height:i.height+e},o={x:i.x,y:i.y,width:i.width,height:i.height-r.height+1}),e>0){const t=ee(i.width-i.x,0,i.width),n=ee(i.height-i.y-e,0,i.height);s={x:i.x,y:i.y+e,width:t,height:n},r={x:i.x,y:i.y,width:t,height:n},o={x:i.x,y:r.y+r.height,width:i.width,height:i.height-r.height}}if(t<0&&(s={x:i.x,y:i.y,width:i.width+t,height:i.height},r={x:i.x-t,y:i.y,width:i.width+t,height:i.height},o={x:i.x,y:i.y,width:i.width-r.width+1,height:i.height}),t>0){const e=ee(i.width-i.x-t,0,i.width),n=ee(i.height-i.y,0,i.height);s={x:i.x+t,y:i.y,width:e,height:n},o={x:(r={x:i.x,y:i.y,width:e,height:n}).x+r.width,y:i.y,width:i.width-r.width,height:i.height}}return{cacheBounds:s,canvasBounds:r,renderBounds:o}}clip(t,e,i,s,r){const{offsetX:o,offsetY:n}=this.data.offset;this.renderer.clip(t+o,e+n,i,s,r)}clear(t,e,i,s){const{offsetX:r,offsetY:o}=this.data.offset;this.renderer.clear(t&&t+r,e&&e+o,i,s)}drawSelf(t,e,i,s,r,o){const{offsetX:n,offsetY:h}=this.data.offset;this.renderer.drawSelf(t+n,e+h,i+n,s+h,r,o)}renderFreeze(){this.data.getFreezeBounds().forEach(({x:t,y:e,width:i,height:s})=>{if(i>0&&s>0){const r=this.data.getCellsInBounds(t,e,i,s);this.clip(t,e,i,s,()=>{this.clear(),r.forEach(t=>{this.renderContent(t)})}),this.clip(t,e,i+1,s+1,()=>{this.clearBorderSet(),r.forEach(t=>{this.renderBorder(t)})})}})}rerenderBounds(t,e,i,s){this.data.spliteBounds(t,e,t+i,e+s).forEach(({x:t,y:e,width:i,height:s})=>{i<=0||s<=0||this.clip(t,e,i,s,()=>{const r=this.data.getCellsInBounds(t,e,i,s);r.forEach(t=>{this.renderContent(t)}),this.clearBorderSet(),r.forEach(t=>{this.renderBorder(t)})})}),this.clearBorderSet()}clearBorderSet(){this.cacheBorderSet=new Set,this.cacheBorderPosition=new Set}renderGrid(){this.clear(0,0,this.data.width,this.data.height),this.rerenderBounds(0,0,this.data.width,this.data.height)}renderContent(t){t.ci<this.data.view.colc&&t.ri<this.data.view.rowc&&this.renderCellComponent(t)}renderCell(t){const e=Object.assign(Object.assign({},t),this.data.correctBounds(t)),i=this.data.getQuadrantBounds(t.x,t.y);let s=this.data.getCell(t.ri+t.rp+1,t.ci);s=Object.assign(Object.assign(Object.assign({},s),this.data.correctBounds(s)),{borderStyle:s.borderStyle?{borderTop:s.borderStyle.borderTop}:{}});let r=this.data.getCell(t.ri,t.ci+t.cp+1);r=Object.assign(Object.assign(Object.assign({},r),this.data.correctBounds(r)),{borderStyle:r.borderStyle?{borderTop:r.borderStyle.borderLeft}:{}}),this.clip(i.x,i.y,i.width,i.height,()=>{this.clear(e.x,e.y,e.width,e.height),this.renderContent(e),this.renderCellBorder(e),this.renderCellBorder(s),this.renderCellBorder(r)})}renderBorder(t){t.ci<this.data.view.colc&&t.ri<this.data.view.rowc&&this.renderCellBorder(t)}renderCellComponent(t){const{width:e,height:i}=t;if(0===e||0===i)return;t.x+=this.data.offset.offsetX,t.y+=this.data.offset.offsetY;const s=[];this.renderCellBg(t),t.stick?this.container.stickCell(t.ri,t.ci,t.init):function(t,e,i,s){let o=[r(t)];for(;o.length>0;){const t=o.shift();t&&(en(t,e,i),rn(t,e,s),o=o.concat(t.getChildren()||[]))}}(t,this.renderer,this.debounceRender,e=>{const i=this.data.view.getViewData();if(i[t.ri]&&i[t.ri][t.ci]){const r=i[t.ri][t.ci],o=Object.assign(Object.assign({},e),{x:e.x-t.x,y:e.y-t.y});s.push(o),r.textArea=s}})}renderCellBorder(t){var e;const{borderStyle:i={}}=t,s=null===(e=null==t?void 0:t.backgroundStyle)||void 0===e?void 0:e.backgroundColor,{x:r,y:o,width:n,height:h}=t;if(n<=0||h<=0)return;const{borderTop:l,borderLeft:a,borderBottom:c,borderRight:d}=i;this.renderCellBorderLine(r,o,r+n,o,l,s),this.renderCellBorderLine(r,o+h,r+n,o+h,c,s),this.renderCellBorderLine(r,o,r,o+h,a,s),this.renderCellBorderLine(r+n,o,r+n,o+h,d,s)}renderCellBorderLine(t,e,i,s,r,o){const n=`${t}-${e}-${i}-${s}`;if((null==r?void 0:r.width)>0){const o=`${t}-${e}-${i}-${s}-${r.width}-${r.color}`;this.cacheBorderSet.has(o)||(this.renderer.drawLine(t,e,i,s,{color:r.color,lineWidth:r.width,lineStyle:r.style,lineDash:r.dash}),this.cacheBorderSet.add(o),this.cacheBorderPosition.add(n))}else if(o&&!this.cacheBorderSet.has(n)){let r=!1,n=0;this.cacheBorderSet.forEach(o=>{if(r)return;const[h,l,a,c,d]=o.split("-"),f=Math.floor(1e4*Number(h))/1e4,u=Math.floor(1e4*Number(l))/1e4,g=Math.floor(1e4*Number(a))/1e4,p=Math.floor(1e4*Number(c))/1e4,w=Math.floor(1e4*t)/1e4,b=Math.floor(1e4*e)/1e4,v=Math.floor(1e4*i)/1e4,y=Math.floor(1e4*s)/1e4;r=Jr(f,u,g,p,w,b)&&Jr(f,u,g,p,v,y)||Jr(t,e,i,s,f,u)&&Jr(t,e,i,s,g,p);const m=Jr(f,u,g,p,w,b),x=Jr(f,u,g,p,v,y);m&&!x&&u===p&&y!==p&&(e+=n=~~d),!m&&x&&u===p&&b!==p&&(s-=n=~~d),m&&!x&&f===g&&v!==g&&(t+=n=~~d),!m&&x&&f===g&&w!==g&&(i-=n=~~d)}),r||this.renderer.drawLine(t,e,i,s,{color:o,lineWidth:1,lineStyle:"solid",lineDash:[]})}}renderCellBg(t){const{bias:e,style:i={},backgroundStyle:s={},currencyLineAttr:r,value:o}=t,{x:n,y:h,width:l,height:a}=t;if(l<=0||a<=0)return;const{backgroundColor:c,backgroundImage:d,linearGradient:f,backgroundImageLayout:u}=s;if(f)this.renderer.drawRect(n,h,l,a,{linearGradient:f,radiusConfig:s.radiusConfig});else if(d){const t=To(d);t?this.renderer.drawImage(t,n,h,l,a,u,{radiusConfig:s.radiusConfig}):Oo(d).then(this.debounceRender)}else c&&this.renderer.drawRect(n,h,l,a,{fillColor:c,radiusConfig:s.radiusConfig});e&&this.renderer.drawBias(n,h,l,a,e.backslash,e.texts,i),r&&this.renderer.drawCurrencyLine(n,h,l,a,r,o,i)}renderStickers(){this.data.getStickers().forEach(t=>{"delete"===t.tag?this.container.tearSticker(t.id):this.container.stick(t,t.init)})}}class nn{constructor(){this.eventMap={}}on(t,e){this.eventMap[t]=this.eventMap[t]||[],this.eventMap[t].push(e)}off(t,e){this.eventMap[t]=this.eventMap[t]||[];const i=this.eventMap[t].indexOf(e);-1!==i&&this.eventMap[t].splice(i,i)}emit(t,e=[]){this.eventMap[t]&&this.eventMap[t].forEach(t=>{t.call(null,...e)})}}var hn;!function(t){t[t.WHEELMODE_FOCUS=0]="WHEELMODE_FOCUS",t[t.WHEELMODE_WHEEL=1]="WHEELMODE_WHEEL"}(hn||(hn={}));const ln={borderTop:!1,borderBottom:!1,borderLeft:!1,borderRight:!1};class an extends nn{constructor(t){super(),this.focusMode=0,this.activeAreas=new Set,this.width=0,this.height=0;const{width:i=0,height:s=0,scrollTop:r=0,scrollLeft:o=0,cls:n="",totalWidth:h,totalHeight:l,top:a=0,left:c=0}=t;this.el=e("div",`grid-container ${n}`),this.scrollTopDelta=0,this.scrollLeftDelta=0,this.scrollTop=r,this.scrollLeft=o,this.scrollEl=e("div","scrollable-grid"),this.scrollEl.offset({top:r,left:o,width:h||0,height:l||0}),this.width=i,this.height=s,this.el.offset({width:i,height:s,top:a,left:c}),this.on("wheelMode",t=>{this.focusMode=t}),this.el.el.onscroll=(()=>{this.el.el.clientHeight>0&&this.focusMode===hn.WHEELMODE_FOCUS&&this.emit("focus",[this.el.el.scrollLeft,this.el.el.scrollTop])})}hideSelect(){}selectAreas(t,e){this.checkScrollElMounted(),(t||[]).forEach(t=>{this.selectArea(this.createActiveArea(),t,e)})}selectArea(t,e,i){const{p:s,c:r,t:o,b:n,l:h,r:l}=t,{borderLeft:a,borderTop:c,borderRight:d,borderBottom:f}=Object.assign(Object.assign({},ln),i);!e||e.x<0||e.y<0||e.width<=0||e.height<=0?s.hide():(s.css({position:"absolute",top:`${e.y}px`,left:`${e.x}px`,width:"0px",height:"0px"}),r.offset({width:e.width,height:e.height}),o.offset({top:0,left:0,width:e.width}),o.css({display:c?"block":"none"}),n.offset({top:e.height,left:0,width:e.width}),n.css({display:f?"block":"none"}),h.offset({top:0,left:0,height:e.height}),h.css({display:a?"block":"none"}),l.offset({top:0,left:e.width,height:e.height}),l.css({display:d?"block":"none"}),s.show())}hideSelectAreas(){this.activeAreas.forEach(t=>{const{p:e,c:i,t:s,l:r,r:o,b:n}=t;[e,i,s,r,o,n].forEach(t=>{t&&(t.hide(),t.remove())})}),this.activeAreas.clear()}scroll(t=this.scrollLeftDelta,e=this.scrollTopDelta){this.scrollTopDelta=e,this.scrollLeftDelta=t,this.el.scroll({top:Math.abs(e+this.scrollTop),left:Math.abs(t+this.scrollLeft)})}createActiveArea(){const t=e("div"),i=e("div","active-area"),s=e("div","range-border active-area-border"),r=e("div","range-border active-area-border"),o=e("div","range-border active-area-border"),n=e("div","range-border active-area-border");t.children(i,s,n,r,o),this.scrollEl.children(t);const h={p:t,c:i,t:s,l:r,r:o,b:n};return this.activeAreas.add(h),h}offset(t){const{width:e=0,height:i=0,scrollTop:s=0,scrollLeft:r=0,left:o=0,top:n=0}=t;this.width=e,this.height=i,this.el.offset({width:e,height:i,left:o,top:n}),this.scrollTop=s,this.scrollLeft=r,this.scroll()}updateScrollEl(t){const{totalWidth:e,totalHeight:i,top:s=0,left:r=0}=t;this.scrollEl.offset({width:e,height:i,top:s,left:r})}stick({top:t,left:i,el:s}){this.checkScrollElMounted(),this.el.removeClass("empty"),this.scrollEl.children(s),e(s).offset({top:t,left:i})}isStickerInRange(t){return Pr(t.top-this.scrollTop,-.25*this.height,1.25*this.height)&&Pr(t.left-this.scrollLeft,-.25*this.width,1.25*this.width)}checkScrollElMounted(){this.el.hasChild(this.scrollEl.el)||(this.el.children(this.scrollEl),0===this.scrollLeftDelta&&0===this.scrollTopDelta||this.scroll())}}let cn=(()=>{class t extends nn{constructor(t){super(),this.el=e("div","grid-container"),/(msie|trident)/i.test(navigator.userAgent.toLowerCase())&&function(){let t=0;const e=navigator.userAgent.toLowerCase(),i=e.match(/(?:msie\s([\w.]+))/),s=e.match(/(?:trident.*rv:([\w.]+))/);return t=i&&s&&i[1]&&s[1]?Math.max(1*parseInt(i[1],10),1*parseInt(s[1],10)):i&&i[1]?1*parseInt(i[1],10):s&&s[1]?1*~~s[1]:0}()<=10&&this.el.addClass("ie10-below"),this.stickers={},this.digest(t),this.render()}render(){const t=this.width-this.freezeWidth,e=this.height-this.freezeHeight;this.tGrid=new an({cls:"grid-container-top t-grid",width:this.width,height:this.freezeHeight}),this.bGrid=new an({cls:"grid-container-bottom b-grid",width:this.width,height:e,top:this.freezeHeight}),this.tlGrid=new an({cls:"inline-grid tl-grid",width:this.freezeWidth,height:this.freezeHeight}),this.trGrid=new an({cls:"inline-grid tr-grid",width:t,height:this.freezeHeight,scrollLeft:-this.freezeWidth,totalWidth:this.totalWidth,totalHeight:this.freezeHeight,left:this.freezeWidth}),this.blGrid=new an({cls:"inline-grid bl-grid",width:this.freezeWidth,height:e,scrollTop:-this.freezeHeight,totalWidth:this.freezeWidth,totalHeight:this.totalHeight}),this.brGrid=new an({cls:"inline-grid br-grid",width:t,height:e,scrollLeft:-this.freezeWidth,scrollTop:-this.freezeHeight,totalWidth:this.totalWidth,totalHeight:this.totalHeight,left:this.freezeWidth}),this.mountGrid(),this.on("wheelMode",t=>{this.brGrid.emit("wheelMode",[t]),this.blGrid.emit("wheelMode",[t]),this.trGrid.emit("wheelMode",[t])}),this.brGrid.on("focus",(t,e)=>{this.emit("focus",[t,e])}),this.trGrid.on("focus",t=>{this.emit("focus",[t])}),this.blGrid.on("focus",(t,e)=>{this.emit("focus",[void 0,e])})}showSelectArea(t){this.hideSelectArea(),t.forEach(t=>{this.tlGrid.selectAreas([t[0]]),this.trGrid.selectAreas([t[1]]),this.blGrid.selectAreas([t[2]]),this.brGrid.selectAreas([t[3]])})}hideSelectArea(){this.tlGrid.hideSelectAreas(),this.trGrid.hideSelectAreas(),this.blGrid.hideSelectAreas(),this.brGrid.hideSelectAreas()}scroll(t,e){this.trGrid.scroll(t,0),this.blGrid.scroll(0,e),this.brGrid.scroll(t,e)}getGrids(){return[this.tlGrid,this.trGrid,this.blGrid,this.brGrid]}update(t){this.digest(t);const e=this.width-this.freezeWidth,i=this.height-this.freezeHeight;this.tGrid.offset({width:this.width,height:this.freezeHeight}),this.bGrid.offset({width:this.width,height:i,top:this.freezeHeight}),this.tlGrid.offset({width:this.freezeWidth,height:this.freezeHeight}),this.trGrid.updateScrollEl({totalWidth:this.totalWidth,totalHeight:this.freezeHeight,left:-this.freezeWidth}),this.trGrid.offset({width:e,height:this.freezeHeight,left:this.freezeWidth}),this.blGrid.updateScrollEl({totalWidth:this.freezeWidth,totalHeight:this.totalHeight,top:-this.freezeHeight}),this.blGrid.offset({width:this.freezeWidth,height:i}),this.brGrid.updateScrollEl({totalWidth:this.totalWidth,totalHeight:this.totalHeight,top:-this.freezeHeight,left:-this.freezeWidth}),this.brGrid.offset({width:e,height:i,left:this.freezeWidth}),this.mountGrid()}digest(t){const{width:e,height:i,freezeWidth:s,freezeHeight:r,totalWidth:o,totalHeight:n}=t;this.width=e,this.height=i,this.freezeWidth=s,this.freezeHeight=r,this.totalWidth=o,this.totalHeight=n}getResponseGrid(t,e){let i;return i=t<this.freezeWidth&&e<this.freezeHeight?this.tlGrid:t>=this.freezeWidth&&e<this.freezeHeight?this.trGrid:t<this.freezeWidth&&e>=this.freezeHeight?this.blGrid:this.brGrid}stick({left:i,top:s,width:r,height:o,el:n,id:h=Ar(),lazy:l}){const a=this.getResponseGrid(i,s),c=e("div",t.STICKER_CONTAINER_CLASS_NAME);c.offset({width:r,height:o}),this.stickers[h]=c,n&&(q(n)?n.call(null,c):c.html(n));const d={id:h,left:i,top:s,width:r,height:o,el:c.el},f=a.isStickerInRange(d);function u(){a.stick(d)}return!l&&u(),{id:h,mount:l?u:void 0,isInRange:f}}updateStick({left:t,top:e,width:i,height:s,id:r}){const o=this.getResponseGrid(t,e);return this.stickers[r]&&o.stick({id:r,left:t,top:e,width:i,height:s,el:this.stickers[r].el}),""}tear(t){this.stickers[t]&&(this.stickers[t].remove(),delete this.stickers[t])}getStick(t){return this.stickers[t]}clean(){for(const[,t]of Object.entries(this.stickers))t.remove();this.stickers={}}mountGrid(){this.freezeWidth||this.freezeHeight?(this.tGrid.el.children(this.tlGrid.el,this.trGrid.el),this.bGrid.el.children(this.blGrid.el,this.brGrid.el),this.el.children(this.tGrid.el,this.bGrid.el)):(this.bGrid.el.children(this.brGrid.el),this.el.children(this.bGrid.el))}}return t.STICKER_CONTAINER_CLASS_NAME="waffle-borderless-sticker",t})();class dn{constructor(t){this.isOver=!1,this.autoShow=!0,this.minScrollBarLength=24,this.direction=t.direction,this.state=!1,this.position=0,this.startPosition=0,this.size=t.size,this.scrollSize=t.scrollSize,this.sliderSize=this.getScrollBarLength(),this.startTrigger=t.startScroll||Yr,this.scrollTrigger=t.onScoll||Yr,this.endTrigger=t.endScroll||Yr,this.el=e("div",`sheet-scrollbar sheet-scrollbar-${this.vertical()?"y":"x"}`),this.sliderEl=e("div","sheet-scrollbar-slider"),this.el.css(this.vertical()?"height":"width",v(t.size)),this.sliderEl.css(this.vertical()?"height":"width",v(this.sliderSize)),this.el.children(this.sliderEl),this._initEvent(),this.sliderEl.hide(),this.checkScrollSize()}_initEvent(){this.el.on("mousedown",t=>{t.preventDefault()}),this.el.on("mouseover",()=>{this.isOver=!0,this.checkScrollSize(),this.sliderEl.show()}),this.el.on("mouseleave",()=>{this.isOver=!1,!this.state&&this._resetTimeout()}),this.sliderEl.on("mousedown",t=>{this._startScroll(t),t.preventDefault()}),this.sliderEl.on("touchstart",t=>{this.state=!0,this.sliderEl.show(),this._startScroll(t.targetTouches[0])}),this.sliderEl.on("mousemove",t=>{this._scroll(t)}),this.sliderEl.on("touchmove",t=>{this._scroll(t.targetTouches[0])}),this.sliderEl.on("touchend",()=>{this.state=!1,this._resetTimeout()}),document.addEventListener("mousemove",t=>{this._scroll(t)}),this.sliderEl.on("mouseup",t=>{this._endScroll(t)}),document.addEventListener("mouseup",t=>{this._endScroll(t)}),document.addEventListener("mouseleave",t=>{this._endScroll(t)})}_startScroll(t){this.startPosition=this.vertical()?t.clientY:t.clientX,this.state=!0,this.el.addClass("active"),this.startTrigger()}_scroll(t){if(!this.state)return;this.moveOutside&&(this.vertical()?this.startPosition=this.startPosition+t.clientY-this.cachePosition:this.startPosition=this.startPosition+t.clientX-this.cachePosition,this.moveOutside=!1);let e=0,i=0;this.vertical()?(i=t.clientY-this.startPosition+this.position,this.startPosition=t.clientY):(e=t.clientX-this.startPosition+this.position,this.startPosition=t.clientX),e=Math.round(Math.max(0,Math.min(e,this.size-this.sliderSize))),i=Math.round(Math.max(0,Math.min(i,this.size-this.sliderSize)));const s=this.position;this.position=e||i;const r=(this.position-s)*this.scrollSize/(this.size-this.sliderSize);this._scrollTo(e,i),0===r&&this.adjustScroll(e,i),this.scrollTrigger(this.vertical()?0:r,this.vertical()?r:0)}adjustScroll(t,e){const i=this.vertical()?e:t,s=this.vertical()?0:5,r=this.vertical()?5:0;0===i&&this.scrollTrigger(0-s,0-r),i===this.size-this.sliderSize&&this.scrollTrigger(s,r)}_endScroll(t){this.state&&(this.state=!1,this.el.removeClass("active"),this._resetTimeout(),this.endTrigger(),t.preventDefault())}_scrollTo(t=0,e=0){this.sliderEl.css({transform:`translate(${v(t)}, ${v(e)})`,"-webkit-transform":`translate(${v(t)}, ${v(e)})`,"-moz-transform":`translate(${v(t)}, ${v(e)})`,"-o-transform":`translate(${v(t)}, ${v(e)})`,"-ms-transform":`translate(${v(t)}, ${v(e)})`})}checkScrollSize(){this.autoShow&&(this.scrollSize<=0?this.el.hide():this.el.show())}vertical(){return"vertical"===this.direction}inScrollBounds(t){const e=this.sliderSize/2,i=this.size-this.sliderSize/2,s=this.vertical()?t.clientY:t.clientX;return s>=e&&s<=i}_resetTimeout(){this.timer&&window.clearTimeout(this.timer),this.timer=this.sliderElHide()}scroll(t,e=!0){!this.isOver&&this.scrollSize>0&&e&&(this.sliderEl.show(),this._resetTimeout()),t=t*(this.size-this.sliderSize)/this.scrollSize;const i=this.vertical()?0:t,s=this.vertical()?t:0;this.position=t,this._scrollTo(i,s)}update(t){this.state=!1,this.startPosition=0,this.size=t.size,this.scrollSize=t.scrollSize,this.sliderSize=this.getScrollBarLength();const e=this.vertical()?0:Math.min(this.position,this.size-this.sliderSize),i=this.vertical()?Math.min(this.position,this.size-this.sliderSize):0;this.position=e||i,this.el.css(this.vertical()?"height":"width",v(t.size)),this.sliderEl.css(this.vertical()?"height":"width",v(this.sliderSize)),this._scrollTo(e,i),this.scrollTrigger(0,0,{force:!0}),this.checkScrollSize(),this.sliderEl.hide()}getScrollBarLength(){const t=Math.round(Math.pow(this.size,2)/(this.scrollSize+this.size));return this.size<this.minScrollBarLength?t:Math.max(t,this.minScrollBarLength)}setVisible(t){t?this.el.show():this.el.hide(),t?this.sliderEl.show():this.sliderEl.hide(),this.autoShow=!1}sliderElHide(){return window.setTimeout(()=>{!this.state&&this.autoShow&&this.sliderEl.hide()},5e3)}}let fn=!1;class un{constructor(t){this.onMouseDown=(t=>{t.preventDefault(),t.stopPropagation(),fn=!0,this.prevX=0,this.prevY=0,this.distance=0,this.lineEl.show(),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp)}),this.onMouseMove=(t=>{if(t.preventDefault(),t.stopPropagation(),fn){const{prevX:e,prevY:i,min:s,max:r}=this,o=e?t.screenX-e:0,n=i?t.screenY-i:0;this.prevX=t.screenX,this.prevY=t.screenY,"vertical"===this.direction?(this.distance+=o,this.el.css("margin-left",`${ee(this.distance,s,r)}px`)):(this.distance+=n,this.el.css("margin-top",`${ee(this.distance,s,r)}px`)),t.preventDefault()}}),this.onMouseUp=(t=>{if(t.preventDefault(),t.stopPropagation(),fn){fn=!1,this.lineEl.hide();const t=parseFloat(this.el.css("margin-left"))||parseFloat(this.el.css("margin-top"));this.onResize&&this.onResize(this.rect,t,this.direction),this.el.css("margin-left","0px"),this.el.css("margin-top","0px"),this.distance=0,this.hide()}window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)});const{direction:i="vertical",onResize:s}=t;this.direction=i,this.onResize=s,this.el=e("div",`sheet-resizer ${i}`),this.hoverEl=e("div","sheet-resizer-hover"),this.lineEl=e("div","sheet-resizer-line"),this.el.children(this.hoverEl,this.lineEl),this.lineEl.hide(),this.hoverEl.on("mousedown",this.onMouseDown)}show(t,e,i){if(fn)return;this.rect=t;const{left:s,top:r,width:o,height:n}=t,h="vertical"===this.direction,{min:l=-1/0,max:a=1/0}=i;this.min=l,this.max=a,this.el.offset({left:h?s+o-5:s,top:h?r:r+n-5}).show();const c=h?5:o,d=h?n:5;this.hoverEl.offset({width:c,height:d}),this.lineEl.offset({top:h?n:3,left:h?3:o,width:e.width,height:e.height})}hide(){fn||this.el.offset({width:0,height:0}).hide()}}class gn{constructor(){this.el=e("div","sheet-tooltip"),this.hideEl(),this.isShow=!1,document.body.appendChild(this.el.el)}show(t,e,i){let s=i+10,r=e+10;this.el.text(t);const o=this.el.el.clientWidth;let n=this.el.el.clientHeight;if(n>window.innerHeight){const t=e-10,o=window.innerWidth-e-10;t>o?(this.el.css("max-width",`${t}px`),r=0):(this.el.css("max-width",`${o}px`),r=e+10),s=i+10-(n=this.el.el.clientHeight)}else window.innerHeight-i<=n&&(s-=n+15),window.innerWidth-e<=o&&(r-=o+10);s=Math.max(s,0),r=Math.max(r,0),this.el.offset({left:r,top:s}),this.isShow||(this.isShow=!0,this.timeOut=setTimeout(()=>{this.showEl()},900))}hide(){this.timeOut&&clearTimeout(this.timeOut),this.hideEl(),this.isShow=!1}showEl(){this.el.css("visibility","visible"),this.el.css("opacity","inherit")}hideEl(){this.el.css("visibility","hidden"),this.el.css("opacity","0")}tear(){document.body.removeChild(this.el.el)}}const pn=100;class wn extends nn{constructor(t,i){super(),this.stickerTimeouts=[],this.deltaXCache=0,this.deltaYCache=0,this.sync=!1,this.getPointByClient=((t,e)=>({x:t,y:e})),this.previousPosition=null,this.onMouseDown=(t=>{const{x:e,y:i,clientX:s,clientY:r}=this.getPointInfo(t),o=this.getActiveCell(e,i);if(null===o||o.stopPropagation)return void(this.moving=0);const n=[o.ci,o.ri];if(this.moving=1,t.shiftKey){const[t]=this.data.selection.getRange();this.emit("select",[t[1],t[0],n[1],n[0],{x:e,y:i}]),this.showSelectArea()}else{if(2===t.button){if(window.setTimeout(()=>{this.emit("contextmenu",[s,r])},0),this.moving=0,Nr([n,n],this.data.getSelectRange()))return;return this.emit("select",[n[1],n[0],void 0,void 0,{x:e,y:i}]),void this.showSelectArea()}this.emit("select",[n[1],n[0],void 0,void 0,{x:e,y:i}]),this.data.view.doMouseDown(t,{x:e,y:i,ri:o.ri,ci:o.ci},this.data.getPositionByOffset(e,i))}}),this.onMouseMove=(t=>{this.verticalScrollBar.scroll(this.data.scroll.y),this.horizontalScrollBar.scroll(this.data.scroll.x);const{x:e,y:i,clientX:s,clientY:r}=this.getPointInfo(t);if(s<=0&&r<=0)this.data.view.disHover();else{if(e<this.data.offset.offsetX||i<this.data.offset.offsetY){const t=this.data.getResizerCell(e,i);i>this.data.offset.offsetY&&(this.verticalResizer.hide(),this.horizontalResizer.show(t,{width:this.data.width,height:2},{min:-t.height})),e>this.data.offset.offsetX&&(this.verticalResizer.show(t,{width:2,height:this.data.height},{min:-t.width}),this.horizontalResizer.hide())}else{this.horizontalResizer&&this.horizontalResizer.hide(),this.verticalResizer&&this.verticalResizer.hide();const o=this.getActiveCell(e,i),n=this.data.getPositionByOffset(e,i);if(null===o)return null!==this.previousPosition&&(this.data.view.doMouseLeave(t,{x:e,y:i,ri:this.previousPosition.ri,ci:this.previousPosition.ci},n),this.previousPosition=null),this.toolTip.hide(),this.setMouseCursorByEvent(t,"default"),void this.data.view.disHover();const h={ri:o.ri,ci:o.ci};if(Bs(this.previousPosition,h)||null===this.previousPosition||this.data.view.doMouseLeave(t,{x:e,y:i,ri:this.previousPosition.ri,ci:this.previousPosition.ci},n),this.previousPosition=h,this.moving){this.moving=2;const t=this.data.selection.getCell();this.emit("select",[t[1],t[0],o.ri,o.ci,{x:e,y:i}]),this.showSelectArea()}const l=this.data.view.getMergeCell(o.ri,o.ci);this.data.view.doHover(t,{x:e,y:i,ri:o.ri,ci:o.ci},n);const{x:a,y:c}=this.data.offset2Absolute({x:e,y:i},l);this.data.view.isHoverText(l,a,c)&&(l.cursor&&"default"!==l.cursor?this.setMouseCursorByEvent(t,l.cursor):this.setMouseCursorByEvent(t,"text")),l.title?this.toolTip.show(l.title,s,r):this.toolTip.hide()}this.emit("hover",[e,i])}}),this.onMouseleave=(()=>{this.toolTip.hide()}),this.onDoubleClick=(t=>{this.setWheelMode(hn.WHEELMODE_FOCUS);const{x:e,y:i}=this.getPointInfo(t),s=this.getActiveCell(e,i),r=this.data.getSelectCell();this.isDoubleClickable(e,i,r)||(this.emit("dblclick",[e,i]),this.data.view.doDbClick(t,{x:e,y:i,ri:s.ri,ci:s.ci},this.data.getPositionByOffset(e,i)))}),this.onMouseUp=(t=>{this.setWheelMode(hn.WHEELMODE_FOCUS);const{x:e,y:i}=this.getPointInfo(t),s=this.getActiveCell(e,i),r=this.data.selection.getCell();if(s&&(1===this.moving||2===this.moving&&s.ri===r[1]&&s.ci===r[0])&&!t.shiftKey&&2!==t.button){if(null===s||s.stopPropagation)return void(this.moving=0);2!==this.moving&&this.hideSelectArea(),this.data.view.doClick(t,{x:e,y:i,ri:s.ri,ci:s.ci},this.data.getPositionByOffset(e,i))}else 0===this.moving&&(t.currentTarget===document||s||this.hideSelectArea());this.moving=0}),this.resizeHandler=((t,e,i)=>{this.emit("resize",[t,e,i]),this.resize()}),this.scrollHandler=((t,e,i={smooth:!1,force:!1})=>{if(0===t&&0===e&&!i.force)return!0;this.hideSelectArea(),this.scrollTimeout&&clearTimeout(this.scrollTimeout),i.smooth&&(t=Math.min(t,pn),e=Math.min(e,pn));const{x:s,y:r}=this.data.getScroll(),o=t,n=e;t+=this.deltaXCache,e+=this.deltaYCache;let h=this.data.correctDeltaX(t),l=this.data.correctDeltaY(e);h=o>0?Math.max(0,h):Math.min(0,h),l=n>0?Math.max(0,l):Math.min(0,l),this.deltaXCache=t-h,this.deltaYCache=e-l,this.scrollTimeout=setTimeout(()=>{this.deltaXCache=0,this.deltaYCache=0,this.showSelectArea()},300);const a=Math.round(ee(s+h,0,this.data.maxScrollX)),c=Math.round(ee(r+l,0,this.data.maxScrollY));return(a===this.data.maxScrollX&&t>0||0===a&&t<0)&&(this.deltaXCache=0),(c===this.data.maxScrollY&&e>0||0===c&&e<0)&&(this.deltaYCache=0),Math.abs(h)>Math.abs(l)?this.emit("scroll",[a,"horizontal"]):this.emit("scroll",[c,"vertical"]),this.waffle.scroll(-a,-c),!(Math.abs(h)>Math.abs(l)?a<=0||a>=this.data.maxScrollX:c<=0||c>=this.data.maxScrollY)||0!==this.deltaXCache||0!==this.deltaYCache}),this.el=e("div","grid-container"),this.data=t,this.cellCache=new Set,this.moving=0,this.sync=i.sync||!1,i.getPointByClient&&(this.getPointByClient=i.getPointByClient),this.supportCSSTransform=i.supportCSSTransform,this.initResizer(),this.initWaffle(),this.initScrollbar(),this.initTootip(),this.initEvent()}correctBounds(t){return Object.assign(Object.assign({},t),{x:t.x+this.data.offset.offsetX,y:t.y+this.data.offset.offsetY})}resize(){this.waffle.update({width:this.data.width+this.data.offset.offsetX,height:this.data.height+this.data.offset.offsetY,freezeWidth:this.data.view.freezeWidth+this.data.offset.offsetX,freezeHeight:this.data.view.freezeHeight+this.data.offset.offsetY,totalWidth:this.data.view.totalWidth,totalHeight:this.data.view.totalHeight}),this.showSelectArea(),this.updateStickCells(),this.updateScrollBar(),this.whellScroll(0,0)}reset(){this.resize(),this.clean()}stick(t,e){const i=t.id;if(this.cellCache.has(t.id))this.waffle.updateStick(t);else if(t.width>0&&t.height>0){t.left=t.left+this.data.offset.offsetX,t.top=t.top+this.data.offset.offsetY;const{id:s,mount:r,isInRange:o}=this.waffle.stick(t);if(this.cellCache.add(s),q(e)){if(this.sync)return e(this.waffle.getStick(s),t.width,t.height,r,o),i;const n=window.setTimeout(()=>{e(this.waffle.getStick(s),t.width,t.height,r,o)});this.stickerTimeouts.push(n)}}return i}tearSticker(t){this.waffle.tear(t)}tear(){this.toolTip.tear()}stickCell(t,e,i){const s=`${t}-${e}`,{el:r,width:o,height:n,x:h,y:l}=this.data.view.getMergeCell(t,e);return this.stick({el:r,width:o,height:n,left:h,top:l,id:s},i),s}whellScroll(t,e){const{x:i,y:s}=this.data.getScroll(),r=Math.round(ee(i+t,0,this.data.maxScrollX)),o=Math.round(ee(s+e,0,this.data.maxScrollY));return this.scrollHandler(t,e,{smooth:!1,force:!1}),this.verticalScrollBar.scroll(this.data.scroll.y,!1),this.horizontalScrollBar.scroll(this.data.scroll.x,!1),{scrollX:r,scrollY:o,maxScrollX:this.data.maxScrollX,maxScrollY:this.data.maxScrollY}}updateStickCells(){this.cellCache.forEach(t=>{const[e,i]=t.split("-");this.stickCell(~~e,~~i)})}setWheelMode(t){this.waffle.emit("wheelMode",[t])}initEvent(){this.waffle.el.on("mouseover",()=>{this.mountResizer(),this.mountScrollbar()}),this.waffle.el.on("contextmenu",t=>t.preventDefault()),this.waffle.el.on("mousedown",this.onMouseDown),this.waffle.el.on("mouseup",this.onMouseUp),this.waffle.el.on("mousemove",this.onMouseMove),this.waffle.el.on("dblclick",this.onDoubleClick),this.waffle.el.on("mouseleave",this.onMouseleave),this.waffle.el.on("wheel",t=>{let e,i;1===t.deltaMode?(e=20*t.deltaX,i=20*t.deltaY):(e=t.deltaX,i=t.deltaY),this.scrollHandler(e,i,{smooth:!0,force:!1})&&t.preventDefault(),this.verticalScrollBar.scroll(this.data.scroll.y),this.horizontalScrollBar.scroll(this.data.scroll.x)});let t=[0,0];this.waffle.el.on("touchstart",e=>{const{x:i,y:s}=this.getPointInfo(e);t=[i,s]}),this.waffle.el.on("touchmove",e=>{const[i,s]=t,{x:r,y:o}=this.getPointInfo(e);t=[r,o],this.scrollHandler(i-r,s-o,{smooth:!0,force:!1}),this.verticalScrollBar.scroll(this.data.scroll.y),this.horizontalScrollBar.scroll(this.data.scroll.x)}),this.waffle.el.on("mouseout",()=>{this.data.view.disHover()}),document.addEventListener("mouseup",this.onMouseUp),eo(this.waffle.el,()=>{this.hideSelectArea()},!1),this.waffle.on("focus",(t,e)=>{this.focusHandler(t,e)})}initResizer(){this.verticalResizer=new un({direction:"vertical",onResize:this.resizeHandler}),this.horizontalResizer=new un({direction:"horizontal",onResize:this.resizeHandler})}initTootip(){this.toolTip=new gn}initScrollbar(){const t=this.data.getViewBounds();this.verticalScrollBar=new dn({direction:"vertical",size:t.height,scrollSize:this.data.maxScrollY,slider:{},onScoll:this.scrollHandler}),this.horizontalScrollBar=new dn({direction:"horizontal",size:t.width,scrollSize:this.data.maxScrollX,slider:{},onScoll:this.scrollHandler})}mountResizer(){this.el.hasChild(this.verticalResizer.el.el)||this.el.hasChild(this.horizontalResizer.el.el)||this.el.children(this.verticalResizer.el,this.horizontalResizer.el)}mountScrollbar(){this.el.hasChild(this.verticalScrollBar.el.el)||this.el.hasChild(this.horizontalScrollBar.el.el)||(this.el.children(this.verticalScrollBar.el),this.el.children(this.horizontalScrollBar.el))}updateScrollBar(){const t=this.data.getViewBounds();this.verticalScrollBar.update({size:t.height,scrollSize:this.data.maxScrollY}),this.horizontalScrollBar.update({size:t.width,scrollSize:this.data.maxScrollX})}initWaffle(){const t=this.data.width+this.data.offset.offsetX,e=this.data.height+this.data.offset.offsetY,i=this.data.view.freezeWidth+this.data.offset.offsetX,s=this.data.view.freezeHeight+this.data.offset.offsetY;this.waffle=new cn({width:t,height:e,freezeWidth:i,freezeHeight:s,totalWidth:this.data.view.totalWidth,totalHeight:this.data.view.totalHeight}),this.el.children(this.waffle.el)}isDoubleClickable(t,e,i){const{verticalFreezed:s,horizontalFreezed:r}=this.data.cellIsFreezed(i),o=t+(s?0:this.data.getScroll().x)-this.data.offset.offsetX,n=e+(r?0:this.data.getScroll().y)-this.data.offset.offsetY;return!1===i.dblclick&&i.left<=o&&i.left+i.width>=o&&i.top<=n&&i.top+i.height>=n||!!i.items&&i.items.some(i=>this.isDoubleClickable(t,e,i.el))}focusHandler(t,e){const i=t,s=this.data.scroll.x,r=e,o=this.data.scroll.y;Math.abs(i-s)>1&&Dr(t)&&this.whellScroll(i-s,0),Math.abs(r-o)>1&&Dr(e)&&this.whellScroll(0,r-o)}showInputCell(){const t=this.data.getSelectCell();t.x=t.x+this.data.offset.offsetX,t.y=t.y+this.data.offset.offsetY}showSelectArea(){const t=this.data.getSelectBounds();this.waffle.showSelectArea(t)}hideSelectArea(){this.waffle.hideSelectArea(),this.data.clearSelection()}clean(){this.cellCache=new Set,this.stickerTimeouts.forEach(t=>{window.clearTimeout(t)}),this.stickerTimeouts=[],this.waffle.clean()}getActiveCell(t,e){const i=this.data.getCellByOffset(t,e);return i?!1===i.valid?null:i:null}setMouseCursorByEvent(t,e){const i=this.waffle.getGrids().map(t=>t.el.el),s=this.waffle.el.el;let r=t.target;for(;r&&r!==s&&!i.includes(r);)r=r.parentElement;r&&(r.style.cursor=e)}getActivePosition(t,e){const{left:i,top:s}=this.el.el.getBoundingClientRect();return[t-i,e-s]}getPointInfo(t){const e=this.getClientByEvent(t),i=this.getPointByEvent(t);return{x:i.x,y:i.y,clientX:e.x,clientY:e.y}}getClientByEvent(t){let e=t;return window.TouchEvent&&t instanceof TouchEvent&&(e="touchend"===t.type?t.changedTouches[0]:t.targetTouches[0]),{x:e.clientX,y:e.clientY}}getPointByEvent(t){const e=this.waffle.getGrids().map(t=>t.el.el),i=this.waffle.el.el,s=cn.STICKER_CONTAINER_CLASS_NAME;if(this.supportCSSTransform&&t instanceof MouseEvent)return{x:function(t,r){let o=t,n=r;for(;n&&n!==i&&!e.includes(n);)`${n.className}`.includes(s)?o=t+n.offsetLeft:o+=n.offsetLeft,n=n.parentElement;return n&&(o-=n.scrollLeft-n.offsetLeft),o}(t.offsetX,t.target),y:function(t,r){let o=t,n=r;for(;n&&n!==i&&!e.includes(n);)`${n.className}`.includes(s)?o=t+n.offsetTop:o+=n.offsetTop,n=n.parentElement;return n&&n.parentElement&&(o-=n.scrollTop-n.parentElement.offsetTop),o}(t.offsetY,t.target)};const{x:r,y:o}=this.getClientByEvent(t);return this.getPointByClient(r,o)}}var bn="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function vn(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on".concat(e),function(){i(window.event)})}function yn(t,e){for(var i=e.slice(0,e.length-1),s=0;s<i.length;s++)i[s]=t[i[s].toLowerCase()];return i}function mn(t){t||(t="");for(var e=(t=t.replace(/\s/g,"")).split(","),i=e.lastIndexOf("");i>=0;)e[i-1]+=",",e.splice(i,1),i=e.lastIndexOf("");return e}function xn(t,e){for(var i=t.length>=e.length?t:e,s=t.length>=e.length?e:t,r=!0,o=0;o<i.length;o++)-1===s.indexOf(i[o])&&(r=!1);return r}for(var Sn={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"⇪":20,",":188,".":190,"/":191,"`":192,"-":bn?173:189,"=":bn?61:187,";":bn?59:186,"'":222,"[":219,"]":221,"\\":220},Cn={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":bn?224:91,cmd:bn?224:91,command:bn?224:91},kn={16:"shiftKey",18:"altKey",17:"ctrlKey"},zn={16:!1,18:!1,17:!1},Mn={},jn=1;jn<20;jn++)Sn["f".concat(jn)]=111+jn;kn[bn?224:91]="metaKey",zn[bn?224:91]=!1;var En=[],On="all",Tn=[],An=function(t){return Sn[t.toLowerCase()]||Cn[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)};function Rn(t){On=t||"all"}function Bn(){return On||"all"}function _n(t,e,i){var s;if(e.scope===i||"all"===e.scope){for(var r in s=e.mods.length>0,zn)Object.prototype.hasOwnProperty.call(zn,r)&&(!zn[r]&&e.mods.indexOf(+r)>-1||zn[r]&&-1===e.mods.indexOf(+r))&&(s=!1);(0!==e.mods.length||zn[16]||zn[18]||zn[17]||zn[91])&&!s&&"*"!==e.shortcut||!1===e.method(t,e)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}function Hn(t){var e=Mn["*"],i=t.keyCode||t.which||t.charCode;if(Wn.filter.call(this,t)){if(-1===En.indexOf(i)&&229!==i&&En.push(i),93!==i&&224!==i||(i=91),i in zn){for(var s in zn[i]=!0,Cn)Cn[s]===i&&(Wn[s]=!0);if(!e)return}for(var r in zn)Object.prototype.hasOwnProperty.call(zn,r)&&(zn[r]=t[kn[r]]);var o=Bn();if(e)for(var n=0;n<e.length;n++)e[n].scope===o&&("keydown"===t.type&&e[n].keydown||"keyup"===t.type&&e[n].keyup)&&_n(t,e[n],o);if(i in Mn)for(var h=0;h<Mn[i].length;h++)if(("keydown"===t.type&&Mn[i][h].keydown||"keyup"===t.type&&Mn[i][h].keyup)&&Mn[i][h].key){for(var l=Mn[i][h].key.split("+"),a=[],c=0;c<l.length;c++)a.push(An(l[c]));(a=a.sort()).join("")===En.sort().join("")&&_n(t,Mn[i][h],o)}}}function Wn(t,e,i){var s=mn(t),r=[],o="all",n=document,h=0,l=!1,a=!0;for(void 0===i&&"function"==typeof e&&(i=e),"[object Object]"===Object.prototype.toString.call(e)&&(e.scope&&(o=e.scope),e.element&&(n=e.element),e.keyup&&(l=e.keyup),e.keydown&&(a=e.keydown)),"string"==typeof e&&(o=e);h<s.length;h++)r=[],(t=s[h].split("+")).length>1&&(r=yn(Cn,t)),(t="*"===(t=t[t.length-1])?"*":An(t))in Mn||(Mn[t]=[]),Mn[t].push({keyup:l,keydown:a,scope:o,mods:r,shortcut:s[h],method:i,key:s[h]});void 0!==n&&!function(t){return Tn.indexOf(t)>-1}(n)&&window&&(Tn.push(n),vn(n,"keydown",function(t){Hn(t)}),vn(window,"focus",function(){En=[]}),vn(n,"keyup",function(t){Hn(t),function(t){var e=t.keyCode||t.which||t.charCode,i=En.indexOf(e);if(i>=0&&En.splice(i,1),t.key&&"meta"===t.key.toLowerCase()&&En.splice(0,En.length),93!==e&&224!==e||(e=91),e in zn)for(var s in zn[e]=!1,Cn)Cn[s]===e&&(Wn[s]=!1)}(t)}))}var Ln={setScope:Rn,getScope:Bn,deleteScope:function(t,e){var i,s;for(var r in t||(t=Bn()),Mn)if(Object.prototype.hasOwnProperty.call(Mn,r))for(i=Mn[r],s=0;s<i.length;)i[s].scope===t?i.splice(s,1):s++;Bn()===t&&Rn(e||"all")},getPressedKeyCodes:function(){return En.slice(0)},isPressed:function(t){return"string"==typeof t&&(t=An(t)),-1!==En.indexOf(t)},filter:function(t){var e=t.target||t.srcElement,i=e.tagName,s=!0;return!e.isContentEditable&&"TEXTAREA"!==i&&("INPUT"!==i&&"TEXTAREA"!==i||e.readOnly)||(s=!1),s},unbind:function(t,e,i){var s,r,o=mn(t),n=[];"function"==typeof e&&(i=e,e="all");for(var h=0;h<o.length;h++){if(n=(s=o[h].split("+")).length>1?yn(Cn,s):[],t="*"===(t=s[s.length-1])?"*":An(t),e||(e=Bn()),!Mn[t])return;for(var l=0;l<Mn[t].length;l++)r=Mn[t][l],(!i||r.method===i)&&r.scope===e&&xn(r.mods,n)&&(Mn[t][l]={})}}};for(var In in Ln)Object.prototype.hasOwnProperty.call(Ln,In)&&(Wn[In]=Ln[In]);if("undefined"!=typeof window){var Pn=window.hotkeys;Wn.noConflict=function(t){return t&&window.hotkeys===Wn&&(window.hotkeys=Pn),Wn},window.hotkeys=Wn}let $n=(()=>{class t{constructor(t){t&&t.hotkeys&&Object.keys(t.hotkeys).forEach(e=>{this.bindHotkeys(e,t.hotkeys[e])})}bindHotkeys(t,e){Wn(t,e)}unbindHotkeys(t,e){Wn.unbind(t,e)}}return t.KEY={COPY:"ctrl+c,command+c"},t})();class Dn{constructor(t=[{key:"copy",icon:"",label:"复制",accel:""}]){this.el=e("div","sheet-menu").css({userSelect:"none"}).hide(),this.clickHandler=Yr,this.menuItems=t,this.buildItems(),this.el.el.addEventListener("contextmenu",t=>t.preventDefault()),document.body.appendChild(this.el.el)}show(t,e,i){const{width:s,height:r}=this.el.show().offset();this.configItems(i);let o=e,n=t;window.innerHeight-e<=r&&(o-=r),window.innerWidth-t<=s&&(n-=s),this.el.offset({left:n,top:o}),eo(this.el)}hide(){this.el.hide(),to(this.el)}bindHandler(t){this.clickHandler=t}tear(){document.body.removeChild(this.el.el)}configItems(t){this.menuItems.forEach(e=>{t[e.key]?this.el.childEnable(e.key):this.el.disableChild(e.key)})}buildItems(){this.menuItems.forEach(t=>{"separator"===t.key&&this.el.children(e("div","sheet-menuseparator")),this.el.children(e("div",`sheet-menuitem ${t.key}`).on("mousedown",t=>{t.stopPropagation()}).on("click",()=>{this.clickHandler(t.key),this.hide()}).children(e("div","sheet-menuitem-icon"),e("span","sheet-menuitem-label").text(t.label||""),e("span","sheet-menuitem-accel").text(t.accel||"")))})}}class Xn{constructor({data:t,editable:i=!1}){this.data=t,this.el=e("div","input-box").hide(),this.input=e("div","cell-input").attr("contenteditable",`${!!i}`),this.el.children(this.input),document.body.appendChild(this.el.el)}show(t,i,s,r){if(s<=0||r<=0)return;this.el.css({left:`${t-2}px`,top:`${i-2}px`,maxWidth:`${this.data.width-t+this.data.offset.offsetX-12}px`,minWidth:`${s+2}px`,minHeight:`${r+2}px`,maxHeight:`${this.data.height-i+this.data.offset.offsetY-12}px`}).show(),this.input.text(""),this.text=this.text||e("span"),this.text.text(this.data.getSelectCell().value),this.input.children(this.text);const o=S(),n=document.createRange();o.removeAllRanges(),n.selectNodeContents(this.text.el),n.setStart(n.startContainer,n.endOffset),o.addRange(n),eo(this.el),function(t,e=(t=>{t.hide()})){t.mouseWhell=(()=>{e(t)}),Qr(window.document.body,"mousewheel",t.mouseWhell)}(this.el)}hide(){var t;this.el.hide(),to(this.el),(t=this.el).mouseWhell&&(Zr(window.document.body,"mousewheel",t.mouseWhell),delete t.mouseWhell)}tear(){document.body.removeChild(this.el.el)}}class Nn{constructor(){this.texts=[],this.cells=null,this.trigger=document.createElement("textarea"),this.trigger.className="trix-offscreen",this.trigger.innerText=" ",this.trigger.addEventListener("copy",t=>{this.setClipboardData(t)}),document.body.appendChild(this.trigger)}copy(t){this.cells=t,this.isImage()?this.downloadImage():this.dispatchCopy()}copyText(t){0!==t.length&&(this.texts=t,this.dispatchCopy())}clear(){this.cells=null}tear(){document.body.removeChild(this.trigger)}isImage(){return this.cells.length>=1&&this.cells[0].length>=1&&this.cells[0][0].image}downloadImage(){const t=document.createElement("a");t.href=this.cells[0][0].image,t.download="image.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)}dispatchCopy(){const t=S(),e=document.createRange();t.removeAllRanges(),e.selectNodeContents(this.trigger),t.addRange(e),this.trigger.setSelectionRange(0,99999),this.trigger.focus(),document.execCommand("copy"),this.trigger.blur()}transform2HTML(){if(!this.cells)return"";const t={},e=[],i=[];return this.cells.forEach(s=>{s.forEach(s=>{const{ri:r,ci:o,width:n,height:h}=s;e[o]!==n&&(e[o]||0===e[o]?(e[o]=Math.min(e[o],n),e[o+1]=Math.max(e[o],n)-e[o]):e[o]=n),i[r]!==h&&(i[r]||0===i[r]?(i[r]=Math.min(i[r],h),i[r+1]=Math.max(i[r],h)-i[r]):i[r]=h),t[`${s.ci}-${s.ri}`]=""})}),""}transform2Text(){return this.texts.map(t=>t.join("\t")).join("\n")}setClipboardData(t){var e;if(t.clipboardData)t.clipboardData.setData("text/html",this.transform2HTML()),t.clipboardData.setData("text/plain",this.transform2Text());else{this.transform2HTML();null===(e=window.clipboardData)||void 0===e||e.setData("text",this.transform2Text())}t.preventDefault()}}class Yn{constructor(t,i={}){var s,r;this.scrollHandler=((t,e)=>{"vertical"===e?this.data.scrollY(t,this.scrollTable):this.data.scrollX(t,this.scrollTable)}),this.resizeHandler=((t,e,i)=>{"vertical"===i?this.data.resizeCol(t.ci,t.width+e):this.data.resizeRow(t.ri,t.height+e),this.render()}),this.scrollTable=((t,e)=>{this.container.setWheelMode(hn.WHEELMODE_WHEEL);const i=t.y-e.y,s=t.x-e.x;this.table.scroll(s,i),(this.eventsMap.scroll||[]).forEach(e=>{e.call(null,{x:t.x,y:t.y,deltaX:s,deltaY:i})})}),this.selectHandler=((t,e,i,s,r)=>{this.data.select(t,e,i,s,r),this.table.renderSequnce()}),this.showContextMenu=((t,e)=>{if(q(this.disableContextMenu)?this.disableContextMenu():this.disableContextMenu)return;const i=this.data.getSelectRangeCells();let s=!1;for(const t of i)if(s=t.some(t=>!!t.canCopy))break;this.contextMenu.show(t,e,{copy:s&&!Gt(this.data.selection.getSelectedTexts())})}),this.contextMenuHandler=(t=>{switch(t){case"copy":default:this.copy()}}),this.render=(()=>{var t,e;this.table.render(),null===(e=(t=this.events).render)||void 0===e||e.call(t)}),this.copy=(()=>{this.clipboard.copyText(this.data.selection.getSelectedTexts())}),this.events=i,this.el=e("div","sheet"),this.el.offset({width:t.width,height:t.height}),this.data=new Ko("sheet",t),this.disableContextMenu=t.disableContextMenu,this.container=new wn(this.data,{sync:t.sync,getPointByClient:this.getPointByClient.bind(this),supportCSSTransform:t.supportCSSTransform}),this.table=new on(this.data,this.container),this.container.el.unshiftChildren(this.table.el),this.el.children(this.container.el),this.initEvent(),this.initHotKeys(),this.contextMenu=new Dn(t.contextMenuItems),this.contextMenu.bindHandler(this.contextMenuHandler),this.inputBox=new Xn({data:this.data}),null===(r=(s=this.events).created)||void 0===r||r.call(s),this.render()}initEvent(){this.eventsMap={},this.container.on("scroll",this.scrollHandler),this.container.on("resize",this.resizeHandler),this.container.on("select",this.selectHandler),this.container.on("contextmenu",this.showContextMenu)}initHotKeys(){this.hotkeys=new $n,this.initCopyEvent()}initCopyEvent(){this.clipboard=new Nn,this.hotkeys.bindHotkeys($n.KEY.COPY,this.copy)}resizeEl(){this.el.offset({width:this.data.width+this.data.offset.offsetX,height:this.data.height+this.data.offset.offsetY})}addEventListener(t,e){this.eventsMap[t]=this.eventsMap[t]||[],this.eventsMap[t].includes(e)||this.eventsMap[t].push(e)}removeEventListener(t,e){this.eventsMap[t]=this.eventsMap[t]||[],Ls(this.eventsMap[t],e)}loadData(t){this.data.setData(t),this.reset()}updateCell(t,e){this.data.updateCell(t.ri,t.ci,e),this.table.renderCell(t)}getCellPosition(t){return this.data.getCellPosition(t,this.data.options.sheet.merges)}whellByBounds(t){const{x:e=0,y:i=0,width:s,height:r}=t,{left:o,top:n,right:h,bottom:l}=this.getBounds();let a=0,c=0;if(e<=o||e+s>=h){a=e+s-(e+s>=h?h-s:o+2*s)}if(i<=n||i+r>=l){c=i+r-(i+r>=l?l-r:n+2*r)}this.whellScroll(a,c)}getBounds(){const{x:t,y:e}=this.data.getScroll();return{left:t,top:e,right:t+this.data.width,bottom:e+this.data.height,width:this.data.width,height:this.data.height}}insertRows(t,e,i){this.data.insertRows(t,e,i),this.render(),this.container.resize()}insertCols(t,e,i){this.data.insertCols(t,e,i),this.render(),this.container.resize()}deleteRows(t,e){this.data.deleteRows(t,e),this.render(),this.container.resize()}deleteCols(t,e){this.data.deleteCols(t,e),this.render(),this.container.resize()}reset(){this.data.reset(),this.container.reset(),this.table.resize(),this.render(),this.resizeEl()}resize(t,e){this.data.resize(t,e),this.container.resize(),this.table.resize(),this.render(),this.resizeEl()}setHScrollBarVisible(t){this.container.horizontalScrollBar.setVisible(t)}setVScrollBarVisible(t){this.container.verticalScrollBar.setVisible(t)}whellScroll(t,e){return this.container.whellScroll(t,e)}tear(){this.clipboard.tear(),this.contextMenu.tear(),this.inputBox.tear(),this.container.tear()}getPointByClient(t,e){const i=this.table.el.el.getBoundingClientRect();return{x:t-i.left,y:e-i.top}}}class Gn{constructor(t,i,s={}){var r,o,n;if(s.beforeInit&&!s.beforeInit())return;null===(r=s.beforeCreate)||void 0===r||r.call(s),this.parent=e(t,"sheet-root");const{width:h,height:l}=this.parent.offset(),{tableWidth:a=h,tableHeight:c=l}=i,d=Object.assign({width:a,height:c},i.options);this.sheet=new Yn(d,s),null===(o=s.beforeMount)||void 0===o||o.call(s),this.parent.children(this.sheet.el),null===(n=s.mounted)||void 0===n||n.call(s)}loadData(t){return this.sheet.loadData(t),this}updateData(){return this}updateCell(t,e){this.sheet.updateCell(t,e)}getCellPosition(t){return this.sheet.getCellPosition(t)}resize(t,e){const{width:i,height:s}=this.parent.offset();t=t||i,e=e||s,this.sheet.resize(t,e)}insertRows(t,e,i){this.sheet.insertRows(t,e,i)}insertCols(t,e,i){this.sheet.insertCols(t,e,i)}deleteRows(t,e){this.sheet.deleteRows(t,e)}deleteCols(t,e){this.sheet.deleteCols(t,e)}tear(){this.sheet.tear()}}return{createSheet:(t,e,i)=>new Gn(t,e,i)}}();
